/* Scene.c generated by valac 0.20.1, the Vala compiler
 * generated from Scene.gs, do not modify */

/*
 *  libsoy - soy.scenes.Scene
 *  Copyright (C) 2006,2007,2008,2009,2010,2011,2012,2013 Copyleft Games Group
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU Affero General Public License as published
 *  by the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU Affero General Public License for more details.
 *
 *  You should have received a copy of the GNU Affero General Public License
 *  along with this program; if not, see http://www.gnu.org/licenses
 *
 */

#include <glib.h>
#include <glib-object.h>
#include <GLES/gl.h>
#include <GLES/glext.h>
#include <soy-1/ode.h>
#include <gee.h>
#include <stdlib.h>
#include <string.h>
#include <float.h>
#include <math.h>


#define SOY_SCENES_TYPE_SCENE (soy_scenes_scene_get_type ())
#define SOY_SCENES_SCENE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_SCENES_TYPE_SCENE, soyscenesScene))
#define SOY_SCENES_SCENE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_SCENES_TYPE_SCENE, soyscenesSceneClass))
#define SOY_SCENES_IS_SCENE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_SCENES_TYPE_SCENE))
#define SOY_SCENES_IS_SCENE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_SCENES_TYPE_SCENE))
#define SOY_SCENES_SCENE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_SCENES_TYPE_SCENE, soyscenesSceneClass))

typedef struct _soyscenesScene soyscenesScene;
typedef struct _soyscenesSceneClass soyscenesSceneClass;
typedef struct _soyscenesScenePrivate soyscenesScenePrivate;

#define SOY_BODIES_TYPE_BODY (soy_bodies_body_get_type ())
#define SOY_BODIES_BODY(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_BODIES_TYPE_BODY, soybodiesBody))
#define SOY_BODIES_BODY_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_BODIES_TYPE_BODY, soybodiesBodyClass))
#define SOY_BODIES_IS_BODY(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_BODIES_TYPE_BODY))
#define SOY_BODIES_IS_BODY_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_BODIES_TYPE_BODY))
#define SOY_BODIES_BODY_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_BODIES_TYPE_BODY, soybodiesBodyClass))

typedef struct _soybodiesBody soybodiesBody;
typedef struct _soybodiesBodyClass soybodiesBodyClass;

#define SOY_BODIES_TYPE_CAMERA (soy_bodies_camera_get_type ())
#define SOY_BODIES_CAMERA(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_BODIES_TYPE_CAMERA, soybodiesCamera))
#define SOY_BODIES_CAMERA_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_BODIES_TYPE_CAMERA, soybodiesCameraClass))
#define SOY_BODIES_IS_CAMERA(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_BODIES_TYPE_CAMERA))
#define SOY_BODIES_IS_CAMERA_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_BODIES_TYPE_CAMERA))
#define SOY_BODIES_CAMERA_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_BODIES_TYPE_CAMERA, soybodiesCameraClass))

typedef struct _soybodiesCamera soybodiesCamera;
typedef struct _soybodiesCameraClass soybodiesCameraClass;

#define SOY_BODIES_TYPE_LIGHT (soy_bodies_light_get_type ())
#define SOY_BODIES_LIGHT(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_BODIES_TYPE_LIGHT, soybodiesLight))
#define SOY_BODIES_LIGHT_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_BODIES_TYPE_LIGHT, soybodiesLightClass))
#define SOY_BODIES_IS_LIGHT(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_BODIES_TYPE_LIGHT))
#define SOY_BODIES_IS_LIGHT_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_BODIES_TYPE_LIGHT))
#define SOY_BODIES_LIGHT_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_BODIES_TYPE_LIGHT, soybodiesLightClass))

typedef struct _soybodiesLight soybodiesLight;
typedef struct _soybodiesLightClass soybodiesLightClass;

#define SOY_JOINTS_TYPE_JOINT (soy_joints_joint_get_type ())
#define SOY_JOINTS_JOINT(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_JOINTS_TYPE_JOINT, soyjointsJoint))
#define SOY_JOINTS_JOINT_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_JOINTS_TYPE_JOINT, soyjointsJointClass))
#define SOY_JOINTS_IS_JOINT(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_JOINTS_TYPE_JOINT))
#define SOY_JOINTS_IS_JOINT_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_JOINTS_TYPE_JOINT))
#define SOY_JOINTS_JOINT_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_JOINTS_TYPE_JOINT, soyjointsJointClass))

typedef struct _soyjointsJoint soyjointsJoint;
typedef struct _soyjointsJointClass soyjointsJointClass;

#define SOY_CONTROLLERS_TYPE_CONTROLLER (soy_controllers_controller_get_type ())
#define SOY_CONTROLLERS_CONTROLLER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_CONTROLLERS_TYPE_CONTROLLER, soycontrollersController))
#define SOY_CONTROLLERS_CONTROLLER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_CONTROLLERS_TYPE_CONTROLLER, soycontrollersControllerClass))
#define SOY_CONTROLLERS_IS_CONTROLLER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_CONTROLLERS_TYPE_CONTROLLER))
#define SOY_CONTROLLERS_IS_CONTROLLER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_CONTROLLERS_TYPE_CONTROLLER))
#define SOY_CONTROLLERS_CONTROLLER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_CONTROLLERS_TYPE_CONTROLLER, soycontrollersControllerClass))

typedef struct _soycontrollersController soycontrollersController;
typedef struct _soycontrollersControllerClass soycontrollersControllerClass;

#define SOY_CONTROLLERS_TYPE_VIRTUAL_CONTROLLER (soy_controllers_virtual_controller_get_type ())
#define SOY_CONTROLLERS_VIRTUAL_CONTROLLER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_CONTROLLERS_TYPE_VIRTUAL_CONTROLLER, soycontrollersVirtualController))
#define SOY_CONTROLLERS_VIRTUAL_CONTROLLER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_CONTROLLERS_TYPE_VIRTUAL_CONTROLLER, soycontrollersVirtualControllerClass))
#define SOY_CONTROLLERS_IS_VIRTUAL_CONTROLLER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_CONTROLLERS_TYPE_VIRTUAL_CONTROLLER))
#define SOY_CONTROLLERS_IS_VIRTUAL_CONTROLLER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_CONTROLLERS_TYPE_VIRTUAL_CONTROLLER))
#define SOY_CONTROLLERS_VIRTUAL_CONTROLLER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_CONTROLLERS_TYPE_VIRTUAL_CONTROLLER, soycontrollersVirtualControllerClass))

typedef struct _soycontrollersVirtualController soycontrollersVirtualController;
typedef struct _soycontrollersVirtualControllerClass soycontrollersVirtualControllerClass;

#define SOY_FIELDS_TYPE_FIELD (soy_fields_field_get_type ())
#define SOY_FIELDS_FIELD(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_FIELDS_TYPE_FIELD, soyfieldsField))
#define SOY_FIELDS_FIELD_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_FIELDS_TYPE_FIELD, soyfieldsFieldClass))
#define SOY_FIELDS_IS_FIELD(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_FIELDS_TYPE_FIELD))
#define SOY_FIELDS_IS_FIELD_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_FIELDS_TYPE_FIELD))
#define SOY_FIELDS_FIELD_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_FIELDS_TYPE_FIELD, soyfieldsFieldClass))

typedef struct _soyfieldsField soyfieldsField;
typedef struct _soyfieldsFieldClass soyfieldsFieldClass;

#define SOY_TEXTURES_TYPE_TEXTURE (soy_textures_texture_get_type ())
#define SOY_TEXTURES_TEXTURE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_TEXTURES_TYPE_TEXTURE, soytexturesTexture))
#define SOY_TEXTURES_TEXTURE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_TEXTURES_TYPE_TEXTURE, soytexturesTextureClass))
#define SOY_TEXTURES_IS_TEXTURE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_TEXTURES_TYPE_TEXTURE))
#define SOY_TEXTURES_IS_TEXTURE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_TEXTURES_TYPE_TEXTURE))
#define SOY_TEXTURES_TEXTURE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_TEXTURES_TYPE_TEXTURE, soytexturesTextureClass))

typedef struct _soytexturesTexture soytexturesTexture;
typedef struct _soytexturesTextureClass soytexturesTextureClass;

#define SOY_TEXTURES_TYPE_CUBEMAP (soy_textures_cubemap_get_type ())
#define SOY_TEXTURES_CUBEMAP(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_TEXTURES_TYPE_CUBEMAP, soytexturesCubemap))
#define SOY_TEXTURES_CUBEMAP_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_TEXTURES_TYPE_CUBEMAP, soytexturesCubemapClass))
#define SOY_TEXTURES_IS_CUBEMAP(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_TEXTURES_TYPE_CUBEMAP))
#define SOY_TEXTURES_IS_CUBEMAP_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_TEXTURES_TYPE_CUBEMAP))
#define SOY_TEXTURES_CUBEMAP_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_TEXTURES_TYPE_CUBEMAP, soytexturesCubemapClass))

typedef struct _soytexturesCubemap soytexturesCubemap;
typedef struct _soytexturesCubemapClass soytexturesCubemapClass;

#define SOY_ATOMS_TYPE_COLOR (soy_atoms_color_get_type ())
#define SOY_ATOMS_COLOR(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_ATOMS_TYPE_COLOR, soyatomsColor))
#define SOY_ATOMS_COLOR_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_ATOMS_TYPE_COLOR, soyatomsColorClass))
#define SOY_ATOMS_IS_COLOR(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_ATOMS_TYPE_COLOR))
#define SOY_ATOMS_IS_COLOR_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_ATOMS_TYPE_COLOR))
#define SOY_ATOMS_COLOR_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_ATOMS_TYPE_COLOR, soyatomsColorClass))

typedef struct _soyatomsColor soyatomsColor;
typedef struct _soyatomsColorClass soyatomsColorClass;

#define SOY_ATOMS_TYPE_VECTOR (soy_atoms_vector_get_type ())
#define SOY_ATOMS_VECTOR(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_ATOMS_TYPE_VECTOR, soyatomsVector))
#define SOY_ATOMS_VECTOR_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_ATOMS_TYPE_VECTOR, soyatomsVectorClass))
#define SOY_ATOMS_IS_VECTOR(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_ATOMS_TYPE_VECTOR))
#define SOY_ATOMS_IS_VECTOR_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_ATOMS_TYPE_VECTOR))
#define SOY_ATOMS_VECTOR_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_ATOMS_TYPE_VECTOR, soyatomsVectorClass))

typedef struct _soyatomsVector soyatomsVector;
typedef struct _soyatomsVectorClass soyatomsVectorClass;

#define SOY_ATOMS_TYPE_POSITION (soy_atoms_position_get_type ())
#define SOY_ATOMS_POSITION(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_ATOMS_TYPE_POSITION, soyatomsPosition))
#define SOY_ATOMS_POSITION_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_ATOMS_TYPE_POSITION, soyatomsPositionClass))
#define SOY_ATOMS_IS_POSITION(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_ATOMS_TYPE_POSITION))
#define SOY_ATOMS_IS_POSITION_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_ATOMS_TYPE_POSITION))
#define SOY_ATOMS_POSITION_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_ATOMS_TYPE_POSITION, soyatomsPositionClass))

typedef struct _soyatomsPosition soyatomsPosition;
typedef struct _soyatomsPositionClass soyatomsPositionClass;
#define _dSpaceDestroy0(var) ((var == NULL) ? NULL : (var = (dSpaceDestroy (var), NULL)))
#define _dJointGroupDestroy0(var) ((var == NULL) ? NULL : (var = (dJointGroupDestroy (var), NULL)))
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))

#define SOY_SCENES_TYPE__PHYSICSTHREAD (soy_scenes__physicsthread_get_type ())
#define SOY_SCENES__PHYSICSTHREAD(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_SCENES_TYPE__PHYSICSTHREAD, soyscenes_PhysicsThread))
#define SOY_SCENES__PHYSICSTHREAD_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_SCENES_TYPE__PHYSICSTHREAD, soyscenes_PhysicsThreadClass))
#define SOY_SCENES_IS__PHYSICSTHREAD(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_SCENES_TYPE__PHYSICSTHREAD))
#define SOY_SCENES_IS__PHYSICSTHREAD_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_SCENES_TYPE__PHYSICSTHREAD))
#define SOY_SCENES__PHYSICSTHREAD_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_SCENES_TYPE__PHYSICSTHREAD, soyscenes_PhysicsThreadClass))

typedef struct _soyscenes_PhysicsThread soyscenes_PhysicsThread;
typedef struct _soyscenes_PhysicsThreadClass soyscenes_PhysicsThreadClass;
typedef struct _soyscenes_PhysicsThreadPrivate soyscenes_PhysicsThreadPrivate;
#define _g_source_unref0(var) ((var == NULL) ? NULL : (var = (g_source_unref (var), NULL)))
#define _dmatrix3_free0(var) ((var == NULL) ? NULL : (var = (dmatrix3_free (var), NULL)))

#define SOY_ATOMS_TYPE_SIZE (soy_atoms_size_get_type ())
#define SOY_ATOMS_SIZE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_ATOMS_TYPE_SIZE, soyatomsSize))
#define SOY_ATOMS_SIZE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_ATOMS_TYPE_SIZE, soyatomsSizeClass))
#define SOY_ATOMS_IS_SIZE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_ATOMS_TYPE_SIZE))
#define SOY_ATOMS_IS_SIZE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_ATOMS_TYPE_SIZE))
#define SOY_ATOMS_SIZE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_ATOMS_TYPE_SIZE, soyatomsSizeClass))

typedef struct _soyatomsSize soyatomsSize;
typedef struct _soyatomsSizeClass soyatomsSizeClass;
typedef struct _soybodiesBodyPrivate soybodiesBodyPrivate;
#define _dvector3_free0(var) ((var == NULL) ? NULL : (var = (dvector3_free (var), NULL)))

struct _soyscenesScene {
	GObject parent_instance;
	soyscenesScenePrivate * priv;
	struct dxSpace* space;
	GeeHashSet* lights;
	GeeHashMap* bodies;
	GeeArrayList* joints;
	GeeHashSet* Controllers;
	GeeHashMap* fields;
	GLfloat* tslvs;
	gint tslvs_length1;
	GLfloat* colTexels;
};

struct _soyscenesSceneClass {
	GObjectClass parent_class;
	void (*do_in_step) (soyscenesScene* self);
	void (*render) (soyscenesScene* self, GLfloat fov, GLfloat aspect, GLfloat znear, GLfloat zfar, soybodiesCamera* camera, gint level);
	void (*render_extra) (soyscenesScene* self);
};

struct _soyscenesScenePrivate {
	struct dxJointGroup* _contactGroup;
	guint64 _lastStep;
	GTimeVal _tv;
	GeeLinkedList* _callFields;
	GeeLinkedList* _giveFields;
	soytexturesCubemap* _skybox;
	gboolean _skybox_updated;
	GLuint _ebo;
	GLuint _vbo;
	GLuint _colTextureID;
	guint64 _time;
	GLfloat* _ambient;
	gint _ambient_length1;
	gint __ambient_size_;
	soyatomsColor* _ambient_obj;
	GLfloat* _fog;
	gint _fog_length1;
	gint __fog_size_;
	soyatomsColor* _fog_obj;
	soyatomsVector* _gravity;
	gfloat _stepsize;
	GLfloat* _rotation;
	gint _rotation_length1;
	gint __rotation_size_;
	soyatomsPosition* _position;
};

struct _soyscenes_PhysicsThread {
	GObject parent_instance;
	soyscenes_PhysicsThreadPrivate * priv;
	GMainContext* context;
};

struct _soyscenes_PhysicsThreadClass {
	GObjectClass parent_class;
};

struct _soybodiesBody {
	GObject parent_instance;
	soybodiesBodyPrivate * priv;
	struct dxBody* body;
	GLfloat* fogcoords;
	gint fogcoords_length1;
	struct dxGeom* geom;
	gchar* key;
	GMutex mutex;
	GLfloat* tslvs;
	gint tslvs_length1;
	soyscenesScene* scene;
	GeeHashMap* tags_;
};

struct _soybodiesBodyClass {
	GObjectClass parent_class;
	void (*create_geom) (soybodiesBody* self, GObject* geom_param, gfloat geom_scalar);
	void (*set_mass) (soybodiesBody* self, gfloat density);
	void (*add_extra) (soybodiesBody* self);
	void (*remove_extra) (soybodiesBody* self);
	gfloat (*pointDepth) (soybodiesBody* self, gfloat x, gfloat y, gfloat z);
	gfloat (*volume) (soybodiesBody* self);
	gint (*finite) (soybodiesBody* self);
	void (*mult_model_matrix) (soybodiesBody* self);
	void (*render) (soybodiesBody* self, gboolean alpha_stage, soybodiesCamera* camera, gint level);
	gfloat (*get_col_radius) (soybodiesBody* self);
};


extern gulong GeomScene;
gulong GeomScene = (gulong) 1;
extern gulong GeomBody;
gulong GeomBody = (gulong) 2;
extern gulong GeomField;
gulong GeomField = (gulong) 4;
extern gulong GeomLight;
gulong GeomLight = (gulong) 8;
extern gulong GeomGhost;
gulong GeomGhost = (gulong) 16;
extern gulong GeomTestRay;
gulong GeomTestRay = (gulong) 32;
extern gulong GeomIgnored;
gulong GeomIgnored = (gulong) 64;
extern gint MAX_RENDER_LEVEL;
gint MAX_RENDER_LEVEL = 1;
static gpointer soy_scenes_scene_parent_class = NULL;
extern soyscenes_PhysicsThread* soy_scenes__thread;
extern GRWLock soy_scenes__stepLock;
extern struct dxWorld* soy_scenes__world;

GType soy_scenes_scene_get_type (void) G_GNUC_CONST;
GType soy_bodies_body_get_type (void) G_GNUC_CONST;
GType soy_bodies_camera_get_type (void) G_GNUC_CONST;
GType soy_bodies_light_get_type (void) G_GNUC_CONST;
GType soy_joints_joint_get_type (void) G_GNUC_CONST;
GType soy_controllers_controller_get_type (void) G_GNUC_CONST;
GType soy_controllers_virtual_controller_get_type (void) G_GNUC_CONST;
GType soy_fields_field_get_type (void) G_GNUC_CONST;
GType soy_textures_texture_get_type (void) G_GNUC_CONST;
GType soy_textures_cubemap_get_type (void) G_GNUC_CONST;
GType soy_atoms_color_get_type (void) G_GNUC_CONST;
GType soy_atoms_vector_get_type (void) G_GNUC_CONST;
GType soy_atoms_position_get_type (void) G_GNUC_CONST;
#define SOY_SCENES_SCENE_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), SOY_SCENES_TYPE_SCENE, soyscenesScenePrivate))
enum  {
	SOY_SCENES_SCENE_DUMMY_PROPERTY,
	SOY_SCENES_SCENE_TIME,
	SOY_SCENES_SCENE_AMBIENT,
	SOY_SCENES_SCENE_FOG,
	SOY_SCENES_SCENE_GRAVITY,
	SOY_SCENES_SCENE_LENGTH,
	SOY_SCENES_SCENE_SKYBOX,
	SOY_SCENES_SCENE_STEPSIZE,
	SOY_SCENES_SCENE_POSITION
};
soyscenesScene* soy_scenes_scene_new (void);
soyscenesScene* soy_scenes_scene_construct (GType object_type);
soytexturesCubemap* soy_scenes_scene_get_skybox (soyscenesScene* self);
void soy_scenes_scene_set_rotation (soyscenesScene* self, GLfloat* value, int value_length1);
soyatomsPosition* soy_atoms_position_new (gfloat x, gfloat y, gfloat z);
soyatomsPosition* soy_atoms_position_construct (GType object_type, gfloat x, gfloat y, gfloat z);
void soy_scenes_scene_set_position (soyscenesScene* self, soyatomsPosition* value);
gboolean soy_scenes_scene_step (soyscenesScene* self);
GType soy_scenes__physicsthread_get_type (void) G_GNUC_CONST;
soyatomsVector* soy_atoms_vector_new (gfloat x, gfloat y, gfloat z);
soyatomsVector* soy_atoms_vector_construct (GType object_type, gfloat x, gfloat y, gfloat z);
soybodiesBody* soy_scenes_scene_get (soyscenesScene* self, const gchar* key);
gboolean soy_scenes_scene_has_key (soyscenesScene* self, const gchar* key);
void soy_scenes_scene_set (soyscenesScene* self, const gchar* key, soybodiesBody* value);
void soy_bodies_body_add (soybodiesBody* self, const gchar* k, soyscenesScene* v);
static void _soy_scenes_scene_collided (soyscenesScene* self, struct dxGeom* geomA, struct dxGeom* geomB);
void soy_fields_field_give (soyfieldsField* self, gint data);
gboolean soy_fields_field_apply (soyfieldsField* self);
void soy_fields_field_commit (soyfieldsField* self);
gfloat soy_bodies_body_get_density (soybodiesBody* self);
gfloat soy_bodies_body_volume (soybodiesBody* self);
void soy_bodies_body_addForce (soybodiesBody* self, dReal fx, dReal fy, dReal fz);
gfloat soy_atoms_vector_get_x (soyatomsVector* self);
gfloat soy_atoms_vector_get_y (soyatomsVector* self);
gfloat soy_atoms_vector_get_z (soyatomsVector* self);
guint64 soy_scenes_scene_get_time (soyscenesScene* self);
void soy_scenes_scene_do_in_step (soyscenesScene* self);
void soy_controllers_virtual_controller_run_controller (soycontrollersVirtualController* self);
gboolean soy_controllers_virtual_controller_get_finished (soycontrollersVirtualController* self);
soyatomsPosition* soy_bodies_body_get_position (soybodiesBody* self);
gfloat soy_atoms_position_get_x (soyatomsPosition* self);
gfloat soy_atoms_position_get_y (soyatomsPosition* self);
gfloat soy_atoms_position_get_z (soyatomsPosition* self);
gfloat soy_bodies_body_get_col_radius (soybodiesBody* self);
static void __soy_scenes_scene_collided_dnear_callback (gpointer self, struct dxGeom* o1, struct dxGeom* o2);
static void soy_scenes_scene_real_do_in_step (soyscenesScene* self);
void soy_scenes_scene_render (soyscenesScene* self, GLfloat fov, GLfloat aspect, GLfloat znear, GLfloat zfar, soybodiesCamera* camera, gint level);
static void soy_scenes_scene_real_render (soyscenesScene* self, GLfloat fov, GLfloat aspect, GLfloat znear, GLfloat zfar, soybodiesCamera* camera, gint level);
void soy_scenes_scene_perspective (GLfloat fovy, GLfloat aspect, GLfloat zNear, GLfloat zFar);
static void _soy_scenes_scene_enable_skybox (soyscenesScene* self);
void soy_scenes_scene_render_extra (soyscenesScene* self);
void soy_bodies_light_on (soybodiesLight* self, GLenum id);
void soy_scenes_scene_body_distance_squared (gfloat* distances, gfloat* x_positions, gfloat* y_positions, gfloat* z_positions, gfloat x_origin, gfloat y_origin, gfloat z_origin, gint size);
void soy_bodies_body_render (soybodiesBody* self, gboolean alpha_stage, soybodiesCamera* camera, gint level);
void soy_joints_joint_render (soyjointsJoint* self);
void soy_bodies_light_off (soybodiesLight* self, GLenum id);
static void soy_scenes_scene_real_render_extra (soyscenesScene* self);
static void _soy_scenes_scene_check_collisions_NearCallback (soyscenesScene* self, struct dxGeom* o1, struct dxGeom* o2);
static void __soy_scenes_scene_check_collisions_NearCallback_dnear_callback (gpointer self, struct dxGeom* o1, struct dxGeom* o2);
gboolean soy_scenes_scene_check_path_collision (soyscenesScene* self, soyatomsPosition* start, soyatomsPosition* end);
gboolean* soy_scenes_scene_check_collisions (soyscenesScene* self, soyatomsPosition* start, soyatomsPosition** ends, int ends_length1, int* result_length1);
gboolean* soy_scenes_scene_check_collisions_with_radius (soyscenesScene* self, soyatomsPosition* start, soyatomsPosition** ends, int ends_length1, gfloat radius, int* result_length1);
GType soy_atoms_size_get_type (void) G_GNUC_CONST;
gboolean* soy_scenes_scene_check_collisions_with_size (soyscenesScene* self, soyatomsPosition* start, soyatomsPosition** ends, int ends_length1, soyatomsSize* aabb, int* result_length1);
gfloat soy_atoms_size_get_width (soyatomsSize* self);
gfloat soy_atoms_size_get_height (soyatomsSize* self);
gfloat soy_atoms_size_get_depth (soyatomsSize* self);
static void _soy_scenes_scene_update_skybox (soyscenesScene* self);
void soy_textures_texture_enable (soytexturesTexture* self);
void soy_textures_texture_disable (soytexturesTexture* self);
void soy_scenes_scene_calculateTSLV (soyscenesScene* self, GLfloat* vertices, int vertices_length1);
GLfloat* soy_scenes_scene_get_rotation (soyscenesScene* self, int* result_length1);
static GLfloat* _vala_array_dup9 (GLfloat* self, int length);
soyatomsPosition* soy_scenes_scene_get_position (soyscenesScene* self);
static void _soy_scenes_scene_ambient_set (soyscenesScene* self, soyatomsColor* color);
gfloat* soy_atoms_color_get4f (soyatomsColor* self, int* result_length1);
static void _soy_scenes_scene_ambient_weak (soyscenesScene* self, GObject* ambient);
static void _soy_scenes_scene_fog_set (soyscenesScene* self, soyatomsColor* color);
static void _soy_scenes_scene_fog_weak (soyscenesScene* self, GObject* ambient);
void soy_scenes_scene_body_distance (gfloat* distances, gfloat* x_positions, gfloat* y_positions, gfloat* z_positions, gfloat x_origin, gfloat y_origin, gfloat z_origin, gint size);
soyatomsColor* soy_scenes_scene_get_ambient (soyscenesScene* self);
soyatomsColor* soy_atoms_color_new_new4f (gfloat* rgba, int rgba_length1);
soyatomsColor* soy_atoms_color_construct_new4f (GType object_type, gfloat* rgba, int rgba_length1);
static void __soy_scenes_scene_ambient_set_soy_atoms_color_on_set (soyatomsColor* _sender, soyatomsColor* color, gpointer self);
static void __soy_scenes_scene_ambient_weak_gweak_notify (gpointer self, GObject* object);
void soy_scenes_scene_set_ambient (soyscenesScene* self, soyatomsColor* value);
soyatomsColor* soy_scenes_scene_get_fog (soyscenesScene* self);
static void __soy_scenes_scene_fog_set_soy_atoms_color_on_set (soyatomsColor* _sender, soyatomsColor* color, gpointer self);
static void __soy_scenes_scene_fog_weak_gweak_notify (gpointer self, GObject* object);
void soy_scenes_scene_set_fog (soyscenesScene* self, soyatomsColor* value);
soyatomsVector* soy_scenes_scene_get_gravity (soyscenesScene* self);
void soy_scenes_scene_set_gravity (soyscenesScene* self, soyatomsVector* value);
gulong soy_scenes_scene_get_length (soyscenesScene* self);
void soy_scenes_scene_set_skybox (soyscenesScene* self, soytexturesCubemap* value);
gfloat soy_scenes_scene_get_stepsize (soyscenesScene* self);
void soy_scenes_scene_set_stepsize (soyscenesScene* self, gfloat value);
static GLfloat* _vala_array_dup10 (GLfloat* self, int length);
soyscenes_PhysicsThread* soy_scenes__physicsthread_new (void);
soyscenes_PhysicsThread* soy_scenes__physicsthread_construct (GType object_type);
static void soy_scenes_scene_finalize (GObject* obj);
static void _vala_soy_scenes_scene_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec);
static void _vala_soy_scenes_scene_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec);
static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func);


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


soyscenesScene* soy_scenes_scene_construct (GType object_type) {
	soyscenesScene * self = NULL;
	GeeHashMap* _tmp0_;
	GeeHashSet* _tmp1_;
	GeeArrayList* _tmp2_;
	GeeHashSet* _tmp3_;
	GeeHashMap* _tmp4_;
	GeeLinkedList* _tmp5_;
	GeeLinkedList* _tmp6_;
	GLfloat* _tmp7_ = NULL;
	GLfloat* _tmp8_ = NULL;
	struct dxSpace* _tmp9_;
	struct dxJointGroup* _tmp10_;
	soytexturesCubemap* _tmp11_;
	soytexturesCubemap* _tmp12_;
	soytexturesCubemap* _tmp13_;
	void* _tmp14_ = NULL;
	GLfloat* _tmp15_ = NULL;
	GLfloat* _tmp16_;
	gint _tmp16__length1;
	soyatomsPosition* _tmp17_;
	soyatomsPosition* _tmp18_;
	GTimeVal _tmp19_;
	glong _tmp20_;
	GTimeVal _tmp21_;
	glong _tmp22_;
	GTimeVal _tmp23_;
	glong _tmp24_;
	GTimeVal _tmp25_;
	glong _tmp26_;
	GSource* _tmp27_;
	GSource* source;
	soyscenes_PhysicsThread* _tmp28_;
	GMainContext* _tmp29_;
	soyatomsVector* _tmp30_;
	self = (soyscenesScene*) g_object_new (object_type, NULL);
	_tmp0_ = gee_hash_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, SOY_BODIES_TYPE_BODY, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL, NULL);
	_g_object_unref0 (self->bodies);
	self->bodies = _tmp0_;
	_tmp1_ = gee_hash_set_new (SOY_BODIES_TYPE_LIGHT, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL);
	_g_object_unref0 (self->lights);
	self->lights = _tmp1_;
	_tmp2_ = gee_array_list_new (SOY_JOINTS_TYPE_JOINT, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL);
	_g_object_unref0 (self->joints);
	self->joints = _tmp2_;
	_tmp3_ = gee_hash_set_new (SOY_CONTROLLERS_TYPE_VIRTUAL_CONTROLLER, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL);
	_g_object_unref0 (self->Controllers);
	self->Controllers = _tmp3_;
	_tmp4_ = gee_hash_map_new (G_TYPE_POINTER, NULL, NULL, SOY_FIELDS_TYPE_FIELD, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL, NULL);
	_g_object_unref0 (self->fields);
	self->fields = _tmp4_;
	_tmp5_ = gee_linked_list_new (SOY_FIELDS_TYPE_FIELD, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL);
	_g_object_unref0 (self->priv->_callFields);
	self->priv->_callFields = _tmp5_;
	_tmp6_ = gee_linked_list_new (SOY_FIELDS_TYPE_FIELD, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL);
	_g_object_unref0 (self->priv->_giveFields);
	self->priv->_giveFields = _tmp6_;
	_tmp7_ = g_new0 (GLfloat, 4);
	_tmp7_[0] = (GLfloat) 0.5f;
	_tmp7_[1] = (GLfloat) 0.5f;
	_tmp7_[2] = (GLfloat) 0.5f;
	_tmp7_[3] = (GLfloat) 1.0f;
	self->priv->_ambient = (g_free (self->priv->_ambient), NULL);
	self->priv->_ambient = _tmp7_;
	self->priv->_ambient_length1 = 4;
	self->priv->__ambient_size_ = self->priv->_ambient_length1;
	_tmp8_ = g_new0 (GLfloat, 4);
	_tmp8_[0] = (GLfloat) 0.0f;
	_tmp8_[1] = (GLfloat) 0.0f;
	_tmp8_[2] = (GLfloat) 0.0f;
	_tmp8_[3] = (GLfloat) 0.0f;
	self->priv->_fog = (g_free (self->priv->_fog), NULL);
	self->priv->_fog = _tmp8_;
	self->priv->_fog_length1 = 4;
	self->priv->__fog_size_ = self->priv->_fog_length1;
	_tmp9_ = dSimpleSpaceCreate (NULL);
	_dSpaceDestroy0 (self->space);
	self->space = _tmp9_;
	_tmp10_ = dJointGroupCreate (0);
	_dJointGroupDestroy0 (self->priv->_contactGroup);
	self->priv->_contactGroup = _tmp10_;
	self->priv->_ebo = (GLuint) 0;
	_tmp11_ = soy_scenes_scene_get_skybox (self);
	_tmp12_ = _tmp11_;
	_tmp13_ = _g_object_ref0 (_tmp12_);
	_g_object_unref0 (self->priv->_skybox);
	self->priv->_skybox = _tmp13_;
	self->priv->_skybox_updated = TRUE;
	_tmp14_ = g_malloc ((gsize) ((sizeof (GLfloat) * 4) * 16));
	self->colTexels = _tmp14_;
	_tmp15_ = g_new0 (GLfloat, 9);
	_tmp15_[0] = (GLfloat) 1.0f;
	_tmp15_[1] = (GLfloat) 0.0f;
	_tmp15_[2] = (GLfloat) 0.0f;
	_tmp15_[3] = (GLfloat) 0.0f;
	_tmp15_[4] = (GLfloat) 1.0f;
	_tmp15_[5] = (GLfloat) 0.0f;
	_tmp15_[6] = (GLfloat) 0.0f;
	_tmp15_[7] = (GLfloat) 0.0f;
	_tmp15_[8] = (GLfloat) 1.0f;
	_tmp16_ = _tmp15_;
	_tmp16__length1 = 9;
	soy_scenes_scene_set_rotation (self, _tmp16_, 9);
	_tmp16_ = (g_free (_tmp16_), NULL);
	_tmp17_ = soy_atoms_position_new (0.0f, 0.0f, 0.0f);
	_tmp18_ = _tmp17_;
	soy_scenes_scene_set_position (self, _tmp18_);
	_g_object_unref0 (_tmp18_);
	g_get_current_time (&self->priv->_tv);
	_tmp19_ = self->priv->_tv;
	_tmp20_ = _tmp19_.tv_sec;
	_tmp21_ = self->priv->_tv;
	_tmp22_ = _tmp21_.tv_usec;
	self->priv->_time = (((guint64) _tmp20_) * 1000) + (((guint64) _tmp22_) / 1000);
	_tmp23_ = self->priv->_tv;
	_tmp24_ = _tmp23_.tv_sec;
	_tmp25_ = self->priv->_tv;
	_tmp26_ = _tmp25_.tv_usec;
	self->priv->_lastStep = (((guint64) _tmp24_) * 1000) + (((guint64) _tmp26_) / 1000);
	_tmp27_ = g_timeout_source_new ((guint) 10);
	source = _tmp27_;
	g_source_set_callback (source, (GSourceFunc) soy_scenes_scene_step, g_object_ref (self), g_object_unref);
	_tmp28_ = soy_scenes__thread;
	_tmp29_ = _tmp28_->context;
	g_source_attach (source, _tmp29_);
	_tmp30_ = soy_atoms_vector_new (0.0f, 0.0f, 0.0f);
	_g_object_unref0 (self->priv->_gravity);
	self->priv->_gravity = _tmp30_;
	_g_source_unref0 (source);
	return self;
}


soyscenesScene* soy_scenes_scene_new (void) {
	return soy_scenes_scene_construct (SOY_SCENES_TYPE_SCENE);
}


soybodiesBody* soy_scenes_scene_get (soyscenesScene* self, const gchar* key) {
	soybodiesBody* result = NULL;
	GeeHashMap* _tmp0_;
	GeeSet* _tmp1_;
	GeeSet* _tmp2_;
	GeeSet* _tmp3_;
	const gchar* _tmp4_;
	gboolean _tmp5_ = FALSE;
	gboolean _tmp6_;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (key != NULL, NULL);
	_tmp0_ = self->bodies;
	_tmp1_ = gee_abstract_map_get_keys ((GeeMap*) _tmp0_);
	_tmp2_ = _tmp1_;
	_tmp3_ = _tmp2_;
	_tmp4_ = key;
	_tmp5_ = gee_collection_contains ((GeeCollection*) _tmp3_, _tmp4_);
	_tmp6_ = _tmp5_;
	_g_object_unref0 (_tmp3_);
	if (_tmp6_) {
		GeeHashMap* _tmp7_;
		const gchar* _tmp8_;
		gpointer _tmp9_ = NULL;
		_tmp7_ = self->bodies;
		_tmp8_ = key;
		_tmp9_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp7_, _tmp8_);
		result = (soybodiesBody*) _tmp9_;
		return result;
	}
	result = NULL;
	return result;
}


gboolean soy_scenes_scene_has_key (soyscenesScene* self, const gchar* key) {
	gboolean result = FALSE;
	GeeHashMap* _tmp0_;
	const gchar* _tmp1_;
	gboolean _tmp2_ = FALSE;
	g_return_val_if_fail (self != NULL, FALSE);
	g_return_val_if_fail (key != NULL, FALSE);
	_tmp0_ = self->bodies;
	_tmp1_ = key;
	_tmp2_ = gee_abstract_map_has_key ((GeeAbstractMap*) _tmp0_, _tmp1_);
	result = _tmp2_;
	return result;
}


void soy_scenes_scene_set (soyscenesScene* self, const gchar* key, soybodiesBody* value) {
	GeeHashMap* _tmp0_;
	const gchar* _tmp1_;
	soybodiesBody* _tmp2_;
	soybodiesBody* _tmp3_;
	const gchar* _tmp4_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (key != NULL);
	g_rw_lock_writer_lock (&soy_scenes__stepLock);
	_tmp0_ = self->bodies;
	_tmp1_ = key;
	_tmp2_ = value;
	gee_abstract_map_set ((GeeAbstractMap*) _tmp0_, _tmp1_, _tmp2_);
	_tmp3_ = value;
	_tmp4_ = key;
	soy_bodies_body_add (_tmp3_, _tmp4_, self);
	g_rw_lock_writer_unlock (&soy_scenes__stepLock);
}


static void _soy_scenes_scene_collided (soyscenesScene* self, struct dxGeom* geomA, struct dxGeom* geomB) {
	gint numberOfContacts = 0;
	dContactGeom* _tmp0_;
	dContactGeom* contactGeoms;
	struct dxBody* bodyA;
	struct dxBody* bodyB;
	dContact contact = {0};
	struct dxGeom* _tmp1_;
	struct dxGeom* _tmp2_;
	dContactGeom* _tmp3_;
	gint _tmp4_ = 0;
	gint _tmp5_;
	struct dxGeom* _tmp6_;
	gulong _tmp7_ = 0UL;
	gulong _tmp8_;
	struct dxGeom* _tmp11_;
	gulong _tmp12_ = 0UL;
	gulong _tmp13_;
	struct dxGeom* _tmp16_;
	gulong _tmp17_ = 0UL;
	gulong _tmp18_;
	struct dxGeom* _tmp19_;
	gulong _tmp20_ = 0UL;
	gulong _tmp21_;
	struct dxBody* _tmp22_;
	struct dxBody* _tmp23_;
	GeeHashMap* _tmp24_;
	struct dxBody* _tmp25_;
	gboolean _tmp26_ = FALSE;
	GeeHashMap* _tmp32_;
	struct dxBody* _tmp33_;
	gboolean _tmp34_ = FALSE;
	gint _tmp40_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (geomA != NULL);
	g_return_if_fail (geomB != NULL);
	_tmp0_ = dcontact_geom_array_new (4);
	contactGeoms = _tmp0_;
	bodyA = NULL;
	bodyB = NULL;
	memset (&contact, 0, sizeof (dContact));
	_tmp1_ = geomA;
	_tmp2_ = geomB;
	_tmp3_ = contactGeoms;
	_tmp4_ = dCollide (_tmp1_, _tmp2_, 4, _tmp3_, (gint) sizeof (dContactGeom));
	numberOfContacts = _tmp4_;
	_tmp5_ = numberOfContacts;
	if (_tmp5_ == 0) {
		return;
	}
	_tmp6_ = geomA;
	_tmp7_ = dGeomGetCategoryBits (_tmp6_);
	_tmp8_ = GeomScene;
	if (_tmp7_ != _tmp8_) {
		struct dxGeom* _tmp9_;
		struct dxBody* _tmp10_ = NULL;
		_tmp9_ = geomA;
		_tmp10_ = dGeomGetBody (_tmp9_);
		bodyA = _tmp10_;
	}
	_tmp11_ = geomB;
	_tmp12_ = dGeomGetCategoryBits (_tmp11_);
	_tmp13_ = GeomScene;
	if (_tmp12_ != _tmp13_) {
		struct dxGeom* _tmp14_;
		struct dxBody* _tmp15_ = NULL;
		_tmp14_ = geomB;
		_tmp15_ = dGeomGetBody (_tmp14_);
		bodyB = _tmp15_;
	}
	_tmp16_ = geomA;
	_tmp17_ = dGeomGetCategoryBits (_tmp16_);
	_tmp18_ = GeomGhost;
	if (_tmp17_ == _tmp18_) {
		bodyB = NULL;
	}
	_tmp19_ = geomB;
	_tmp20_ = dGeomGetCategoryBits (_tmp19_);
	_tmp21_ = GeomGhost;
	if (_tmp20_ == _tmp21_) {
		bodyA = NULL;
	}
	_tmp22_ = bodyA;
	_tmp23_ = bodyB;
	if (_tmp22_ == _tmp23_) {
		return;
	}
	_tmp24_ = self->fields;
	_tmp25_ = bodyA;
	_tmp26_ = gee_abstract_map_has_key ((GeeAbstractMap*) _tmp24_, _tmp25_);
	if (_tmp26_) {
		GeeLinkedList* _tmp27_;
		GeeHashMap* _tmp28_;
		struct dxBody* _tmp29_;
		gpointer _tmp30_ = NULL;
		soyfieldsField* _tmp31_;
		_tmp27_ = self->priv->_callFields;
		_tmp28_ = self->fields;
		_tmp29_ = bodyA;
		_tmp30_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp28_, _tmp29_);
		_tmp31_ = (soyfieldsField*) _tmp30_;
		gee_abstract_collection_add ((GeeAbstractCollection*) _tmp27_, _tmp31_);
		_g_object_unref0 (_tmp31_);
	}
	_tmp32_ = self->fields;
	_tmp33_ = bodyB;
	_tmp34_ = gee_abstract_map_has_key ((GeeAbstractMap*) _tmp32_, _tmp33_);
	if (_tmp34_) {
		GeeLinkedList* _tmp35_;
		GeeHashMap* _tmp36_;
		struct dxBody* _tmp37_;
		gpointer _tmp38_ = NULL;
		soyfieldsField* _tmp39_;
		_tmp35_ = self->priv->_callFields;
		_tmp36_ = self->fields;
		_tmp37_ = bodyB;
		_tmp38_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp36_, _tmp37_);
		_tmp39_ = (soyfieldsField*) _tmp38_;
		gee_abstract_collection_add ((GeeAbstractCollection*) _tmp35_, _tmp39_);
		_g_object_unref0 (_tmp39_);
	}
	_tmp40_ = numberOfContacts;
	numberOfContacts = _tmp40_ - 1;
	{
		gint i;
		i = 0;
		{
			gboolean _tmp41_;
			_tmp41_ = TRUE;
			while (TRUE) {
				gboolean _tmp42_;
				gint _tmp44_;
				dContactGeom* _tmp45_;
				gint _tmp46_;
				dContactGeom _tmp47_ = {0};
				struct dxWorld* _tmp48_;
				struct dxJointGroup* _tmp49_;
				dContact _tmp50_;
				struct dxJoint* _tmp51_;
				struct dxJoint* joint;
				struct dxJoint* _tmp52_;
				struct dxBody* _tmp53_;
				struct dxBody* _tmp54_;
				_tmp42_ = _tmp41_;
				if (!_tmp42_) {
					gint _tmp43_;
					_tmp43_ = i;
					i = _tmp43_ + 1;
				}
				_tmp41_ = FALSE;
				_tmp44_ = numberOfContacts;
				if (!(i <= _tmp44_)) {
					break;
				}
				_tmp45_ = contactGeoms;
				_tmp46_ = i;
				dcontact_geom_array_get (_tmp45_, _tmp46_, &_tmp47_);
				contact.geom = _tmp47_;
				contact.surface.mode = (gint) dContactBounce;
				contact.surface.mu = (dReal) 0.0;
				contact.surface.bounce = (dReal) 0.8;
				contact.surface.bounce_vel = (dReal) 0.0;
				_tmp48_ = soy_scenes__world;
				_tmp49_ = self->priv->_contactGroup;
				_tmp50_ = contact;
				_tmp51_ = dJointCreateContact (_tmp48_, _tmp49_, &_tmp50_);
				joint = _tmp51_;
				_tmp52_ = joint;
				_tmp53_ = bodyA;
				_tmp54_ = bodyB;
				dJointAttach (_tmp52_, _tmp53_, _tmp54_);
			}
		}
	}
	return;
}


static void __soy_scenes_scene_collided_dnear_callback (gpointer self, struct dxGeom* o1, struct dxGeom* o2) {
	_soy_scenes_scene_collided (self, o1, o2);
}


gboolean soy_scenes_scene_step (soyscenesScene* self) {
	gboolean result = FALSE;
	GeeLinkedList* _tmp0_;
	GeeLinkedList* _tmp1_;
	GeeLinkedList* _tmp44_;
	GeeLinkedList* finished_controllers;
	GTimeVal _tmp73_;
	glong _tmp74_;
	GTimeVal _tmp75_;
	glong _tmp76_;
	guint64 _tmp77_;
	guint64 _tmp78_;
	guint64 _tmp79_;
	glong _tmp80_ = 0L;
	glong steps;
	guint64 _tmp81_;
	g_return_val_if_fail (self != NULL, FALSE);
	_tmp0_ = self->priv->_callFields;
	gee_abstract_collection_clear ((GeeAbstractCollection*) _tmp0_);
	_tmp1_ = self->priv->_giveFields;
	gee_abstract_collection_clear ((GeeAbstractCollection*) _tmp1_);
	{
		GeeHashMap* _tmp2_;
		GeeCollection* _tmp3_;
		GeeCollection* _tmp4_;
		GeeCollection* _tmp5_;
		GeeIterator* _tmp6_ = NULL;
		GeeIterator* _tmp7_;
		GeeIterator* _field_it;
		_tmp2_ = self->fields;
		_tmp3_ = gee_abstract_map_get_values ((GeeMap*) _tmp2_);
		_tmp4_ = _tmp3_;
		_tmp5_ = _tmp4_;
		_tmp6_ = gee_iterable_iterator ((GeeIterable*) _tmp5_);
		_tmp7_ = _tmp6_;
		_g_object_unref0 (_tmp5_);
		_field_it = _tmp7_;
		while (TRUE) {
			GeeIterator* _tmp8_;
			gboolean _tmp9_ = FALSE;
			GeeIterator* _tmp10_;
			gpointer _tmp11_ = NULL;
			soyfieldsField* field;
			GeeLinkedList* _tmp12_;
			soyfieldsField* _tmp13_;
			gboolean _tmp14_ = FALSE;
			_tmp8_ = _field_it;
			_tmp9_ = gee_iterator_next (_tmp8_);
			if (!_tmp9_) {
				break;
			}
			_tmp10_ = _field_it;
			_tmp11_ = gee_iterator_get (_tmp10_);
			field = (soyfieldsField*) _tmp11_;
			_tmp12_ = self->priv->_giveFields;
			_tmp13_ = field;
			_tmp14_ = gee_abstract_collection_contains ((GeeAbstractCollection*) _tmp12_, _tmp13_);
			if (!_tmp14_) {
				soyfieldsField* _tmp15_;
				GeeLinkedList* _tmp16_;
				soyfieldsField* _tmp17_;
				_tmp15_ = field;
				soy_fields_field_give (_tmp15_, 0);
				_tmp16_ = self->priv->_giveFields;
				_tmp17_ = field;
				gee_abstract_collection_add ((GeeAbstractCollection*) _tmp16_, _tmp17_);
			}
			_g_object_unref0 (field);
		}
		_g_object_unref0 (_field_it);
	}
	{
		GeeHashMap* _tmp18_;
		GeeCollection* _tmp19_;
		GeeCollection* _tmp20_;
		GeeCollection* _tmp21_;
		GeeIterator* _tmp22_ = NULL;
		GeeIterator* _tmp23_;
		GeeIterator* _field_it;
		_tmp18_ = self->fields;
		_tmp19_ = gee_abstract_map_get_values ((GeeMap*) _tmp18_);
		_tmp20_ = _tmp19_;
		_tmp21_ = _tmp20_;
		_tmp22_ = gee_iterable_iterator ((GeeIterable*) _tmp21_);
		_tmp23_ = _tmp22_;
		_g_object_unref0 (_tmp21_);
		_field_it = _tmp23_;
		while (TRUE) {
			GeeIterator* _tmp24_;
			gboolean _tmp25_ = FALSE;
			GeeIterator* _tmp26_;
			gpointer _tmp27_ = NULL;
			soyfieldsField* field;
			soyfieldsField* _tmp28_;
			gboolean _tmp29_ = FALSE;
			_tmp24_ = _field_it;
			_tmp25_ = gee_iterator_next (_tmp24_);
			if (!_tmp25_) {
				break;
			}
			_tmp26_ = _field_it;
			_tmp27_ = gee_iterator_get (_tmp26_);
			field = (soyfieldsField*) _tmp27_;
			_tmp28_ = field;
			_tmp29_ = soy_fields_field_apply (_tmp28_);
			if (!_tmp29_) {
				GeeLinkedList* _tmp30_;
				soyfieldsField* _tmp31_;
				_tmp30_ = self->priv->_callFields;
				_tmp31_ = field;
				gee_abstract_collection_add ((GeeAbstractCollection*) _tmp30_, _tmp31_);
			}
			_g_object_unref0 (field);
		}
		_g_object_unref0 (_field_it);
	}
	{
		GeeLinkedList* _tmp32_;
		GeeLinkedList* _tmp33_;
		GeeLinkedList* _field_list;
		GeeLinkedList* _tmp34_;
		gint _tmp35_;
		gint _tmp36_;
		gint _field_size;
		gint _field_index;
		_tmp32_ = self->priv->_callFields;
		_tmp33_ = _g_object_ref0 (_tmp32_);
		_field_list = _tmp33_;
		_tmp34_ = _field_list;
		_tmp35_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp34_);
		_tmp36_ = _tmp35_;
		_field_size = _tmp36_;
		_field_index = -1;
		while (TRUE) {
			gint _tmp37_;
			gint _tmp38_;
			gint _tmp39_;
			GeeLinkedList* _tmp40_;
			gint _tmp41_;
			gpointer _tmp42_ = NULL;
			soyfieldsField* field;
			soyfieldsField* _tmp43_;
			_tmp37_ = _field_index;
			_field_index = _tmp37_ + 1;
			_tmp38_ = _field_index;
			_tmp39_ = _field_size;
			if (!(_tmp38_ < _tmp39_)) {
				break;
			}
			_tmp40_ = _field_list;
			_tmp41_ = _field_index;
			_tmp42_ = gee_abstract_list_get ((GeeAbstractList*) _tmp40_, _tmp41_);
			field = (soyfieldsField*) _tmp42_;
			_tmp43_ = field;
			soy_fields_field_commit (_tmp43_);
			_g_object_unref0 (field);
		}
		_g_object_unref0 (_field_list);
	}
	_tmp44_ = gee_linked_list_new (SOY_CONTROLLERS_TYPE_VIRTUAL_CONTROLLER, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL);
	finished_controllers = _tmp44_;
	{
		GeeHashMap* _tmp45_;
		GeeCollection* _tmp46_;
		GeeCollection* _tmp47_;
		GeeCollection* _tmp48_;
		GeeIterator* _tmp49_ = NULL;
		GeeIterator* _tmp50_;
		GeeIterator* _body_it;
		_tmp45_ = self->bodies;
		_tmp46_ = gee_abstract_map_get_values ((GeeMap*) _tmp45_);
		_tmp47_ = _tmp46_;
		_tmp48_ = _tmp47_;
		_tmp49_ = gee_iterable_iterator ((GeeIterable*) _tmp48_);
		_tmp50_ = _tmp49_;
		_g_object_unref0 (_tmp48_);
		_body_it = _tmp50_;
		while (TRUE) {
			GeeIterator* _tmp51_;
			gboolean _tmp52_ = FALSE;
			GeeIterator* _tmp53_;
			gpointer _tmp54_ = NULL;
			soybodiesBody* body;
			soybodiesBody* _tmp55_;
			gfloat _tmp56_;
			gfloat _tmp57_;
			soybodiesBody* _tmp58_;
			gfloat _tmp59_ = 0.0F;
			gfloat m;
			soybodiesBody* _tmp60_;
			gfloat _tmp61_;
			soyatomsVector* _tmp62_;
			gfloat _tmp63_;
			gfloat _tmp64_;
			gfloat _tmp65_;
			soyatomsVector* _tmp66_;
			gfloat _tmp67_;
			gfloat _tmp68_;
			gfloat _tmp69_;
			soyatomsVector* _tmp70_;
			gfloat _tmp71_;
			gfloat _tmp72_;
			_tmp51_ = _body_it;
			_tmp52_ = gee_iterator_next (_tmp51_);
			if (!_tmp52_) {
				break;
			}
			_tmp53_ = _body_it;
			_tmp54_ = gee_iterator_get (_tmp53_);
			body = (soybodiesBody*) _tmp54_;
			_tmp55_ = body;
			_tmp56_ = soy_bodies_body_get_density (_tmp55_);
			_tmp57_ = _tmp56_;
			_tmp58_ = body;
			_tmp59_ = soy_bodies_body_volume (_tmp58_);
			m = _tmp57_ * _tmp59_;
			_tmp60_ = body;
			_tmp61_ = m;
			_tmp62_ = self->priv->_gravity;
			_tmp63_ = soy_atoms_vector_get_x (_tmp62_);
			_tmp64_ = _tmp63_;
			_tmp65_ = m;
			_tmp66_ = self->priv->_gravity;
			_tmp67_ = soy_atoms_vector_get_y (_tmp66_);
			_tmp68_ = _tmp67_;
			_tmp69_ = m;
			_tmp70_ = self->priv->_gravity;
			_tmp71_ = soy_atoms_vector_get_z (_tmp70_);
			_tmp72_ = _tmp71_;
			soy_bodies_body_addForce (_tmp60_, (dReal) (_tmp61_ * _tmp64_), (dReal) (_tmp65_ * _tmp68_), (dReal) (_tmp69_ * _tmp72_));
			_g_object_unref0 (body);
		}
		_g_object_unref0 (_body_it);
	}
	g_get_current_time (&self->priv->_tv);
	_tmp73_ = self->priv->_tv;
	_tmp74_ = _tmp73_.tv_sec;
	_tmp75_ = self->priv->_tv;
	_tmp76_ = _tmp75_.tv_usec;
	self->priv->_time = (((guint64) _tmp74_) * 1000) + (((guint64) _tmp76_) / 1000);
	_tmp77_ = soy_scenes_scene_get_time (self);
	_tmp78_ = _tmp77_;
	_tmp79_ = self->priv->_lastStep;
	_tmp80_ = lround ((gdouble) ((_tmp78_ - _tmp79_) / 10));
	steps = _tmp80_;
	_tmp81_ = self->priv->_time;
	self->priv->_lastStep = _tmp81_;
	g_rw_lock_writer_lock (&soy_scenes__stepLock);
	{
		gint i;
		i = 0;
		{
			gboolean _tmp82_;
			_tmp82_ = TRUE;
			while (TRUE) {
				gboolean _tmp83_;
				glong _tmp85_;
				GTimeVal _tmp86_;
				glong _tmp87_;
				GTimeVal _tmp88_;
				glong _tmp89_;
				GeeLinkedList* _tmp102_;
				GeeHashSet* _tmp115_;
				GeeLinkedList* _tmp116_;
				GeeLinkedList* _tmp117_;
				GeeHashMap* _tmp118_;
				GeeCollection* _tmp119_;
				GeeCollection* _tmp120_;
				GeeCollection* _tmp121_;
				gboolean _tmp122_;
				struct dxSpace* _tmp171_;
				struct dxWorld* _tmp172_;
				struct dxJointGroup* _tmp173_;
				gint _tmp174_;
				_tmp83_ = _tmp82_;
				if (!_tmp83_) {
					gint _tmp84_;
					_tmp84_ = i;
					i = _tmp84_ + 1;
				}
				_tmp82_ = FALSE;
				_tmp85_ = steps;
				if (!(i <= _tmp85_)) {
					break;
				}
				g_get_current_time (&self->priv->_tv);
				_tmp86_ = self->priv->_tv;
				_tmp87_ = _tmp86_.tv_sec;
				_tmp88_ = self->priv->_tv;
				_tmp89_ = _tmp88_.tv_usec;
				self->priv->_time = (((guint64) _tmp87_) * 1000) + (((guint64) _tmp89_) / 1000);
				soy_scenes_scene_do_in_step (self);
				{
					GeeLinkedList* _tmp90_;
					GeeLinkedList* _tmp91_;
					GeeLinkedList* _field_list;
					GeeLinkedList* _tmp92_;
					gint _tmp93_;
					gint _tmp94_;
					gint _field_size;
					gint _field_index;
					_tmp90_ = self->priv->_giveFields;
					_tmp91_ = _g_object_ref0 (_tmp90_);
					_field_list = _tmp91_;
					_tmp92_ = _field_list;
					_tmp93_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp92_);
					_tmp94_ = _tmp93_;
					_field_size = _tmp94_;
					_field_index = -1;
					while (TRUE) {
						gint _tmp95_;
						gint _tmp96_;
						gint _tmp97_;
						GeeLinkedList* _tmp98_;
						gint _tmp99_;
						gpointer _tmp100_ = NULL;
						soyfieldsField* field;
						soyfieldsField* _tmp101_;
						_tmp95_ = _field_index;
						_field_index = _tmp95_ + 1;
						_tmp96_ = _field_index;
						_tmp97_ = _field_size;
						if (!(_tmp96_ < _tmp97_)) {
							break;
						}
						_tmp98_ = _field_list;
						_tmp99_ = _field_index;
						_tmp100_ = gee_abstract_list_get ((GeeAbstractList*) _tmp98_, _tmp99_);
						field = (soyfieldsField*) _tmp100_;
						_tmp101_ = field;
						soy_fields_field_give (_tmp101_, 1);
						_g_object_unref0 (field);
					}
					_g_object_unref0 (_field_list);
				}
				_tmp102_ = self->priv->_callFields;
				gee_abstract_collection_clear ((GeeAbstractCollection*) _tmp102_);
				{
					GeeHashSet* _tmp103_;
					GeeIterator* _tmp104_ = NULL;
					GeeIterator* _cont_it;
					_tmp103_ = self->Controllers;
					_tmp104_ = gee_abstract_collection_iterator ((GeeAbstractCollection*) _tmp103_);
					_cont_it = _tmp104_;
					while (TRUE) {
						GeeIterator* _tmp105_;
						gboolean _tmp106_ = FALSE;
						GeeIterator* _tmp107_;
						gpointer _tmp108_ = NULL;
						soycontrollersVirtualController* cont;
						soycontrollersVirtualController* _tmp109_;
						soycontrollersVirtualController* _tmp110_;
						gboolean _tmp111_;
						gboolean _tmp112_;
						_tmp105_ = _cont_it;
						_tmp106_ = gee_iterator_next (_tmp105_);
						if (!_tmp106_) {
							break;
						}
						_tmp107_ = _cont_it;
						_tmp108_ = gee_iterator_get (_tmp107_);
						cont = (soycontrollersVirtualController*) _tmp108_;
						_tmp109_ = cont;
						soy_controllers_virtual_controller_run_controller (_tmp109_);
						_tmp110_ = cont;
						_tmp111_ = soy_controllers_virtual_controller_get_finished (_tmp110_);
						_tmp112_ = _tmp111_;
						if (_tmp112_) {
							GeeLinkedList* _tmp113_;
							soycontrollersVirtualController* _tmp114_;
							_tmp113_ = finished_controllers;
							_tmp114_ = cont;
							gee_abstract_collection_add ((GeeAbstractCollection*) _tmp113_, _tmp114_);
						}
						_g_object_unref0 (cont);
					}
					_g_object_unref0 (_cont_it);
				}
				_tmp115_ = self->Controllers;
				_tmp116_ = finished_controllers;
				gee_abstract_collection_remove_all ((GeeAbstractCollection*) _tmp115_, (GeeCollection*) _tmp116_);
				_tmp117_ = finished_controllers;
				gee_abstract_collection_clear ((GeeAbstractCollection*) _tmp117_);
				_tmp118_ = self->bodies;
				_tmp119_ = gee_abstract_map_get_values ((GeeMap*) _tmp118_);
				_tmp120_ = _tmp119_;
				_tmp121_ = _tmp120_;
				_tmp122_ = _tmp121_ != NULL;
				_g_object_unref0 (_tmp121_);
				if (_tmp122_) {
					GeeHashMap* _tmp123_;
					GeeCollection* _tmp124_;
					GeeCollection* _tmp125_;
					GeeCollection* _tmp126_;
					gint _tmp127_ = 0;
					gpointer* _tmp128_ = NULL;
					soybodiesBody** _tmp129_;
					gint _tmp129__length1;
					soybodiesBody** bodies_arr;
					gint bodies_arr_length1;
					gint _bodies_arr_size_;
					GLuint _tmp130_;
					GLuint _tmp132_;
					gint index;
					soybodiesBody** _tmp133_;
					gint _tmp133__length1;
					GLfloat* _tmp170_;
					_tmp123_ = self->bodies;
					_tmp124_ = gee_abstract_map_get_values ((GeeMap*) _tmp123_);
					_tmp125_ = _tmp124_;
					_tmp126_ = _tmp125_;
					_tmp128_ = gee_collection_to_array (_tmp126_, &_tmp127_);
					_tmp129_ = _tmp128_;
					_tmp129__length1 = _tmp127_;
					_g_object_unref0 (_tmp126_);
					bodies_arr = _tmp129_;
					bodies_arr_length1 = _tmp129__length1;
					_bodies_arr_size_ = bodies_arr_length1;
					glEnable (GL_TEXTURE_2D);
					_tmp130_ = self->priv->_colTextureID;
					if (_tmp130_ == ((GLuint) 0)) {
						GLuint _tmp131_ = 0U;
						glGenTextures ((GLsizei) 1, &_tmp131_);
						self->priv->_colTextureID = _tmp131_;
					}
					glActiveTexture (GL_TEXTURE0);
					_tmp132_ = self->priv->_colTextureID;
					glBindTexture (GL_TEXTURE_2D, _tmp132_);
					index = 0;
					_tmp133_ = bodies_arr;
					_tmp133__length1 = bodies_arr_length1;
					{
						soybodiesBody** body_collection = NULL;
						gint body_collection_length1 = 0;
						gint _body_collection_size_ = 0;
						gint body_it = 0;
						body_collection = _tmp133_;
						body_collection_length1 = _tmp133__length1;
						for (body_it = 0; body_it < _tmp133__length1; body_it = body_it + 1) {
							soybodiesBody* _tmp134_;
							soybodiesBody* body = NULL;
							_tmp134_ = _g_object_ref0 (body_collection[body_it]);
							body = _tmp134_;
							{
								gint _tmp135_;
								GLfloat* _tmp136_;
								gint _tmp137_;
								soybodiesBody* _tmp138_;
								soyatomsPosition* _tmp139_;
								soyatomsPosition* _tmp140_;
								soyatomsPosition* _tmp141_;
								gfloat _tmp142_;
								gfloat _tmp143_;
								GLfloat _tmp144_;
								GLfloat* _tmp145_;
								gint _tmp146_;
								soybodiesBody* _tmp147_;
								soyatomsPosition* _tmp148_;
								soyatomsPosition* _tmp149_;
								soyatomsPosition* _tmp150_;
								gfloat _tmp151_;
								gfloat _tmp152_;
								GLfloat _tmp153_;
								GLfloat* _tmp154_;
								gint _tmp155_;
								soybodiesBody* _tmp156_;
								soyatomsPosition* _tmp157_;
								soyatomsPosition* _tmp158_;
								soyatomsPosition* _tmp159_;
								gfloat _tmp160_;
								gfloat _tmp161_;
								GLfloat _tmp162_;
								GLfloat* _tmp163_;
								gint _tmp164_;
								soybodiesBody* _tmp165_;
								gfloat _tmp166_;
								gfloat _tmp167_;
								GLfloat _tmp168_;
								gint _tmp169_;
								_tmp135_ = index;
								if (_tmp135_ >= 64) {
									_g_object_unref0 (body);
									break;
								}
								_tmp136_ = self->colTexels;
								_tmp137_ = index;
								_tmp138_ = body;
								_tmp139_ = soy_bodies_body_get_position (_tmp138_);
								_tmp140_ = _tmp139_;
								_tmp141_ = _tmp140_;
								_tmp142_ = soy_atoms_position_get_x (_tmp141_);
								_tmp143_ = _tmp142_;
								_tmp136_[_tmp137_] = (GLfloat) _tmp143_;
								_tmp144_ = _tmp136_[_tmp137_];
								_g_object_unref0 (_tmp141_);
								_tmp145_ = self->colTexels;
								_tmp146_ = index;
								_tmp147_ = body;
								_tmp148_ = soy_bodies_body_get_position (_tmp147_);
								_tmp149_ = _tmp148_;
								_tmp150_ = _tmp149_;
								_tmp151_ = soy_atoms_position_get_y (_tmp150_);
								_tmp152_ = _tmp151_;
								_tmp145_[_tmp146_ + 1] = (GLfloat) _tmp152_;
								_tmp153_ = _tmp145_[_tmp146_ + 1];
								_g_object_unref0 (_tmp150_);
								_tmp154_ = self->colTexels;
								_tmp155_ = index;
								_tmp156_ = body;
								_tmp157_ = soy_bodies_body_get_position (_tmp156_);
								_tmp158_ = _tmp157_;
								_tmp159_ = _tmp158_;
								_tmp160_ = soy_atoms_position_get_z (_tmp159_);
								_tmp161_ = _tmp160_;
								_tmp154_[_tmp155_ + 2] = (GLfloat) _tmp161_;
								_tmp162_ = _tmp154_[_tmp155_ + 2];
								_g_object_unref0 (_tmp159_);
								_tmp163_ = self->colTexels;
								_tmp164_ = index;
								_tmp165_ = body;
								_tmp166_ = soy_bodies_body_get_col_radius (_tmp165_);
								_tmp167_ = _tmp166_;
								_tmp163_[_tmp164_ + 3] = (GLfloat) _tmp167_;
								_tmp168_ = _tmp163_[_tmp164_ + 3];
								_tmp169_ = index;
								index = _tmp169_ + 4;
								_g_object_unref0 (body);
							}
						}
					}
					_tmp170_ = self->colTexels;
					glTexImage2D (GL_TEXTURE_2D, (GLint) 0, (GLint) GL_RGBA, (GLsizei) 4, (GLsizei) 4, (GLint) 0, GL_RGBA, GL_FLOAT, (GLvoid*) _tmp170_);
					glDisable (GL_TEXTURE_2D);
					bodies_arr = (_vala_array_free (bodies_arr, bodies_arr_length1, (GDestroyNotify) g_object_unref), NULL);
				}
				_tmp171_ = self->space;
				dSpaceCollide (_tmp171_, self, __soy_scenes_scene_collided_dnear_callback);
				_tmp172_ = soy_scenes__world;
				dWorldQuickStep (_tmp172_, (dReal) 0.01f);
				_tmp173_ = self->priv->_contactGroup;
				dJointGroupEmpty (_tmp173_);
				_tmp174_ = i;
				if (_tmp174_ != 0) {
					{
						GeeLinkedList* _tmp175_;
						GeeLinkedList* _tmp176_;
						GeeLinkedList* _field_list;
						GeeLinkedList* _tmp177_;
						gint _tmp178_;
						gint _tmp179_;
						gint _field_size;
						gint _field_index;
						_tmp175_ = self->priv->_callFields;
						_tmp176_ = _g_object_ref0 (_tmp175_);
						_field_list = _tmp176_;
						_tmp177_ = _field_list;
						_tmp178_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp177_);
						_tmp179_ = _tmp178_;
						_field_size = _tmp179_;
						_field_index = -1;
						while (TRUE) {
							gint _tmp180_;
							gint _tmp181_;
							gint _tmp182_;
							GeeLinkedList* _tmp183_;
							gint _tmp184_;
							gpointer _tmp185_ = NULL;
							soyfieldsField* field;
							soyfieldsField* _tmp186_;
							_tmp180_ = _field_index;
							_field_index = _tmp180_ + 1;
							_tmp181_ = _field_index;
							_tmp182_ = _field_size;
							if (!(_tmp181_ < _tmp182_)) {
								break;
							}
							_tmp183_ = _field_list;
							_tmp184_ = _field_index;
							_tmp185_ = gee_abstract_list_get ((GeeAbstractList*) _tmp183_, _tmp184_);
							field = (soyfieldsField*) _tmp185_;
							_tmp186_ = field;
							soy_fields_field_give (_tmp186_, 0);
							_g_object_unref0 (field);
						}
						_g_object_unref0 (_field_list);
					}
				}
			}
		}
	}
	g_rw_lock_writer_unlock (&soy_scenes__stepLock);
	result = TRUE;
	_g_object_unref0 (finished_controllers);
	return result;
}


static void soy_scenes_scene_real_do_in_step (soyscenesScene* self) {
}


void soy_scenes_scene_do_in_step (soyscenesScene* self) {
	g_return_if_fail (self != NULL);
	SOY_SCENES_SCENE_GET_CLASS (self)->do_in_step (self);
}


static void soy_scenes_scene_real_render (soyscenesScene* self, GLfloat fov, GLfloat aspect, GLfloat znear, GLfloat zfar, soybodiesCamera* camera, gint level) {
	gint _tmp0_;
	gint _tmp1_;
	GLenum i = 0U;
	GLfloat _tmp2_;
	GLfloat _tmp3_;
	GLfloat _tmp4_;
	GLfloat _tmp5_;
	soytexturesCubemap* _tmp6_;
	soybodiesCamera* _tmp11_;
	soyatomsPosition* _tmp12_;
	soyatomsPosition* _tmp13_;
	soyatomsPosition* pos;
	soyatomsPosition* _tmp14_;
	gfloat _tmp15_;
	gfloat _tmp16_;
	soyatomsPosition* _tmp17_;
	gfloat _tmp18_;
	gfloat _tmp19_;
	soyatomsPosition* _tmp20_;
	gfloat _tmp21_;
	gfloat _tmp22_;
	GLfloat* _tmp23_;
	gint _tmp23__length1;
	GLfloat* _tmp24_;
	gint _tmp24__length1;
	GLfloat _tmp25_;
	GeeHashMap* _tmp38_;
	gint _tmp39_;
	gint _tmp40_;
	gint size;
	GeeHashMap* _tmp41_;
	GeeCollection* _tmp42_;
	GeeCollection* _tmp43_;
	GeeCollection* _tmp44_;
	gboolean _tmp45_;
	GLfloat* _tmp154_;
	gint _tmp154__length1;
	GLfloat _tmp155_;
	g_return_if_fail (camera != NULL);
	_tmp0_ = level;
	_tmp1_ = MAX_RENDER_LEVEL;
	if (_tmp0_ > _tmp1_) {
		return;
	}
	glMatrixMode (GL_PROJECTION);
	glLoadIdentity ();
	_tmp2_ = fov;
	_tmp3_ = aspect;
	_tmp4_ = znear;
	_tmp5_ = zfar;
	soy_scenes_scene_perspective (_tmp2_, _tmp3_, _tmp4_, _tmp5_);
	glMatrixMode (GL_MODELVIEW);
	glClear ((GLbitfield) GL_DEPTH_BUFFER_BIT);
	_tmp6_ = self->priv->_skybox;
	if (_tmp6_ != NULL) {
		GLfloat _tmp7_;
		GLfloat z;
		GLfloat _tmp8_;
		GLfloat _tmp9_;
		GLfloat _tmp10_;
		_tmp7_ = zfar;
		z = _tmp7_ / 2.0f;
		glPushMatrix ();
		_tmp8_ = z;
		_tmp9_ = z;
		_tmp10_ = z;
		glScalef (_tmp8_, _tmp9_, _tmp10_);
		_soy_scenes_scene_enable_skybox (self);
		glPopMatrix ();
	}
	_tmp11_ = camera;
	_tmp12_ = soy_bodies_body_get_position ((soybodiesBody*) _tmp11_);
	_tmp13_ = _tmp12_;
	pos = _tmp13_;
	_tmp14_ = pos;
	_tmp15_ = soy_atoms_position_get_x (_tmp14_);
	_tmp16_ = _tmp15_;
	_tmp17_ = pos;
	_tmp18_ = soy_atoms_position_get_y (_tmp17_);
	_tmp19_ = _tmp18_;
	_tmp20_ = pos;
	_tmp21_ = soy_atoms_position_get_z (_tmp20_);
	_tmp22_ = _tmp21_;
	glTranslatef (-((GLfloat) _tmp16_), -((GLfloat) _tmp19_), -((GLfloat) _tmp22_));
	glEnable (GL_DEPTH_TEST);
	glEnable (GL_LIGHTING);
	_tmp23_ = self->priv->_ambient;
	_tmp23__length1 = self->priv->_ambient_length1;
	glLightModelfv (GL_LIGHT_MODEL_AMBIENT, _tmp23_);
	soy_scenes_scene_render_extra (self);
	_tmp24_ = self->priv->_fog;
	_tmp24__length1 = self->priv->_fog_length1;
	_tmp25_ = _tmp24_[3];
	if (_tmp25_ != ((GLfloat) 0.0f)) {
		GLfloat* _tmp26_;
		gint _tmp26__length1;
		GLfloat* _tmp27_;
		gint _tmp27__length1;
		GLfloat _tmp28_;
		glClearColor ((GLclampf) 0.5f, (GLclampf) 0.5f, (GLclampf) 0.5f, (GLclampf) 1.0f);
		glEnable (GL_FOG);
		glFogf (GL_FOG_MODE, (GLfloat) GL_EXP2);
		_tmp26_ = self->priv->_fog;
		_tmp26__length1 = self->priv->_fog_length1;
		glFogfv (GL_FOG_COLOR, _tmp26_);
		_tmp27_ = self->priv->_fog;
		_tmp27__length1 = self->priv->_fog_length1;
		_tmp28_ = _tmp27_[3];
		glFogf (GL_FOG_DENSITY, _tmp28_ / 20.0f);
		glHint (GL_FOG_HINT, GL_NICEST);
		glFogf (GL_FOG_START, (GLfloat) 1.0f);
		glFogf (GL_FOG_END, (GLfloat) 50.0f);
	}
	i = GL_LIGHT0;
	{
		GeeHashSet* _tmp29_;
		GeeIterator* _tmp30_ = NULL;
		GeeIterator* _light_it;
		_tmp29_ = self->lights;
		_tmp30_ = gee_abstract_collection_iterator ((GeeAbstractCollection*) _tmp29_);
		_light_it = _tmp30_;
		while (TRUE) {
			GeeIterator* _tmp31_;
			gboolean _tmp32_ = FALSE;
			GeeIterator* _tmp33_;
			gpointer _tmp34_ = NULL;
			soybodiesLight* light;
			soybodiesLight* _tmp35_;
			GLenum _tmp36_;
			GLenum _tmp37_;
			_tmp31_ = _light_it;
			_tmp32_ = gee_iterator_next (_tmp31_);
			if (!_tmp32_) {
				break;
			}
			_tmp33_ = _light_it;
			_tmp34_ = gee_iterator_get (_tmp33_);
			light = (soybodiesLight*) _tmp34_;
			_tmp35_ = light;
			_tmp36_ = i;
			soy_bodies_light_on (_tmp35_, _tmp36_);
			_tmp37_ = i;
			i = _tmp37_ + 1;
			_g_object_unref0 (light);
		}
		_g_object_unref0 (_light_it);
	}
	g_rw_lock_reader_lock (&soy_scenes__stepLock);
	_tmp38_ = self->bodies;
	_tmp39_ = gee_abstract_map_get_size ((GeeMap*) _tmp38_);
	_tmp40_ = _tmp39_;
	size = _tmp40_;
	_tmp41_ = self->bodies;
	_tmp42_ = gee_abstract_map_get_values ((GeeMap*) _tmp41_);
	_tmp43_ = _tmp42_;
	_tmp44_ = _tmp43_;
	_tmp45_ = _tmp44_ != NULL;
	_g_object_unref0 (_tmp44_);
	if (_tmp45_) {
		GeeHashMap* _tmp46_;
		GeeCollection* _tmp47_;
		GeeCollection* _tmp48_;
		GeeCollection* _tmp49_;
		gint _tmp50_ = 0;
		gpointer* _tmp51_ = NULL;
		soybodiesBody** _tmp52_;
		gint _tmp52__length1;
		soybodiesBody** bodies_arr;
		gint bodies_arr_length1;
		gint _bodies_arr_size_;
		gint _tmp53_;
		gfloat* _tmp54_ = NULL;
		gfloat* distances;
		gint distances_length1;
		gint _distances_size_;
		gint _tmp55_;
		gfloat* _tmp56_ = NULL;
		gfloat* x_positions;
		gint x_positions_length1;
		gint _x_positions_size_;
		gint _tmp57_;
		gfloat* _tmp58_ = NULL;
		gfloat* y_positions;
		gint y_positions_length1;
		gint _y_positions_size_;
		gint _tmp59_;
		gfloat* _tmp60_ = NULL;
		gfloat* z_positions;
		gint z_positions_length1;
		gint _z_positions_size_;
		gint j = 0;
		gint k = 0;
		gint l = 0;
		gfloat max = 0.0F;
		soybodiesBody** _tmp61_;
		gint _tmp61__length1;
		gfloat* _tmp91_;
		gint _tmp91__length1;
		gfloat* _tmp92_;
		gint _tmp92__length1;
		gfloat* _tmp93_;
		gint _tmp93__length1;
		gfloat* _tmp94_;
		gint _tmp94__length1;
		soyatomsPosition* _tmp95_;
		gfloat _tmp96_;
		gfloat _tmp97_;
		soyatomsPosition* _tmp98_;
		gfloat _tmp99_;
		gfloat _tmp100_;
		soyatomsPosition* _tmp101_;
		gfloat _tmp102_;
		gfloat _tmp103_;
		gint _tmp104_;
		gint _tmp105_;
		_tmp46_ = self->bodies;
		_tmp47_ = gee_abstract_map_get_values ((GeeMap*) _tmp46_);
		_tmp48_ = _tmp47_;
		_tmp49_ = _tmp48_;
		_tmp51_ = gee_collection_to_array (_tmp49_, &_tmp50_);
		_tmp52_ = _tmp51_;
		_tmp52__length1 = _tmp50_;
		_g_object_unref0 (_tmp49_);
		bodies_arr = _tmp52_;
		bodies_arr_length1 = _tmp52__length1;
		_bodies_arr_size_ = bodies_arr_length1;
		_tmp53_ = size;
		_tmp54_ = g_new0 (gfloat, _tmp53_);
		distances = _tmp54_;
		distances_length1 = _tmp53_;
		_distances_size_ = distances_length1;
		_tmp55_ = size;
		_tmp56_ = g_new0 (gfloat, _tmp55_);
		x_positions = _tmp56_;
		x_positions_length1 = _tmp55_;
		_x_positions_size_ = x_positions_length1;
		_tmp57_ = size;
		_tmp58_ = g_new0 (gfloat, _tmp57_);
		y_positions = _tmp58_;
		y_positions_length1 = _tmp57_;
		_y_positions_size_ = y_positions_length1;
		_tmp59_ = size;
		_tmp60_ = g_new0 (gfloat, _tmp59_);
		z_positions = _tmp60_;
		z_positions_length1 = _tmp59_;
		_z_positions_size_ = z_positions_length1;
		j = 0;
		l = 0;
		_tmp61_ = bodies_arr;
		_tmp61__length1 = bodies_arr_length1;
		{
			soybodiesBody** body_collection = NULL;
			gint body_collection_length1 = 0;
			gint _body_collection_size_ = 0;
			gint body_it = 0;
			body_collection = _tmp61_;
			body_collection_length1 = _tmp61__length1;
			for (body_it = 0; body_it < _tmp61__length1; body_it = body_it + 1) {
				soybodiesBody* _tmp62_;
				soybodiesBody* body = NULL;
				_tmp62_ = _g_object_ref0 (body_collection[body_it]);
				body = _tmp62_;
				{
					gfloat* _tmp63_;
					gint _tmp63__length1;
					gint _tmp64_;
					soybodiesBody* _tmp65_;
					soyatomsPosition* _tmp66_;
					soyatomsPosition* _tmp67_;
					soyatomsPosition* _tmp68_;
					gfloat _tmp69_;
					gfloat _tmp70_;
					gfloat _tmp71_;
					gfloat* _tmp72_;
					gint _tmp72__length1;
					gint _tmp73_;
					soybodiesBody* _tmp74_;
					soyatomsPosition* _tmp75_;
					soyatomsPosition* _tmp76_;
					soyatomsPosition* _tmp77_;
					gfloat _tmp78_;
					gfloat _tmp79_;
					gfloat _tmp80_;
					gfloat* _tmp81_;
					gint _tmp81__length1;
					gint _tmp82_;
					soybodiesBody* _tmp83_;
					soyatomsPosition* _tmp84_;
					soyatomsPosition* _tmp85_;
					soyatomsPosition* _tmp86_;
					gfloat _tmp87_;
					gfloat _tmp88_;
					gfloat _tmp89_;
					gint _tmp90_;
					_tmp63_ = x_positions;
					_tmp63__length1 = x_positions_length1;
					_tmp64_ = j;
					_tmp65_ = body;
					_tmp66_ = soy_bodies_body_get_position (_tmp65_);
					_tmp67_ = _tmp66_;
					_tmp68_ = _tmp67_;
					_tmp69_ = soy_atoms_position_get_x (_tmp68_);
					_tmp70_ = _tmp69_;
					_tmp63_[_tmp64_] = _tmp70_;
					_tmp71_ = _tmp63_[_tmp64_];
					_g_object_unref0 (_tmp68_);
					_tmp72_ = y_positions;
					_tmp72__length1 = y_positions_length1;
					_tmp73_ = j;
					_tmp74_ = body;
					_tmp75_ = soy_bodies_body_get_position (_tmp74_);
					_tmp76_ = _tmp75_;
					_tmp77_ = _tmp76_;
					_tmp78_ = soy_atoms_position_get_y (_tmp77_);
					_tmp79_ = _tmp78_;
					_tmp72_[_tmp73_] = _tmp79_;
					_tmp80_ = _tmp72_[_tmp73_];
					_g_object_unref0 (_tmp77_);
					_tmp81_ = z_positions;
					_tmp81__length1 = z_positions_length1;
					_tmp82_ = j;
					_tmp83_ = body;
					_tmp84_ = soy_bodies_body_get_position (_tmp83_);
					_tmp85_ = _tmp84_;
					_tmp86_ = _tmp85_;
					_tmp87_ = soy_atoms_position_get_z (_tmp86_);
					_tmp88_ = _tmp87_;
					_tmp81_[_tmp82_] = _tmp88_;
					_tmp89_ = _tmp81_[_tmp82_];
					_g_object_unref0 (_tmp86_);
					_tmp90_ = j;
					j = _tmp90_ + 1;
					_g_object_unref0 (body);
				}
			}
		}
		_tmp91_ = distances;
		_tmp91__length1 = distances_length1;
		_tmp92_ = x_positions;
		_tmp92__length1 = x_positions_length1;
		_tmp93_ = y_positions;
		_tmp93__length1 = y_positions_length1;
		_tmp94_ = z_positions;
		_tmp94__length1 = z_positions_length1;
		_tmp95_ = pos;
		_tmp96_ = soy_atoms_position_get_x (_tmp95_);
		_tmp97_ = _tmp96_;
		_tmp98_ = pos;
		_tmp99_ = soy_atoms_position_get_y (_tmp98_);
		_tmp100_ = _tmp99_;
		_tmp101_ = pos;
		_tmp102_ = soy_atoms_position_get_z (_tmp101_);
		_tmp103_ = _tmp102_;
		_tmp104_ = size;
		soy_scenes_scene_body_distance_squared (_tmp91_, _tmp92_, _tmp93_, _tmp94_, (gfloat) _tmp97_, (gfloat) _tmp100_, (gfloat) _tmp103_, _tmp104_);
		_tmp105_ = size;
		j = _tmp105_ - 1;
		while (TRUE) {
			gint _tmp106_;
			gfloat* _tmp119_;
			gint _tmp119__length1;
			gint _tmp120_;
			gfloat _tmp121_;
			soybodiesBody** _tmp122_;
			gint _tmp122__length1;
			gint _tmp123_;
			soybodiesBody* _tmp124_;
			soybodiesCamera* _tmp125_;
			gint _tmp126_;
			soybodiesBody** _tmp127_;
			gint _tmp127__length1;
			gint _tmp128_;
			soybodiesBody* _tmp129_;
			soybodiesCamera* _tmp130_;
			gint _tmp131_;
			gint _tmp132_;
			_tmp106_ = j;
			if (!(_tmp106_ > 0)) {
				break;
			}
			max = -1.0f;
			{
				gboolean _tmp107_;
				k = 0;
				_tmp107_ = TRUE;
				while (TRUE) {
					gboolean _tmp108_;
					gint _tmp110_;
					gfloat* _tmp111_;
					gint _tmp111__length1;
					gint _tmp112_;
					gfloat _tmp113_;
					gfloat _tmp114_;
					_tmp108_ = _tmp107_;
					if (!_tmp108_) {
						gint _tmp109_;
						_tmp109_ = k;
						k = _tmp109_ + 1;
					}
					_tmp107_ = FALSE;
					_tmp110_ = size;
					if (!(k <= (_tmp110_ - 1))) {
						break;
					}
					_tmp111_ = distances;
					_tmp111__length1 = distances_length1;
					_tmp112_ = k;
					_tmp113_ = _tmp111_[_tmp112_];
					_tmp114_ = max;
					if (_tmp113_ > _tmp114_) {
						gfloat* _tmp115_;
						gint _tmp115__length1;
						gint _tmp116_;
						gfloat _tmp117_;
						gint _tmp118_;
						_tmp115_ = distances;
						_tmp115__length1 = distances_length1;
						_tmp116_ = k;
						_tmp117_ = _tmp115_[_tmp116_];
						max = _tmp117_;
						_tmp118_ = k;
						l = _tmp118_;
					}
				}
			}
			_tmp119_ = distances;
			_tmp119__length1 = distances_length1;
			_tmp120_ = l;
			_tmp119_[_tmp120_] = -1.0f;
			_tmp121_ = _tmp119_[_tmp120_];
			_tmp122_ = bodies_arr;
			_tmp122__length1 = bodies_arr_length1;
			_tmp123_ = l;
			_tmp124_ = _tmp122_[_tmp123_];
			_tmp125_ = camera;
			_tmp126_ = level;
			soy_bodies_body_render (_tmp124_, FALSE, _tmp125_, _tmp126_);
			_tmp127_ = bodies_arr;
			_tmp127__length1 = bodies_arr_length1;
			_tmp128_ = l;
			_tmp129_ = _tmp127_[_tmp128_];
			_tmp130_ = camera;
			_tmp131_ = level;
			soy_bodies_body_render (_tmp129_, TRUE, _tmp130_, _tmp131_);
			_tmp132_ = j;
			j = _tmp132_ - 1;
		}
		z_positions = (g_free (z_positions), NULL);
		y_positions = (g_free (y_positions), NULL);
		x_positions = (g_free (x_positions), NULL);
		distances = (g_free (distances), NULL);
		bodies_arr = (_vala_array_free (bodies_arr, bodies_arr_length1, (GDestroyNotify) g_object_unref), NULL);
	}
	{
		GeeArrayList* _tmp133_;
		GeeArrayList* _tmp134_;
		GeeArrayList* _joint_list;
		GeeArrayList* _tmp135_;
		gint _tmp136_;
		gint _tmp137_;
		gint _joint_size;
		gint _joint_index;
		_tmp133_ = self->joints;
		_tmp134_ = _g_object_ref0 (_tmp133_);
		_joint_list = _tmp134_;
		_tmp135_ = _joint_list;
		_tmp136_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp135_);
		_tmp137_ = _tmp136_;
		_joint_size = _tmp137_;
		_joint_index = -1;
		while (TRUE) {
			gint _tmp138_;
			gint _tmp139_;
			gint _tmp140_;
			GeeArrayList* _tmp141_;
			gint _tmp142_;
			gpointer _tmp143_ = NULL;
			soyjointsJoint* joint;
			soyjointsJoint* _tmp144_;
			_tmp138_ = _joint_index;
			_joint_index = _tmp138_ + 1;
			_tmp139_ = _joint_index;
			_tmp140_ = _joint_size;
			if (!(_tmp139_ < _tmp140_)) {
				break;
			}
			_tmp141_ = _joint_list;
			_tmp142_ = _joint_index;
			_tmp143_ = gee_abstract_list_get ((GeeAbstractList*) _tmp141_, _tmp142_);
			joint = (soyjointsJoint*) _tmp143_;
			_tmp144_ = joint;
			soy_joints_joint_render (_tmp144_);
			_g_object_unref0 (joint);
		}
		_g_object_unref0 (_joint_list);
	}
	g_rw_lock_reader_unlock (&soy_scenes__stepLock);
	i = GL_LIGHT0;
	{
		GeeHashSet* _tmp145_;
		GeeIterator* _tmp146_ = NULL;
		GeeIterator* _light_it;
		_tmp145_ = self->lights;
		_tmp146_ = gee_abstract_collection_iterator ((GeeAbstractCollection*) _tmp145_);
		_light_it = _tmp146_;
		while (TRUE) {
			GeeIterator* _tmp147_;
			gboolean _tmp148_ = FALSE;
			GeeIterator* _tmp149_;
			gpointer _tmp150_ = NULL;
			soybodiesLight* light;
			soybodiesLight* _tmp151_;
			GLenum _tmp152_;
			GLenum _tmp153_;
			_tmp147_ = _light_it;
			_tmp148_ = gee_iterator_next (_tmp147_);
			if (!_tmp148_) {
				break;
			}
			_tmp149_ = _light_it;
			_tmp150_ = gee_iterator_get (_tmp149_);
			light = (soybodiesLight*) _tmp150_;
			_tmp151_ = light;
			_tmp152_ = i;
			soy_bodies_light_off (_tmp151_, _tmp152_);
			_tmp153_ = i;
			i = _tmp153_ + 1;
			_g_object_unref0 (light);
		}
		_g_object_unref0 (_light_it);
	}
	_tmp154_ = self->priv->_fog;
	_tmp154__length1 = self->priv->_fog_length1;
	_tmp155_ = _tmp154_[3];
	if (_tmp155_ != ((GLfloat) 0.0f)) {
		glDisable (GL_FOG);
	}
	glDisable (GL_LIGHTING);
	glDisable (GL_DEPTH_TEST);
	_g_object_unref0 (pos);
}


void soy_scenes_scene_render (soyscenesScene* self, GLfloat fov, GLfloat aspect, GLfloat znear, GLfloat zfar, soybodiesCamera* camera, gint level) {
	g_return_if_fail (self != NULL);
	SOY_SCENES_SCENE_GET_CLASS (self)->render (self, fov, aspect, znear, zfar, camera, level);
}


static void soy_scenes_scene_real_render_extra (soyscenesScene* self) {
	return;
}


void soy_scenes_scene_render_extra (soyscenesScene* self) {
	g_return_if_fail (self != NULL);
	SOY_SCENES_SCENE_GET_CLASS (self)->render_extra (self);
}


void soy_scenes_scene_perspective (GLfloat fovy, GLfloat aspect, GLfloat zNear, GLfloat zFar) {
	GLfloat* m = NULL;
	gint m_length1 = 0;
	gint _m_size_ = 0;
	GLfloat _tmp0_;
	GLfloat _tmp1_;
	gfloat deltaZ;
	GLfloat _tmp2_;
	gfloat radians;
	gfloat _tmp3_;
	gfloat _tmp4_ = 0.0F;
	gfloat sine;
	gboolean _tmp5_ = FALSE;
	gboolean _tmp6_ = FALSE;
	gfloat _tmp7_;
	gboolean _tmp9_;
	gboolean _tmp11_;
	gfloat _tmp12_;
	gfloat _tmp13_ = 0.0F;
	gfloat _tmp14_;
	gfloat cotangent;
	GLfloat* _tmp15_ = NULL;
	GLfloat* _tmp16_;
	gint _tmp16__length1;
	gfloat _tmp17_;
	GLfloat _tmp18_;
	GLfloat _tmp19_;
	GLfloat* _tmp20_;
	gint _tmp20__length1;
	gfloat _tmp21_;
	GLfloat _tmp22_;
	GLfloat* _tmp23_;
	gint _tmp23__length1;
	GLfloat _tmp24_;
	GLfloat _tmp25_;
	gfloat _tmp26_;
	GLfloat _tmp27_;
	GLfloat* _tmp28_;
	gint _tmp28__length1;
	GLfloat _tmp29_;
	GLfloat _tmp30_;
	gfloat _tmp31_;
	GLfloat _tmp32_;
	GLfloat* _tmp33_;
	gint _tmp33__length1;
	_tmp0_ = zFar;
	_tmp1_ = zNear;
	deltaZ = (gfloat) (_tmp0_ - _tmp1_);
	_tmp2_ = fovy;
	radians = (gfloat) (((_tmp2_ / 2.0f) * 3.141592653589793f) / 180.0f);
	_tmp3_ = radians;
	_tmp4_ = sinf (_tmp3_);
	sine = _tmp4_;
	_tmp7_ = deltaZ;
	if (_tmp7_ == 0.0f) {
		_tmp6_ = TRUE;
	} else {
		gfloat _tmp8_;
		_tmp8_ = sine;
		_tmp6_ = _tmp8_ == 0.0f;
	}
	_tmp9_ = _tmp6_;
	if (_tmp9_) {
		_tmp5_ = TRUE;
	} else {
		GLfloat _tmp10_;
		_tmp10_ = aspect;
		_tmp5_ = _tmp10_ == ((GLfloat) 0.0f);
	}
	_tmp11_ = _tmp5_;
	if (_tmp11_) {
		m = (g_free (m), NULL);
		return;
	}
	_tmp12_ = radians;
	_tmp13_ = cosf (_tmp12_);
	_tmp14_ = sine;
	cotangent = _tmp13_ / _tmp14_;
	_tmp15_ = g_new0 (GLfloat, 16);
	_tmp15_[0] = (GLfloat) 1.0f;
	_tmp15_[1] = (GLfloat) 0.0f;
	_tmp15_[2] = (GLfloat) 0.0f;
	_tmp15_[3] = (GLfloat) 0.0f;
	_tmp15_[4] = (GLfloat) 0.0f;
	_tmp15_[5] = (GLfloat) 1.0f;
	_tmp15_[6] = (GLfloat) 0.0f;
	_tmp15_[7] = (GLfloat) 0.0f;
	_tmp15_[8] = (GLfloat) 0.0f;
	_tmp15_[9] = (GLfloat) 0.0f;
	_tmp15_[10] = (GLfloat) 1.0f;
	_tmp15_[11] = (GLfloat) (-1.0f);
	_tmp15_[12] = (GLfloat) 0.0f;
	_tmp15_[13] = (GLfloat) 0.0f;
	_tmp15_[14] = (GLfloat) 0.0f;
	_tmp15_[15] = (GLfloat) 0.0f;
	m = (g_free (m), NULL);
	m = _tmp15_;
	m_length1 = 16;
	_m_size_ = m_length1;
	_tmp16_ = m;
	_tmp16__length1 = m_length1;
	_tmp17_ = cotangent;
	_tmp18_ = aspect;
	_tmp16_[0] = (GLfloat) (_tmp17_ / _tmp18_);
	_tmp19_ = _tmp16_[0];
	_tmp20_ = m;
	_tmp20__length1 = m_length1;
	_tmp21_ = cotangent;
	_tmp20_[5] = (GLfloat) _tmp21_;
	_tmp22_ = _tmp20_[5];
	_tmp23_ = m;
	_tmp23__length1 = m_length1;
	_tmp24_ = zFar;
	_tmp25_ = zNear;
	_tmp26_ = deltaZ;
	_tmp23_[10] = (-(_tmp24_ + _tmp25_)) / _tmp26_;
	_tmp27_ = _tmp23_[10];
	_tmp28_ = m;
	_tmp28__length1 = m_length1;
	_tmp29_ = zNear;
	_tmp30_ = zFar;
	_tmp31_ = deltaZ;
	_tmp28_[14] = (GLfloat) ((((-2.0f) * _tmp29_) * _tmp30_) / _tmp31_);
	_tmp32_ = _tmp28_[14];
	_tmp33_ = m;
	_tmp33__length1 = m_length1;
	glMultMatrixf (_tmp33_);
	m = (g_free (m), NULL);
}


static void __soy_scenes_scene_check_collisions_NearCallback_dnear_callback (gpointer self, struct dxGeom* o1, struct dxGeom* o2) {
	_soy_scenes_scene_check_collisions_NearCallback (self, o1, o2);
}


static void _soy_scenes_scene_check_collisions_NearCallback (soyscenesScene* self, struct dxGeom* o1, struct dxGeom* o2) {
	gboolean* _result_ = NULL;
	gint flags;
	struct dxGeom* _tmp0_;
	gulong _tmp1_ = 0UL;
	gulong cat1;
	struct dxGeom* _tmp2_;
	gulong _tmp3_ = 0UL;
	gulong cat2;
	gboolean _tmp4_ = FALSE;
	gulong _tmp5_;
	gulong _tmp6_;
	gboolean _tmp9_;
	gboolean* _tmp20_;
	struct dxGeom* _tmp21_;
	gint _tmp22_ = 0;
	struct dxGeom* _tmp23_;
	gint _tmp24_ = 0;
	dContactGeom* _tmp27_;
	dContactGeom* contactGeoms;
	struct dxGeom* _tmp28_;
	struct dxGeom* _tmp29_;
	gint _tmp30_;
	dContactGeom* _tmp31_;
	gint _tmp32_ = 0;
	gint num;
	gint _tmp33_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (o1 != NULL);
	g_return_if_fail (o2 != NULL);
	flags = 1;
	_tmp0_ = o1;
	_tmp1_ = dGeomGetCategoryBits (_tmp0_);
	cat1 = _tmp1_;
	_tmp2_ = o2;
	_tmp3_ = dGeomGetCategoryBits (_tmp2_);
	cat2 = _tmp3_;
	_tmp5_ = cat1;
	_tmp6_ = GeomIgnored;
	if ((_tmp5_ & _tmp6_) != ((gulong) 0)) {
		_tmp4_ = TRUE;
	} else {
		gulong _tmp7_;
		gulong _tmp8_;
		_tmp7_ = cat2;
		_tmp8_ = GeomIgnored;
		_tmp4_ = (_tmp7_ & _tmp8_) != ((gulong) 0);
	}
	_tmp9_ = _tmp4_;
	if (_tmp9_) {
		return;
	} else {
		struct dxGeom* _tmp10_;
		gulong _tmp11_ = 0UL;
		gulong _tmp12_;
		_tmp10_ = o1;
		_tmp11_ = dGeomGetCategoryBits (_tmp10_);
		_tmp12_ = GeomTestRay;
		if (_tmp11_ == _tmp12_) {
			struct dxGeom* _tmp13_;
			void* _tmp14_ = NULL;
			_tmp13_ = o1;
			_tmp14_ = dGeomGetData (_tmp13_);
			_result_ = (gboolean*) _tmp14_;
		} else {
			struct dxGeom* _tmp15_;
			gulong _tmp16_ = 0UL;
			gulong _tmp17_;
			_tmp15_ = o2;
			_tmp16_ = dGeomGetCategoryBits (_tmp15_);
			_tmp17_ = GeomTestRay;
			if (_tmp16_ == _tmp17_) {
				struct dxGeom* _tmp18_;
				void* _tmp19_ = NULL;
				_tmp18_ = o2;
				_tmp19_ = dGeomGetData (_tmp18_);
				_result_ = (gboolean*) _tmp19_;
			} else {
				return;
			}
		}
	}
	_tmp20_ = _result_;
	if (*_tmp20_) {
		return;
	}
	_tmp21_ = o2;
	_tmp22_ = dGeomIsSpace (_tmp21_);
	_tmp23_ = o1;
	_tmp24_ = dGeomIsSpace (_tmp23_);
	if ((_tmp22_ | _tmp24_) != 0) {
		struct dxGeom* _tmp25_;
		struct dxGeom* _tmp26_;
		_tmp25_ = o1;
		_tmp26_ = o2;
		dSpaceCollide2 (_tmp25_, self, _tmp26_, __soy_scenes_scene_check_collisions_NearCallback_dnear_callback);
	}
	_tmp27_ = dcontact_geom_array_new (1);
	contactGeoms = _tmp27_;
	_tmp28_ = o1;
	_tmp29_ = o2;
	_tmp30_ = flags;
	_tmp31_ = contactGeoms;
	_tmp32_ = dCollide (_tmp28_, _tmp29_, _tmp30_, _tmp31_, (gint) sizeof (dContactGeom));
	num = _tmp32_;
	_tmp33_ = num;
	if (_tmp33_ != 0) {
		gboolean* _tmp34_;
		gboolean _tmp35_;
		_tmp34_ = _result_;
		*_tmp34_ = TRUE;
		_tmp35_ = *_tmp34_;
	}
	return;
}


gboolean soy_scenes_scene_check_path_collision (soyscenesScene* self, soyatomsPosition* start, soyatomsPosition* end) {
	gboolean result = FALSE;
	soyatomsPosition* _tmp0_;
	soyatomsPosition* _tmp1_;
	soyatomsPosition** _tmp2_ = NULL;
	soyatomsPosition** ends;
	gint ends_length1;
	gint _ends_size_;
	soyatomsPosition* _tmp3_;
	gint _tmp4_ = 0;
	gboolean* _tmp5_ = NULL;
	gboolean* _tmp6_;
	gint _tmp6__length1;
	gboolean _tmp7_;
	gboolean _tmp8_;
	g_return_val_if_fail (self != NULL, FALSE);
	g_return_val_if_fail (start != NULL, FALSE);
	g_return_val_if_fail (end != NULL, FALSE);
	_tmp0_ = end;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_tmp2_ = g_new0 (soyatomsPosition*, 1 + 1);
	_tmp2_[0] = _tmp1_;
	ends = _tmp2_;
	ends_length1 = 1;
	_ends_size_ = ends_length1;
	_tmp3_ = start;
	_tmp5_ = soy_scenes_scene_check_collisions (self, _tmp3_, ends, ends_length1, &_tmp4_);
	_tmp6_ = _tmp5_;
	_tmp6__length1 = _tmp4_;
	_tmp7_ = _tmp6_[0];
	_tmp8_ = _tmp7_;
	_tmp6_ = (g_free (_tmp6_), NULL);
	result = _tmp8_;
	ends = (_vala_array_free (ends, ends_length1, (GDestroyNotify) g_object_unref), NULL);
	return result;
}


gboolean* soy_scenes_scene_check_collisions (soyscenesScene* self, soyatomsPosition* start, soyatomsPosition** ends, int ends_length1, int* result_length1) {
	gboolean* result = NULL;
	soyatomsPosition** _tmp0_;
	gint _tmp0__length1;
	gboolean* _tmp1_ = NULL;
	gboolean* ret;
	gint ret_length1;
	gint _ret_size_;
	soyatomsPosition** _tmp2_;
	gint _tmp2__length1;
	struct dxGeom** _tmp3_ = NULL;
	struct dxGeom** geoms;
	gint geoms_length1;
	gint _geoms_size_;
	gulong _tmp4_;
	gulong category_bits;
	gulong _tmp5_;
	gulong _tmp6_;
	gulong collide_bits;
	struct dxSpace* _tmp70_;
	struct dxGeom** _tmp71_;
	gint _tmp71__length1;
	gboolean* _tmp73_;
	gint _tmp73__length1;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (start != NULL, NULL);
	_tmp0_ = ends;
	_tmp0__length1 = ends_length1;
	_tmp1_ = g_new0 (gboolean, _tmp0__length1);
	ret = _tmp1_;
	ret_length1 = _tmp0__length1;
	_ret_size_ = ret_length1;
	_tmp2_ = ends;
	_tmp2__length1 = ends_length1;
	_tmp3_ = g_new0 (struct dxGeom*, _tmp2__length1);
	geoms = _tmp3_;
	geoms_length1 = _tmp2__length1;
	_geoms_size_ = geoms_length1;
	_tmp4_ = GeomTestRay;
	category_bits = _tmp4_;
	_tmp5_ = category_bits;
	_tmp6_ = GeomIgnored;
	collide_bits = ~(_tmp5_ | _tmp6_);
	g_rw_lock_writer_lock (&soy_scenes__stepLock);
	{
		gint i;
		i = 0;
		{
			gboolean _tmp7_;
			_tmp7_ = TRUE;
			while (TRUE) {
				gboolean _tmp8_;
				soyatomsPosition** _tmp10_;
				gint _tmp10__length1;
				gboolean* _tmp11_;
				gint _tmp11__length1;
				gint _tmp12_;
				gboolean _tmp13_;
				soyatomsPosition** _tmp14_;
				gint _tmp14__length1;
				gint _tmp15_;
				soyatomsPosition* _tmp16_;
				gfloat _tmp17_;
				gfloat _tmp18_;
				soyatomsPosition* _tmp19_;
				gfloat _tmp20_;
				gfloat _tmp21_;
				gfloat dx;
				soyatomsPosition** _tmp22_;
				gint _tmp22__length1;
				gint _tmp23_;
				soyatomsPosition* _tmp24_;
				gfloat _tmp25_;
				gfloat _tmp26_;
				soyatomsPosition* _tmp27_;
				gfloat _tmp28_;
				gfloat _tmp29_;
				gfloat dy;
				soyatomsPosition** _tmp30_;
				gint _tmp30__length1;
				gint _tmp31_;
				soyatomsPosition* _tmp32_;
				gfloat _tmp33_;
				gfloat _tmp34_;
				soyatomsPosition* _tmp35_;
				gfloat _tmp36_;
				gfloat _tmp37_;
				gfloat dz;
				gfloat _tmp38_;
				gfloat _tmp39_;
				gfloat _tmp40_ = 0.0F;
				gfloat _tmp41_;
				gfloat _tmp42_ = 0.0F;
				dReal dist;
				struct dxSpace* _tmp43_;
				dReal _tmp44_;
				struct dxGeom* _tmp45_;
				struct dxGeom* ray;
				struct dxGeom* _tmp46_;
				soyatomsPosition* _tmp47_;
				gfloat _tmp48_;
				gfloat _tmp49_;
				soyatomsPosition* _tmp50_;
				gfloat _tmp51_;
				gfloat _tmp52_;
				soyatomsPosition* _tmp53_;
				gfloat _tmp54_;
				gfloat _tmp55_;
				gfloat _tmp56_;
				gfloat _tmp57_;
				gfloat _tmp58_;
				struct dxGeom* _tmp59_;
				gulong _tmp60_;
				struct dxGeom* _tmp61_;
				gulong _tmp62_;
				struct dxGeom* _tmp63_;
				gboolean* _tmp64_;
				gint _tmp64__length1;
				gint _tmp65_;
				struct dxGeom** _tmp66_;
				gint _tmp66__length1;
				gint _tmp67_;
				struct dxGeom* _tmp68_;
				struct dxGeom* _tmp69_;
				_tmp8_ = _tmp7_;
				if (!_tmp8_) {
					gint _tmp9_;
					_tmp9_ = i;
					i = _tmp9_ + 1;
				}
				_tmp7_ = FALSE;
				_tmp10_ = ends;
				_tmp10__length1 = ends_length1;
				if (!(i <= (_tmp10__length1 - 1))) {
					break;
				}
				_tmp11_ = ret;
				_tmp11__length1 = ret_length1;
				_tmp12_ = i;
				_tmp11_[_tmp12_] = FALSE;
				_tmp13_ = _tmp11_[_tmp12_];
				_tmp14_ = ends;
				_tmp14__length1 = ends_length1;
				_tmp15_ = i;
				_tmp16_ = _tmp14_[_tmp15_];
				_tmp17_ = soy_atoms_position_get_x (_tmp16_);
				_tmp18_ = _tmp17_;
				_tmp19_ = start;
				_tmp20_ = soy_atoms_position_get_x (_tmp19_);
				_tmp21_ = _tmp20_;
				dx = _tmp18_ - _tmp21_;
				_tmp22_ = ends;
				_tmp22__length1 = ends_length1;
				_tmp23_ = i;
				_tmp24_ = _tmp22_[_tmp23_];
				_tmp25_ = soy_atoms_position_get_y (_tmp24_);
				_tmp26_ = _tmp25_;
				_tmp27_ = start;
				_tmp28_ = soy_atoms_position_get_y (_tmp27_);
				_tmp29_ = _tmp28_;
				dy = _tmp26_ - _tmp29_;
				_tmp30_ = ends;
				_tmp30__length1 = ends_length1;
				_tmp31_ = i;
				_tmp32_ = _tmp30_[_tmp31_];
				_tmp33_ = soy_atoms_position_get_z (_tmp32_);
				_tmp34_ = _tmp33_;
				_tmp35_ = start;
				_tmp36_ = soy_atoms_position_get_z (_tmp35_);
				_tmp37_ = _tmp36_;
				dz = _tmp34_ - _tmp37_;
				_tmp38_ = dx;
				_tmp39_ = dy;
				_tmp40_ = hypotf (_tmp38_, _tmp39_);
				_tmp41_ = dz;
				_tmp42_ = hypotf (_tmp40_, _tmp41_);
				dist = (dReal) _tmp42_;
				_tmp43_ = self->space;
				_tmp44_ = dist;
				_tmp45_ = dCreateRay (_tmp43_, _tmp44_);
				ray = _tmp45_;
				_tmp46_ = ray;
				_tmp47_ = start;
				_tmp48_ = soy_atoms_position_get_x (_tmp47_);
				_tmp49_ = _tmp48_;
				_tmp50_ = start;
				_tmp51_ = soy_atoms_position_get_y (_tmp50_);
				_tmp52_ = _tmp51_;
				_tmp53_ = start;
				_tmp54_ = soy_atoms_position_get_z (_tmp53_);
				_tmp55_ = _tmp54_;
				_tmp56_ = dx;
				_tmp57_ = dy;
				_tmp58_ = dz;
				dGeomRaySet (_tmp46_, (dReal) _tmp49_, (dReal) _tmp52_, (dReal) _tmp55_, (dReal) _tmp56_, (dReal) _tmp57_, (dReal) _tmp58_);
				_tmp59_ = ray;
				_tmp60_ = collide_bits;
				dGeomSetCollideBits (_tmp59_, _tmp60_);
				_tmp61_ = ray;
				_tmp62_ = category_bits;
				dGeomSetCategoryBits (_tmp61_, _tmp62_);
				_tmp63_ = ray;
				_tmp64_ = ret;
				_tmp64__length1 = ret_length1;
				_tmp65_ = i;
				dGeomSetData (_tmp63_, (void*) (&_tmp64_[_tmp65_]));
				_tmp66_ = geoms;
				_tmp66__length1 = geoms_length1;
				_tmp67_ = i;
				_tmp68_ = ray;
				_tmp66_[_tmp67_] = _tmp68_;
				_tmp69_ = _tmp66_[_tmp67_];
			}
		}
	}
	_tmp70_ = self->space;
	dSpaceCollide (_tmp70_, self, __soy_scenes_scene_check_collisions_NearCallback_dnear_callback);
	_tmp71_ = geoms;
	_tmp71__length1 = geoms_length1;
	{
		struct dxGeom** i_collection = NULL;
		gint i_collection_length1 = 0;
		gint _i_collection_size_ = 0;
		gint i_it = 0;
		i_collection = _tmp71_;
		i_collection_length1 = _tmp71__length1;
		for (i_it = 0; i_it < _tmp71__length1; i_it = i_it + 1) {
			struct dxGeom* i = NULL;
			i = i_collection[i_it];
			{
				struct dxGeom* _tmp72_;
				_tmp72_ = i;
				dGeomDestroy (_tmp72_);
			}
		}
	}
	g_rw_lock_writer_unlock (&soy_scenes__stepLock);
	_tmp73_ = ret;
	_tmp73__length1 = ret_length1;
	if (result_length1) {
		*result_length1 = _tmp73__length1;
	}
	result = _tmp73_;
	geoms = (g_free (geoms), NULL);
	return result;
}


gboolean* soy_scenes_scene_check_collisions_with_radius (soyscenesScene* self, soyatomsPosition* start, soyatomsPosition** ends, int ends_length1, gfloat radius, int* result_length1) {
	gboolean* result = NULL;
	soyatomsPosition** _tmp0_;
	gint _tmp0__length1;
	gboolean* _tmp1_ = NULL;
	gboolean* ret;
	gint ret_length1;
	gint _ret_size_;
	soyatomsPosition** _tmp2_;
	gint _tmp2__length1;
	struct dxGeom** _tmp3_ = NULL;
	struct dxGeom** geoms;
	gint geoms_length1;
	gint _geoms_size_;
	gulong _tmp4_;
	gulong category_bits;
	gulong _tmp5_;
	gulong _tmp6_;
	gulong collide_bits;
	struct dxSpace* _tmp111_;
	struct dxGeom** _tmp112_;
	gint _tmp112__length1;
	gboolean* _tmp114_;
	gint _tmp114__length1;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (start != NULL, NULL);
	_tmp0_ = ends;
	_tmp0__length1 = ends_length1;
	_tmp1_ = g_new0 (gboolean, _tmp0__length1);
	ret = _tmp1_;
	ret_length1 = _tmp0__length1;
	_ret_size_ = ret_length1;
	_tmp2_ = ends;
	_tmp2__length1 = ends_length1;
	_tmp3_ = g_new0 (struct dxGeom*, _tmp2__length1);
	geoms = _tmp3_;
	geoms_length1 = _tmp2__length1;
	_geoms_size_ = geoms_length1;
	_tmp4_ = GeomTestRay;
	category_bits = _tmp4_;
	_tmp5_ = category_bits;
	_tmp6_ = GeomIgnored;
	collide_bits = ~(_tmp5_ | _tmp6_);
	g_rw_lock_writer_lock (&soy_scenes__stepLock);
	{
		gint i;
		i = 0;
		{
			gboolean _tmp7_;
			_tmp7_ = TRUE;
			while (TRUE) {
				gboolean _tmp8_;
				soyatomsPosition** _tmp10_;
				gint _tmp10__length1;
				gboolean* _tmp11_;
				gint _tmp11__length1;
				gint _tmp12_;
				gboolean _tmp13_;
				soyatomsPosition** _tmp14_;
				gint _tmp14__length1;
				gint _tmp15_;
				soyatomsPosition* _tmp16_;
				soyatomsPosition* _tmp17_;
				soyatomsPosition* end;
				soyatomsPosition* _tmp18_;
				gfloat _tmp19_;
				gfloat _tmp20_;
				soyatomsPosition* _tmp21_;
				gfloat _tmp22_;
				gfloat _tmp23_;
				soyatomsPosition* _tmp24_;
				gfloat _tmp25_;
				gfloat _tmp26_;
				soyatomsPosition* _tmp27_;
				gfloat _tmp28_;
				gfloat _tmp29_;
				gfloat _tmp30_ = 0.0F;
				soyatomsPosition* _tmp31_;
				gfloat _tmp32_;
				gfloat _tmp33_;
				soyatomsPosition* _tmp34_;
				gfloat _tmp35_;
				gfloat _tmp36_;
				gfloat _tmp37_ = 0.0F;
				gfloat dist;
				soyatomsPosition* _tmp38_;
				gfloat _tmp39_;
				gfloat _tmp40_;
				soyatomsPosition* _tmp41_;
				gfloat _tmp42_;
				gfloat _tmp43_;
				gfloat _tmp44_;
				gfloat _tmp45_ = 0.0F;
				gfloat angle;
				gfloat _tmp46_;
				soyatomsPosition* _tmp47_;
				gfloat _tmp48_;
				gfloat _tmp49_;
				soyatomsPosition* _tmp50_;
				gfloat _tmp51_;
				gfloat _tmp52_;
				gfloat axis_x;
				gfloat _tmp53_;
				soyatomsPosition* _tmp54_;
				gfloat _tmp55_;
				gfloat _tmp56_;
				soyatomsPosition* _tmp57_;
				gfloat _tmp58_;
				gfloat _tmp59_;
				gfloat axis_y;
				gfloat axis_z;
				struct dxSpace* _tmp60_;
				gfloat _tmp61_;
				gfloat _tmp62_;
				struct dxGeom* _tmp63_;
				struct dxGeom* cap;
				struct dxGeom* _tmp64_;
				soyatomsPosition* _tmp65_;
				gfloat _tmp66_;
				gfloat _tmp67_;
				soyatomsPosition* _tmp68_;
				gfloat _tmp69_;
				gfloat _tmp70_;
				soyatomsPosition* _tmp71_;
				gfloat _tmp72_;
				gfloat _tmp73_;
				soyatomsPosition* _tmp74_;
				gfloat _tmp75_;
				gfloat _tmp76_;
				soyatomsPosition* _tmp77_;
				gfloat _tmp78_;
				gfloat _tmp79_;
				soyatomsPosition* _tmp80_;
				gfloat _tmp81_;
				gfloat _tmp82_;
				soyatomsPosition* _tmp83_;
				gfloat _tmp84_;
				gfloat _tmp85_;
				soyatomsPosition* _tmp86_;
				gfloat _tmp87_;
				gfloat _tmp88_;
				soyatomsPosition* _tmp89_;
				gfloat _tmp90_;
				gfloat _tmp91_;
				dxMatrix3* _tmp92_;
				dxMatrix3* rot;
				dxMatrix3* _tmp93_;
				gfloat _tmp94_;
				gfloat _tmp95_;
				gfloat _tmp96_;
				gfloat _tmp97_;
				struct dxGeom* _tmp98_;
				dxMatrix3* _tmp99_;
				struct dxGeom* _tmp100_;
				gulong _tmp101_;
				struct dxGeom* _tmp102_;
				gulong _tmp103_;
				struct dxGeom* _tmp104_;
				gboolean* _tmp105_;
				gint _tmp105__length1;
				gint _tmp106_;
				struct dxGeom** _tmp107_;
				gint _tmp107__length1;
				gint _tmp108_;
				struct dxGeom* _tmp109_;
				struct dxGeom* _tmp110_;
				_tmp8_ = _tmp7_;
				if (!_tmp8_) {
					gint _tmp9_;
					_tmp9_ = i;
					i = _tmp9_ + 1;
				}
				_tmp7_ = FALSE;
				_tmp10_ = ends;
				_tmp10__length1 = ends_length1;
				if (!(i <= (_tmp10__length1 - 1))) {
					break;
				}
				_tmp11_ = ret;
				_tmp11__length1 = ret_length1;
				_tmp12_ = i;
				_tmp11_[_tmp12_] = FALSE;
				_tmp13_ = _tmp11_[_tmp12_];
				_tmp14_ = ends;
				_tmp14__length1 = ends_length1;
				_tmp15_ = i;
				_tmp16_ = _tmp14_[_tmp15_];
				_tmp17_ = _g_object_ref0 (_tmp16_);
				end = _tmp17_;
				_tmp18_ = end;
				_tmp19_ = soy_atoms_position_get_x (_tmp18_);
				_tmp20_ = _tmp19_;
				_tmp21_ = start;
				_tmp22_ = soy_atoms_position_get_x (_tmp21_);
				_tmp23_ = _tmp22_;
				_tmp24_ = end;
				_tmp25_ = soy_atoms_position_get_y (_tmp24_);
				_tmp26_ = _tmp25_;
				_tmp27_ = start;
				_tmp28_ = soy_atoms_position_get_y (_tmp27_);
				_tmp29_ = _tmp28_;
				_tmp30_ = hypotf (_tmp20_ - _tmp23_, _tmp26_ - _tmp29_);
				_tmp31_ = end;
				_tmp32_ = soy_atoms_position_get_z (_tmp31_);
				_tmp33_ = _tmp32_;
				_tmp34_ = start;
				_tmp35_ = soy_atoms_position_get_z (_tmp34_);
				_tmp36_ = _tmp35_;
				_tmp37_ = hypotf (_tmp30_, _tmp33_ - _tmp36_);
				dist = _tmp37_;
				_tmp38_ = end;
				_tmp39_ = soy_atoms_position_get_z (_tmp38_);
				_tmp40_ = _tmp39_;
				_tmp41_ = start;
				_tmp42_ = soy_atoms_position_get_z (_tmp41_);
				_tmp43_ = _tmp42_;
				_tmp44_ = dist;
				_tmp45_ = acosf ((_tmp40_ - _tmp43_) / _tmp44_);
				angle = _tmp45_;
				_tmp46_ = dist;
				_tmp47_ = end;
				_tmp48_ = soy_atoms_position_get_y (_tmp47_);
				_tmp49_ = _tmp48_;
				_tmp50_ = start;
				_tmp51_ = soy_atoms_position_get_y (_tmp50_);
				_tmp52_ = _tmp51_;
				axis_x = -(_tmp46_ * (_tmp49_ - _tmp52_));
				_tmp53_ = dist;
				_tmp54_ = end;
				_tmp55_ = soy_atoms_position_get_x (_tmp54_);
				_tmp56_ = _tmp55_;
				_tmp57_ = start;
				_tmp58_ = soy_atoms_position_get_x (_tmp57_);
				_tmp59_ = _tmp58_;
				axis_y = _tmp53_ * (_tmp56_ - _tmp59_);
				axis_z = (gfloat) 0;
				_tmp60_ = self->space;
				_tmp61_ = radius;
				_tmp62_ = dist;
				_tmp63_ = dCreateCapsule (_tmp60_, (dReal) _tmp61_, (dReal) _tmp62_);
				cap = _tmp63_;
				_tmp64_ = cap;
				_tmp65_ = start;
				_tmp66_ = soy_atoms_position_get_x (_tmp65_);
				_tmp67_ = _tmp66_;
				_tmp68_ = end;
				_tmp69_ = soy_atoms_position_get_x (_tmp68_);
				_tmp70_ = _tmp69_;
				_tmp71_ = start;
				_tmp72_ = soy_atoms_position_get_x (_tmp71_);
				_tmp73_ = _tmp72_;
				_tmp74_ = start;
				_tmp75_ = soy_atoms_position_get_y (_tmp74_);
				_tmp76_ = _tmp75_;
				_tmp77_ = end;
				_tmp78_ = soy_atoms_position_get_y (_tmp77_);
				_tmp79_ = _tmp78_;
				_tmp80_ = start;
				_tmp81_ = soy_atoms_position_get_y (_tmp80_);
				_tmp82_ = _tmp81_;
				_tmp83_ = start;
				_tmp84_ = soy_atoms_position_get_z (_tmp83_);
				_tmp85_ = _tmp84_;
				_tmp86_ = end;
				_tmp87_ = soy_atoms_position_get_z (_tmp86_);
				_tmp88_ = _tmp87_;
				_tmp89_ = start;
				_tmp90_ = soy_atoms_position_get_z (_tmp89_);
				_tmp91_ = _tmp90_;
				dGeomSetPosition (_tmp64_, (dReal) (_tmp67_ + ((_tmp70_ - _tmp73_) / 2.0f)), (dReal) (_tmp76_ + ((_tmp79_ - _tmp82_) / 2.0f)), (dReal) (_tmp85_ + ((_tmp88_ - _tmp91_) / 2.0f)));
				_tmp92_ = dmatrix3_new ();
				rot = _tmp92_;
				_tmp93_ = rot;
				_tmp94_ = axis_x;
				_tmp95_ = axis_y;
				_tmp96_ = axis_z;
				_tmp97_ = angle;
				dRFromAxisAndAngle (_tmp93_, (dReal) _tmp94_, (dReal) _tmp95_, (dReal) _tmp96_, (dReal) _tmp97_);
				_tmp98_ = cap;
				_tmp99_ = rot;
				dGeomSetRotation (_tmp98_, _tmp99_);
				_tmp100_ = cap;
				_tmp101_ = collide_bits;
				dGeomSetCollideBits (_tmp100_, _tmp101_);
				_tmp102_ = cap;
				_tmp103_ = category_bits;
				dGeomSetCategoryBits (_tmp102_, _tmp103_);
				_tmp104_ = cap;
				_tmp105_ = ret;
				_tmp105__length1 = ret_length1;
				_tmp106_ = i;
				dGeomSetData (_tmp104_, (void*) (&_tmp105_[_tmp106_]));
				_tmp107_ = geoms;
				_tmp107__length1 = geoms_length1;
				_tmp108_ = i;
				_tmp109_ = cap;
				_tmp107_[_tmp108_] = _tmp109_;
				_tmp110_ = _tmp107_[_tmp108_];
				_dmatrix3_free0 (rot);
				_g_object_unref0 (end);
			}
		}
	}
	_tmp111_ = self->space;
	dSpaceCollide (_tmp111_, self, __soy_scenes_scene_check_collisions_NearCallback_dnear_callback);
	_tmp112_ = geoms;
	_tmp112__length1 = geoms_length1;
	{
		struct dxGeom** i_collection = NULL;
		gint i_collection_length1 = 0;
		gint _i_collection_size_ = 0;
		gint i_it = 0;
		i_collection = _tmp112_;
		i_collection_length1 = _tmp112__length1;
		for (i_it = 0; i_it < _tmp112__length1; i_it = i_it + 1) {
			struct dxGeom* i = NULL;
			i = i_collection[i_it];
			{
				struct dxGeom* _tmp113_;
				_tmp113_ = i;
				dGeomDestroy (_tmp113_);
			}
		}
	}
	g_rw_lock_writer_unlock (&soy_scenes__stepLock);
	_tmp114_ = ret;
	_tmp114__length1 = ret_length1;
	if (result_length1) {
		*result_length1 = _tmp114__length1;
	}
	result = _tmp114_;
	geoms = (g_free (geoms), NULL);
	return result;
}


gboolean* soy_scenes_scene_check_collisions_with_size (soyscenesScene* self, soyatomsPosition* start, soyatomsPosition** ends, int ends_length1, soyatomsSize* aabb, int* result_length1) {
	gboolean* result = NULL;
	soyatomsPosition** _tmp0_;
	gint _tmp0__length1;
	gboolean* _tmp1_ = NULL;
	gboolean* ret;
	gint ret_length1;
	gint _ret_size_;
	gboolean start_bool;
	soyatomsPosition** _tmp2_;
	gint _tmp2__length1;
	struct dxGeom** _tmp3_ = NULL;
	struct dxGeom** geoms;
	gint geoms_length1;
	gint _geoms_size_;
	gulong _tmp4_;
	gulong category_bits;
	gulong _tmp5_;
	gulong _tmp6_;
	gulong collide_bits;
	soyatomsSize* _tmp7_;
	gfloat _tmp8_;
	gfloat _tmp9_;
	gfloat x;
	soyatomsSize* _tmp10_;
	gfloat _tmp11_;
	gfloat _tmp12_;
	gfloat y;
	soyatomsSize* _tmp13_;
	gfloat _tmp14_;
	gfloat _tmp15_;
	gfloat z;
	gfloat _tmp16_;
	gfloat _tmp17_;
	gfloat _tmp18_ = 0.0F;
	gfloat size_y;
	gfloat _tmp19_;
	gfloat _tmp20_;
	gfloat _tmp21_ = 0.0F;
	gfloat size_z;
	struct dxSpace* _tmp22_;
	gfloat _tmp23_;
	gfloat _tmp24_;
	gfloat _tmp25_;
	struct dxGeom* _tmp26_;
	struct dxGeom* box_start;
	struct dxGeom* _tmp27_;
	soyatomsPosition* _tmp28_;
	gfloat _tmp29_;
	gfloat _tmp30_;
	soyatomsPosition* _tmp31_;
	gfloat _tmp32_;
	gfloat _tmp33_;
	soyatomsPosition* _tmp34_;
	gfloat _tmp35_;
	gfloat _tmp36_;
	struct dxGeom* _tmp37_;
	gulong _tmp38_;
	struct dxGeom* _tmp39_;
	gulong _tmp40_;
	struct dxGeom* _tmp41_;
	struct dxSpace* _tmp173_;
	struct dxGeom* _tmp174_;
	struct dxGeom** _tmp175_;
	gint _tmp175__length1;
	gboolean _tmp177_;
	gboolean* _tmp185_;
	gint _tmp185__length1;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (start != NULL, NULL);
	g_return_val_if_fail (aabb != NULL, NULL);
	_tmp0_ = ends;
	_tmp0__length1 = ends_length1;
	_tmp1_ = g_new0 (gboolean, _tmp0__length1);
	ret = _tmp1_;
	ret_length1 = _tmp0__length1;
	_ret_size_ = ret_length1;
	start_bool = FALSE;
	_tmp2_ = ends;
	_tmp2__length1 = ends_length1;
	_tmp3_ = g_new0 (struct dxGeom*, 2 * _tmp2__length1);
	geoms = _tmp3_;
	geoms_length1 = 2 * _tmp2__length1;
	_geoms_size_ = geoms_length1;
	_tmp4_ = GeomTestRay;
	category_bits = _tmp4_;
	_tmp5_ = category_bits;
	_tmp6_ = GeomIgnored;
	collide_bits = ~(_tmp5_ | _tmp6_);
	_tmp7_ = aabb;
	_tmp8_ = soy_atoms_size_get_width (_tmp7_);
	_tmp9_ = _tmp8_;
	x = (gfloat) _tmp9_;
	_tmp10_ = aabb;
	_tmp11_ = soy_atoms_size_get_height (_tmp10_);
	_tmp12_ = _tmp11_;
	y = (gfloat) _tmp12_;
	_tmp13_ = aabb;
	_tmp14_ = soy_atoms_size_get_depth (_tmp13_);
	_tmp15_ = _tmp14_;
	z = (gfloat) _tmp15_;
	_tmp16_ = x;
	_tmp17_ = y;
	_tmp18_ = hypotf (_tmp16_, _tmp17_);
	size_y = _tmp18_;
	_tmp19_ = x;
	_tmp20_ = z;
	_tmp21_ = hypotf (_tmp19_, _tmp20_);
	size_z = _tmp21_;
	g_rw_lock_writer_lock (&soy_scenes__stepLock);
	_tmp22_ = self->space;
	_tmp23_ = x;
	_tmp24_ = y;
	_tmp25_ = z;
	_tmp26_ = dCreateBox (_tmp22_, (dReal) _tmp23_, (dReal) _tmp24_, (dReal) _tmp25_);
	box_start = _tmp26_;
	_tmp27_ = box_start;
	_tmp28_ = start;
	_tmp29_ = soy_atoms_position_get_x (_tmp28_);
	_tmp30_ = _tmp29_;
	_tmp31_ = start;
	_tmp32_ = soy_atoms_position_get_y (_tmp31_);
	_tmp33_ = _tmp32_;
	_tmp34_ = start;
	_tmp35_ = soy_atoms_position_get_z (_tmp34_);
	_tmp36_ = _tmp35_;
	dGeomSetPosition (_tmp27_, (dReal) _tmp30_, (dReal) _tmp33_, (dReal) _tmp36_);
	_tmp37_ = box_start;
	_tmp38_ = collide_bits;
	dGeomSetCollideBits (_tmp37_, _tmp38_);
	_tmp39_ = box_start;
	_tmp40_ = category_bits;
	dGeomSetCategoryBits (_tmp39_, _tmp40_);
	_tmp41_ = box_start;
	dGeomSetData (_tmp41_, (void*) (&start_bool));
	{
		gint i;
		i = 0;
		{
			gboolean _tmp42_;
			_tmp42_ = TRUE;
			while (TRUE) {
				gboolean _tmp43_;
				soyatomsPosition** _tmp45_;
				gint _tmp45__length1;
				gboolean* _tmp46_;
				gint _tmp46__length1;
				gint _tmp47_;
				gboolean _tmp48_;
				soyatomsPosition** _tmp49_;
				gint _tmp49__length1;
				gint _tmp50_;
				soyatomsPosition* _tmp51_;
				soyatomsPosition* _tmp52_;
				soyatomsPosition* end;
				soyatomsPosition* _tmp53_;
				gfloat _tmp54_;
				gfloat _tmp55_;
				soyatomsPosition* _tmp56_;
				gfloat _tmp57_;
				gfloat _tmp58_;
				soyatomsPosition* _tmp59_;
				gfloat _tmp60_;
				gfloat _tmp61_;
				soyatomsPosition* _tmp62_;
				gfloat _tmp63_;
				gfloat _tmp64_;
				gfloat _tmp65_ = 0.0F;
				soyatomsPosition* _tmp66_;
				gfloat _tmp67_;
				gfloat _tmp68_;
				soyatomsPosition* _tmp69_;
				gfloat _tmp70_;
				gfloat _tmp71_;
				gfloat _tmp72_ = 0.0F;
				gfloat dist;
				soyatomsPosition* _tmp73_;
				gfloat _tmp74_;
				gfloat _tmp75_;
				soyatomsPosition* _tmp76_;
				gfloat _tmp77_;
				gfloat _tmp78_;
				gfloat _tmp79_;
				gfloat _tmp80_ = 0.0F;
				gfloat angle;
				gfloat axis_x;
				gfloat _tmp81_;
				soyatomsPosition* _tmp82_;
				gfloat _tmp83_;
				gfloat _tmp84_;
				soyatomsPosition* _tmp85_;
				gfloat _tmp86_;
				gfloat _tmp87_;
				gfloat axis_y;
				gfloat _tmp88_;
				soyatomsPosition* _tmp89_;
				gfloat _tmp90_;
				gfloat _tmp91_;
				soyatomsPosition* _tmp92_;
				gfloat _tmp93_;
				gfloat _tmp94_;
				gfloat axis_z;
				struct dxSpace* _tmp95_;
				gfloat _tmp96_;
				gfloat _tmp97_;
				gfloat _tmp98_;
				struct dxGeom* _tmp99_;
				struct dxGeom* box_end;
				struct dxSpace* _tmp100_;
				gfloat _tmp101_;
				gfloat _tmp102_;
				gfloat _tmp103_;
				struct dxGeom* _tmp104_;
				struct dxGeom* middle;
				struct dxGeom* _tmp105_;
				soyatomsPosition* _tmp106_;
				gfloat _tmp107_;
				gfloat _tmp108_;
				soyatomsPosition* _tmp109_;
				gfloat _tmp110_;
				gfloat _tmp111_;
				soyatomsPosition* _tmp112_;
				gfloat _tmp113_;
				gfloat _tmp114_;
				struct dxGeom* _tmp115_;
				soyatomsPosition* _tmp116_;
				gfloat _tmp117_;
				gfloat _tmp118_;
				soyatomsPosition* _tmp119_;
				gfloat _tmp120_;
				gfloat _tmp121_;
				soyatomsPosition* _tmp122_;
				gfloat _tmp123_;
				gfloat _tmp124_;
				soyatomsPosition* _tmp125_;
				gfloat _tmp126_;
				gfloat _tmp127_;
				soyatomsPosition* _tmp128_;
				gfloat _tmp129_;
				gfloat _tmp130_;
				soyatomsPosition* _tmp131_;
				gfloat _tmp132_;
				gfloat _tmp133_;
				soyatomsPosition* _tmp134_;
				gfloat _tmp135_;
				gfloat _tmp136_;
				soyatomsPosition* _tmp137_;
				gfloat _tmp138_;
				gfloat _tmp139_;
				soyatomsPosition* _tmp140_;
				gfloat _tmp141_;
				gfloat _tmp142_;
				dxMatrix3* _tmp143_;
				dxMatrix3* rot;
				dxMatrix3* _tmp144_;
				gfloat _tmp145_;
				gfloat _tmp146_;
				gfloat _tmp147_;
				gfloat _tmp148_;
				struct dxGeom* _tmp149_;
				dxMatrix3* _tmp150_;
				struct dxGeom* _tmp151_;
				gulong _tmp152_;
				struct dxGeom* _tmp153_;
				gulong _tmp154_;
				struct dxGeom* _tmp155_;
				gulong _tmp156_;
				struct dxGeom* _tmp157_;
				gulong _tmp158_;
				struct dxGeom* _tmp159_;
				gboolean* _tmp160_;
				gint _tmp160__length1;
				gint _tmp161_;
				struct dxGeom* _tmp162_;
				gboolean* _tmp163_;
				gint _tmp163__length1;
				gint _tmp164_;
				struct dxGeom** _tmp165_;
				gint _tmp165__length1;
				gint _tmp166_;
				struct dxGeom* _tmp167_;
				struct dxGeom* _tmp168_;
				struct dxGeom** _tmp169_;
				gint _tmp169__length1;
				gint _tmp170_;
				struct dxGeom* _tmp171_;
				struct dxGeom* _tmp172_;
				_tmp43_ = _tmp42_;
				if (!_tmp43_) {
					gint _tmp44_;
					_tmp44_ = i;
					i = _tmp44_ + 1;
				}
				_tmp42_ = FALSE;
				_tmp45_ = ends;
				_tmp45__length1 = ends_length1;
				if (!(i <= (_tmp45__length1 - 1))) {
					break;
				}
				_tmp46_ = ret;
				_tmp46__length1 = ret_length1;
				_tmp47_ = i;
				_tmp46_[_tmp47_] = FALSE;
				_tmp48_ = _tmp46_[_tmp47_];
				_tmp49_ = ends;
				_tmp49__length1 = ends_length1;
				_tmp50_ = i;
				_tmp51_ = _tmp49_[_tmp50_];
				_tmp52_ = _g_object_ref0 (_tmp51_);
				end = _tmp52_;
				_tmp53_ = end;
				_tmp54_ = soy_atoms_position_get_x (_tmp53_);
				_tmp55_ = _tmp54_;
				_tmp56_ = start;
				_tmp57_ = soy_atoms_position_get_x (_tmp56_);
				_tmp58_ = _tmp57_;
				_tmp59_ = end;
				_tmp60_ = soy_atoms_position_get_y (_tmp59_);
				_tmp61_ = _tmp60_;
				_tmp62_ = start;
				_tmp63_ = soy_atoms_position_get_y (_tmp62_);
				_tmp64_ = _tmp63_;
				_tmp65_ = hypotf (_tmp55_ - _tmp58_, _tmp61_ - _tmp64_);
				_tmp66_ = end;
				_tmp67_ = soy_atoms_position_get_z (_tmp66_);
				_tmp68_ = _tmp67_;
				_tmp69_ = start;
				_tmp70_ = soy_atoms_position_get_z (_tmp69_);
				_tmp71_ = _tmp70_;
				_tmp72_ = hypotf (_tmp65_, _tmp68_ - _tmp71_);
				dist = _tmp72_;
				_tmp73_ = end;
				_tmp74_ = soy_atoms_position_get_x (_tmp73_);
				_tmp75_ = _tmp74_;
				_tmp76_ = start;
				_tmp77_ = soy_atoms_position_get_x (_tmp76_);
				_tmp78_ = _tmp77_;
				_tmp79_ = dist;
				_tmp80_ = acosf ((_tmp75_ - _tmp78_) / _tmp79_);
				angle = _tmp80_;
				axis_x = (gfloat) 0;
				_tmp81_ = dist;
				_tmp82_ = end;
				_tmp83_ = soy_atoms_position_get_z (_tmp82_);
				_tmp84_ = _tmp83_;
				_tmp85_ = start;
				_tmp86_ = soy_atoms_position_get_z (_tmp85_);
				_tmp87_ = _tmp86_;
				axis_y = -(_tmp81_ * (_tmp84_ - _tmp87_));
				_tmp88_ = dist;
				_tmp89_ = end;
				_tmp90_ = soy_atoms_position_get_y (_tmp89_);
				_tmp91_ = _tmp90_;
				_tmp92_ = start;
				_tmp93_ = soy_atoms_position_get_y (_tmp92_);
				_tmp94_ = _tmp93_;
				axis_z = _tmp88_ * (_tmp91_ - _tmp94_);
				_tmp95_ = self->space;
				_tmp96_ = x;
				_tmp97_ = y;
				_tmp98_ = z;
				_tmp99_ = dCreateBox (_tmp95_, (dReal) _tmp96_, (dReal) _tmp97_, (dReal) _tmp98_);
				box_end = _tmp99_;
				_tmp100_ = self->space;
				_tmp101_ = dist;
				_tmp102_ = size_y;
				_tmp103_ = size_z;
				_tmp104_ = dCreateBox (_tmp100_, (dReal) _tmp101_, (dReal) _tmp102_, (dReal) _tmp103_);
				middle = _tmp104_;
				_tmp105_ = box_end;
				_tmp106_ = end;
				_tmp107_ = soy_atoms_position_get_x (_tmp106_);
				_tmp108_ = _tmp107_;
				_tmp109_ = end;
				_tmp110_ = soy_atoms_position_get_y (_tmp109_);
				_tmp111_ = _tmp110_;
				_tmp112_ = end;
				_tmp113_ = soy_atoms_position_get_z (_tmp112_);
				_tmp114_ = _tmp113_;
				dGeomSetPosition (_tmp105_, (dReal) _tmp108_, (dReal) _tmp111_, (dReal) _tmp114_);
				_tmp115_ = middle;
				_tmp116_ = start;
				_tmp117_ = soy_atoms_position_get_x (_tmp116_);
				_tmp118_ = _tmp117_;
				_tmp119_ = end;
				_tmp120_ = soy_atoms_position_get_x (_tmp119_);
				_tmp121_ = _tmp120_;
				_tmp122_ = start;
				_tmp123_ = soy_atoms_position_get_x (_tmp122_);
				_tmp124_ = _tmp123_;
				_tmp125_ = start;
				_tmp126_ = soy_atoms_position_get_y (_tmp125_);
				_tmp127_ = _tmp126_;
				_tmp128_ = end;
				_tmp129_ = soy_atoms_position_get_y (_tmp128_);
				_tmp130_ = _tmp129_;
				_tmp131_ = start;
				_tmp132_ = soy_atoms_position_get_y (_tmp131_);
				_tmp133_ = _tmp132_;
				_tmp134_ = start;
				_tmp135_ = soy_atoms_position_get_z (_tmp134_);
				_tmp136_ = _tmp135_;
				_tmp137_ = end;
				_tmp138_ = soy_atoms_position_get_z (_tmp137_);
				_tmp139_ = _tmp138_;
				_tmp140_ = start;
				_tmp141_ = soy_atoms_position_get_z (_tmp140_);
				_tmp142_ = _tmp141_;
				dGeomSetPosition (_tmp115_, (dReal) (_tmp118_ + ((_tmp121_ - _tmp124_) / 2.0f)), (dReal) (_tmp127_ + ((_tmp130_ - _tmp133_) / 2.0f)), (dReal) (_tmp136_ + ((_tmp139_ - _tmp142_) / 2.0f)));
				_tmp143_ = dmatrix3_new ();
				rot = _tmp143_;
				_tmp144_ = rot;
				_tmp145_ = axis_x;
				_tmp146_ = axis_y;
				_tmp147_ = axis_z;
				_tmp148_ = angle;
				dRFromAxisAndAngle (_tmp144_, (dReal) _tmp145_, (dReal) _tmp146_, (dReal) _tmp147_, (dReal) _tmp148_);
				_tmp149_ = middle;
				_tmp150_ = rot;
				dGeomSetRotation (_tmp149_, _tmp150_);
				_tmp151_ = box_end;
				_tmp152_ = collide_bits;
				dGeomSetCollideBits (_tmp151_, _tmp152_);
				_tmp153_ = middle;
				_tmp154_ = collide_bits;
				dGeomSetCollideBits (_tmp153_, _tmp154_);
				_tmp155_ = box_end;
				_tmp156_ = category_bits;
				dGeomSetCategoryBits (_tmp155_, _tmp156_);
				_tmp157_ = middle;
				_tmp158_ = category_bits;
				dGeomSetCategoryBits (_tmp157_, _tmp158_);
				_tmp159_ = box_end;
				_tmp160_ = ret;
				_tmp160__length1 = ret_length1;
				_tmp161_ = i;
				dGeomSetData (_tmp159_, (void*) (&_tmp160_[_tmp161_]));
				_tmp162_ = middle;
				_tmp163_ = ret;
				_tmp163__length1 = ret_length1;
				_tmp164_ = i;
				dGeomSetData (_tmp162_, (void*) (&_tmp163_[_tmp164_]));
				_tmp165_ = geoms;
				_tmp165__length1 = geoms_length1;
				_tmp166_ = i;
				_tmp167_ = middle;
				_tmp165_[2 * _tmp166_] = _tmp167_;
				_tmp168_ = _tmp165_[2 * _tmp166_];
				_tmp169_ = geoms;
				_tmp169__length1 = geoms_length1;
				_tmp170_ = i;
				_tmp171_ = box_end;
				_tmp169_[(2 * _tmp170_) + 1] = _tmp171_;
				_tmp172_ = _tmp169_[(2 * _tmp170_) + 1];
				_dmatrix3_free0 (rot);
				_g_object_unref0 (end);
			}
		}
	}
	_tmp173_ = self->space;
	dSpaceCollide (_tmp173_, self, __soy_scenes_scene_check_collisions_NearCallback_dnear_callback);
	_tmp174_ = box_start;
	dGeomDestroy (_tmp174_);
	_tmp175_ = geoms;
	_tmp175__length1 = geoms_length1;
	{
		struct dxGeom** i_collection = NULL;
		gint i_collection_length1 = 0;
		gint _i_collection_size_ = 0;
		gint i_it = 0;
		i_collection = _tmp175_;
		i_collection_length1 = _tmp175__length1;
		for (i_it = 0; i_it < _tmp175__length1; i_it = i_it + 1) {
			struct dxGeom* i = NULL;
			i = i_collection[i_it];
			{
				struct dxGeom* _tmp176_;
				_tmp176_ = i;
				dGeomDestroy (_tmp176_);
			}
		}
	}
	g_rw_lock_writer_unlock (&soy_scenes__stepLock);
	_tmp177_ = start_bool;
	if (_tmp177_) {
		{
			gint i;
			i = 0;
			{
				gboolean _tmp178_;
				_tmp178_ = TRUE;
				while (TRUE) {
					gboolean _tmp179_;
					soyatomsPosition** _tmp181_;
					gint _tmp181__length1;
					gboolean* _tmp182_;
					gint _tmp182__length1;
					gint _tmp183_;
					gboolean _tmp184_;
					_tmp179_ = _tmp178_;
					if (!_tmp179_) {
						gint _tmp180_;
						_tmp180_ = i;
						i = _tmp180_ + 1;
					}
					_tmp178_ = FALSE;
					_tmp181_ = ends;
					_tmp181__length1 = ends_length1;
					if (!(i <= (_tmp181__length1 - 1))) {
						break;
					}
					_tmp182_ = ret;
					_tmp182__length1 = ret_length1;
					_tmp183_ = i;
					_tmp182_[_tmp183_] = TRUE;
					_tmp184_ = _tmp182_[_tmp183_];
				}
			}
		}
	}
	_tmp185_ = ret;
	_tmp185__length1 = ret_length1;
	if (result_length1) {
		*result_length1 = _tmp185__length1;
	}
	result = _tmp185_;
	geoms = (g_free (geoms), NULL);
	return result;
}


static void _soy_scenes_scene_enable_skybox (soyscenesScene* self) {
	gboolean _tmp0_;
	soytexturesCubemap* _tmp3_;
	soytexturesCubemap* _tmp4_;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->priv->_skybox_updated;
	if (_tmp0_) {
		_soy_scenes_scene_update_skybox (self);
	} else {
		GLuint _tmp1_;
		GLuint _tmp2_;
		_tmp1_ = self->priv->_ebo;
		glBindBuffer (GL_ELEMENT_ARRAY_BUFFER, _tmp1_);
		_tmp2_ = self->priv->_vbo;
		glBindBuffer (GL_ARRAY_BUFFER, _tmp2_);
	}
	glActiveTexture (GL_TEXTURE0);
	glClientActiveTexture (GL_TEXTURE0);
	glEnableClientState (GL_TEXTURE_COORD_ARRAY);
	glTexEnvi (GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, (GLint) GL_MODULATE);
	_tmp3_ = self->priv->_skybox;
	soy_textures_texture_enable ((soytexturesTexture*) _tmp3_);
	glVertexPointer ((GLint) 3, GL_FLOAT, (GLsizei) (sizeof (GLfloat) * 3), NULL);
	glTexCoordPointer ((GLint) 3, GL_FLOAT, (GLsizei) (sizeof (GLfloat) * 3), NULL);
	glDrawElements (GL_TRIANGLES, (GLsizei) 36, GL_UNSIGNED_BYTE, NULL);
	glClientActiveTexture (GL_TEXTURE0);
	glDisableClientState (GL_TEXTURE_COORD_ARRAY);
	_tmp4_ = self->priv->_skybox;
	soy_textures_texture_disable ((soytexturesTexture*) _tmp4_);
}


static void _soy_scenes_scene_update_skybox (soyscenesScene* self) {
	GLuint _tmp0_;
	GLubyte* _tmp3_ = NULL;
	GLubyte* elements;
	gint elements_length1;
	gint _elements_size_;
	GLfloat* _tmp4_ = NULL;
	GLfloat* vertices;
	gint vertices_length1;
	gint _vertices_size_;
	GLuint _tmp5_;
	GLuint _tmp6_;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->priv->_ebo;
	if (_tmp0_ == ((GLuint) 0)) {
		GLuint _tmp1_ = 0U;
		GLuint _tmp2_ = 0U;
		glGenBuffers ((GLsizei) 1, &_tmp1_);
		self->priv->_ebo = _tmp1_;
		glGenBuffers ((GLsizei) 1, &_tmp2_);
		self->priv->_vbo = _tmp2_;
	}
	_tmp3_ = g_new0 (GLubyte, 36);
	_tmp3_[0] = (GLubyte) 5;
	_tmp3_[1] = (GLubyte) 7;
	_tmp3_[2] = (GLubyte) 1;
	_tmp3_[3] = (GLubyte) 1;
	_tmp3_[4] = (GLubyte) 7;
	_tmp3_[5] = (GLubyte) 3;
	_tmp3_[6] = (GLubyte) 0;
	_tmp3_[7] = (GLubyte) 2;
	_tmp3_[8] = (GLubyte) 4;
	_tmp3_[9] = (GLubyte) 4;
	_tmp3_[10] = (GLubyte) 2;
	_tmp3_[11] = (GLubyte) 6;
	_tmp3_[12] = (GLubyte) 6;
	_tmp3_[13] = (GLubyte) 2;
	_tmp3_[14] = (GLubyte) 7;
	_tmp3_[15] = (GLubyte) 7;
	_tmp3_[16] = (GLubyte) 2;
	_tmp3_[17] = (GLubyte) 3;
	_tmp3_[18] = (GLubyte) 0;
	_tmp3_[19] = (GLubyte) 4;
	_tmp3_[20] = (GLubyte) 1;
	_tmp3_[21] = (GLubyte) 1;
	_tmp3_[22] = (GLubyte) 4;
	_tmp3_[23] = (GLubyte) 5;
	_tmp3_[24] = (GLubyte) 4;
	_tmp3_[25] = (GLubyte) 6;
	_tmp3_[26] = (GLubyte) 5;
	_tmp3_[27] = (GLubyte) 5;
	_tmp3_[28] = (GLubyte) 6;
	_tmp3_[29] = (GLubyte) 7;
	_tmp3_[30] = (GLubyte) 1;
	_tmp3_[31] = (GLubyte) 3;
	_tmp3_[32] = (GLubyte) 0;
	_tmp3_[33] = (GLubyte) 0;
	_tmp3_[34] = (GLubyte) 3;
	_tmp3_[35] = (GLubyte) 2;
	elements = _tmp3_;
	elements_length1 = 36;
	_elements_size_ = elements_length1;
	_tmp4_ = g_new0 (GLfloat, 24);
	_tmp4_[0] = (GLfloat) (-1);
	_tmp4_[1] = (GLfloat) (-1);
	_tmp4_[2] = (GLfloat) (-1);
	_tmp4_[3] = (GLfloat) 1;
	_tmp4_[4] = (GLfloat) (-1);
	_tmp4_[5] = (GLfloat) (-1);
	_tmp4_[6] = (GLfloat) (-1);
	_tmp4_[7] = (GLfloat) 1;
	_tmp4_[8] = (GLfloat) (-1);
	_tmp4_[9] = (GLfloat) 1;
	_tmp4_[10] = (GLfloat) 1;
	_tmp4_[11] = (GLfloat) (-1);
	_tmp4_[12] = (GLfloat) (-1);
	_tmp4_[13] = (GLfloat) (-1);
	_tmp4_[14] = (GLfloat) 1;
	_tmp4_[15] = (GLfloat) 1;
	_tmp4_[16] = (GLfloat) (-1);
	_tmp4_[17] = (GLfloat) 1;
	_tmp4_[18] = (GLfloat) (-1);
	_tmp4_[19] = (GLfloat) 1;
	_tmp4_[20] = (GLfloat) 1;
	_tmp4_[21] = (GLfloat) 1;
	_tmp4_[22] = (GLfloat) 1;
	_tmp4_[23] = (GLfloat) 1;
	vertices = _tmp4_;
	vertices_length1 = 24;
	_vertices_size_ = vertices_length1;
	_tmp5_ = self->priv->_ebo;
	glBindBuffer (GL_ELEMENT_ARRAY_BUFFER, _tmp5_);
	glBufferData (GL_ELEMENT_ARRAY_BUFFER, (GLsizei) 36, elements, GL_STATIC_DRAW);
	_tmp6_ = self->priv->_vbo;
	glBindBuffer (GL_ARRAY_BUFFER, _tmp6_);
	glBufferData (GL_ARRAY_BUFFER, (GLsizei) ((8 * 3) * sizeof (GLfloat)), vertices, GL_STATIC_DRAW);
	self->priv->_skybox_updated = FALSE;
	vertices = (g_free (vertices), NULL);
	elements = (g_free (elements), NULL);
}


static GLfloat* _vala_array_dup9 (GLfloat* self, int length) {
	return g_memdup (self, length * sizeof (GLfloat));
}


void soy_scenes_scene_calculateTSLV (soyscenesScene* self, GLfloat* vertices, int vertices_length1) {
	gboolean _tmp0_ = FALSE;
	GeeHashSet* _tmp1_;
	gint _tmp2_;
	gint _tmp3_;
	gboolean _tmp5_;
	g_return_if_fail (self != NULL);
	_tmp1_ = self->lights;
	_tmp2_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp1_);
	_tmp3_ = _tmp2_;
	if (_tmp3_ != 0) {
		GLfloat* _tmp4_;
		gint _tmp4__length1;
		_tmp4_ = vertices;
		_tmp4__length1 = vertices_length1;
		_tmp0_ = _tmp4__length1 != 0;
	} else {
		_tmp0_ = FALSE;
	}
	_tmp5_ = _tmp0_;
	if (_tmp5_) {
		GLfloat* _tmp6_ = NULL;
		GLfloat* _inv_mm;
		gint _inv_mm_length1;
		gint __inv_mm_size_;
		dReal* _tmp7_ = NULL;
		dReal* _model_light_pos;
		gint _model_light_pos_length1;
		gint __model_light_pos_size_;
		dReal* _tmp8_ = NULL;
		dReal* _vert_light_pos;
		gint _vert_light_pos_length1;
		gint __vert_light_pos_size_;
		dReal* _tmp9_ = NULL;
		dReal* _binormal;
		gint _binormal_length1;
		gint __binormal_size_;
		GLfloat* _tmp10_;
		gint _tmp10__length1;
		GLfloat* _tmp11_ = NULL;
		GLfloat* _tmp12_;
		gint _tmp12__length1;
		GLfloat* _tmp13_;
		gint _tmp13__length1;
		GLfloat* _tmp14_;
		gint _tmp14__length1;
		GLfloat* rotation;
		gint rotation_length1;
		gint _rotation_size_;
		soyatomsPosition* _tmp15_;
		soyatomsPosition* _tmp16_;
		soyatomsPosition* _tmp17_;
		soyatomsPosition* position;
		dxVector3* _tmp18_;
		dxVector3* dummy;
		dxVector3* _tmp19_;
		dxVector3* light_position;
		GLfloat* _tmp29_;
		gint _tmp29__length1;
		GLfloat* _tmp30_;
		gint _tmp30__length1;
		GLfloat _tmp31_;
		GLfloat _tmp32_;
		GLfloat* _tmp33_;
		gint _tmp33__length1;
		GLfloat* _tmp34_;
		gint _tmp34__length1;
		GLfloat _tmp35_;
		GLfloat _tmp36_;
		GLfloat* _tmp37_;
		gint _tmp37__length1;
		GLfloat* _tmp38_;
		gint _tmp38__length1;
		GLfloat _tmp39_;
		GLfloat _tmp40_;
		GLfloat* _tmp41_;
		gint _tmp41__length1;
		GLfloat _tmp42_;
		GLfloat* _tmp43_;
		gint _tmp43__length1;
		GLfloat* _tmp44_;
		gint _tmp44__length1;
		GLfloat _tmp45_;
		GLfloat _tmp46_;
		GLfloat* _tmp47_;
		gint _tmp47__length1;
		GLfloat* _tmp48_;
		gint _tmp48__length1;
		GLfloat _tmp49_;
		GLfloat _tmp50_;
		GLfloat* _tmp51_;
		gint _tmp51__length1;
		GLfloat* _tmp52_;
		gint _tmp52__length1;
		GLfloat _tmp53_;
		GLfloat _tmp54_;
		GLfloat* _tmp55_;
		gint _tmp55__length1;
		GLfloat _tmp56_;
		GLfloat* _tmp57_;
		gint _tmp57__length1;
		GLfloat* _tmp58_;
		gint _tmp58__length1;
		GLfloat _tmp59_;
		GLfloat _tmp60_;
		GLfloat* _tmp61_;
		gint _tmp61__length1;
		GLfloat* _tmp62_;
		gint _tmp62__length1;
		GLfloat _tmp63_;
		GLfloat _tmp64_;
		GLfloat* _tmp65_;
		gint _tmp65__length1;
		GLfloat* _tmp66_;
		gint _tmp66__length1;
		GLfloat _tmp67_;
		GLfloat _tmp68_;
		GLfloat* _tmp69_;
		gint _tmp69__length1;
		GLfloat _tmp70_;
		GLfloat* _tmp71_;
		gint _tmp71__length1;
		soyatomsPosition* _tmp72_;
		gfloat _tmp73_;
		gfloat _tmp74_;
		GLfloat _tmp75_;
		GLfloat* _tmp76_;
		gint _tmp76__length1;
		soyatomsPosition* _tmp77_;
		gfloat _tmp78_;
		gfloat _tmp79_;
		GLfloat _tmp80_;
		GLfloat* _tmp81_;
		gint _tmp81__length1;
		soyatomsPosition* _tmp82_;
		gfloat _tmp83_;
		gfloat _tmp84_;
		GLfloat _tmp85_;
		GLfloat* _tmp86_;
		gint _tmp86__length1;
		GLfloat _tmp87_;
		dReal* _tmp88_;
		gint _tmp88__length1;
		GLfloat* _tmp89_;
		gint _tmp89__length1;
		GLfloat _tmp90_;
		dxVector3* _tmp91_;
		dReal _tmp92_;
		GLfloat* _tmp93_;
		gint _tmp93__length1;
		GLfloat _tmp94_;
		GLfloat* _tmp95_;
		gint _tmp95__length1;
		GLfloat _tmp96_;
		dxVector3* _tmp97_;
		dReal _tmp98_;
		GLfloat* _tmp99_;
		gint _tmp99__length1;
		GLfloat _tmp100_;
		GLfloat* _tmp101_;
		gint _tmp101__length1;
		GLfloat _tmp102_;
		dxVector3* _tmp103_;
		dReal _tmp104_;
		GLfloat* _tmp105_;
		gint _tmp105__length1;
		GLfloat _tmp106_;
		dReal _tmp107_;
		dReal* _tmp108_;
		gint _tmp108__length1;
		GLfloat* _tmp109_;
		gint _tmp109__length1;
		GLfloat _tmp110_;
		dxVector3* _tmp111_;
		dReal _tmp112_;
		GLfloat* _tmp113_;
		gint _tmp113__length1;
		GLfloat _tmp114_;
		GLfloat* _tmp115_;
		gint _tmp115__length1;
		GLfloat _tmp116_;
		dxVector3* _tmp117_;
		dReal _tmp118_;
		GLfloat* _tmp119_;
		gint _tmp119__length1;
		GLfloat _tmp120_;
		GLfloat* _tmp121_;
		gint _tmp121__length1;
		GLfloat _tmp122_;
		dxVector3* _tmp123_;
		dReal _tmp124_;
		GLfloat* _tmp125_;
		gint _tmp125__length1;
		GLfloat _tmp126_;
		dReal _tmp127_;
		dReal* _tmp128_;
		gint _tmp128__length1;
		GLfloat* _tmp129_;
		gint _tmp129__length1;
		GLfloat _tmp130_;
		dxVector3* _tmp131_;
		dReal _tmp132_;
		GLfloat* _tmp133_;
		gint _tmp133__length1;
		GLfloat _tmp134_;
		GLfloat* _tmp135_;
		gint _tmp135__length1;
		GLfloat _tmp136_;
		dxVector3* _tmp137_;
		dReal _tmp138_;
		GLfloat* _tmp139_;
		gint _tmp139__length1;
		GLfloat _tmp140_;
		GLfloat* _tmp141_;
		gint _tmp141__length1;
		GLfloat _tmp142_;
		dxVector3* _tmp143_;
		dReal _tmp144_;
		GLfloat* _tmp145_;
		gint _tmp145__length1;
		GLfloat _tmp146_;
		dReal _tmp147_;
		_tmp6_ = g_new0 (GLfloat, 16);
		_inv_mm = _tmp6_;
		_inv_mm_length1 = 16;
		__inv_mm_size_ = _inv_mm_length1;
		_tmp7_ = g_new0 (dReal, 3);
		_model_light_pos = _tmp7_;
		_model_light_pos_length1 = 3;
		__model_light_pos_size_ = _model_light_pos_length1;
		_tmp8_ = g_new0 (dReal, 3);
		_vert_light_pos = _tmp8_;
		_vert_light_pos_length1 = 3;
		__vert_light_pos_size_ = _vert_light_pos_length1;
		_tmp9_ = g_new0 (dReal, 3);
		_binormal = _tmp9_;
		_binormal_length1 = 3;
		__binormal_size_ = _binormal_length1;
		_tmp10_ = vertices;
		_tmp10__length1 = vertices_length1;
		_tmp11_ = g_new0 (GLfloat, (gint) ((_tmp10__length1 * 3) / 14));
		self->tslvs = (g_free (self->tslvs), NULL);
		self->tslvs = _tmp11_;
		self->tslvs_length1 = (gint) ((_tmp10__length1 * 3) / 14);
		_tmp12_ = soy_scenes_scene_get_rotation (self, &_tmp12__length1);
		_tmp13_ = _tmp12_;
		_tmp13__length1 = _tmp12__length1;
		_tmp14_ = (_tmp13_ != NULL) ? _vala_array_dup9 (_tmp13_, _tmp13__length1) : ((gpointer) _tmp13_);
		_tmp14__length1 = _tmp13__length1;
		rotation = _tmp14_;
		rotation_length1 = _tmp14__length1;
		_rotation_size_ = rotation_length1;
		_tmp15_ = soy_scenes_scene_get_position (self);
		_tmp16_ = _tmp15_;
		_tmp17_ = _g_object_ref0 (_tmp16_);
		position = _tmp17_;
		_tmp18_ = dvector3_new ();
		dummy = _tmp18_;
		_tmp19_ = dummy;
		light_position = _tmp19_;
		{
			GeeHashSet* _tmp20_;
			GeeIterator* _tmp21_ = NULL;
			GeeIterator* _light_it;
			_tmp20_ = self->lights;
			_tmp21_ = gee_abstract_collection_iterator ((GeeAbstractCollection*) _tmp20_);
			_light_it = _tmp21_;
			while (TRUE) {
				GeeIterator* _tmp22_;
				gboolean _tmp23_ = FALSE;
				GeeIterator* _tmp24_;
				gpointer _tmp25_ = NULL;
				soybodiesLight* light;
				soybodiesLight* _tmp26_;
				struct dxBody* _tmp27_;
				dxVector3* _tmp28_ = NULL;
				_tmp22_ = _light_it;
				_tmp23_ = gee_iterator_next (_tmp22_);
				if (!_tmp23_) {
					break;
				}
				_tmp24_ = _light_it;
				_tmp25_ = gee_iterator_get (_tmp24_);
				light = (soybodiesLight*) _tmp25_;
				_tmp26_ = light;
				_tmp27_ = ((soybodiesBody*) _tmp26_)->body;
				_tmp28_ = dBodyGetPosition (_tmp27_);
				light_position = _tmp28_;
				_g_object_unref0 (light);
				break;
			}
			_g_object_unref0 (_light_it);
		}
		_tmp29_ = _inv_mm;
		_tmp29__length1 = _inv_mm_length1;
		_tmp30_ = rotation;
		_tmp30__length1 = rotation_length1;
		_tmp31_ = _tmp30_[0];
		_tmp29_[0] = (GLfloat) _tmp31_;
		_tmp32_ = _tmp29_[0];
		_tmp33_ = _inv_mm;
		_tmp33__length1 = _inv_mm_length1;
		_tmp34_ = rotation;
		_tmp34__length1 = rotation_length1;
		_tmp35_ = _tmp34_[1];
		_tmp33_[1] = (GLfloat) _tmp35_;
		_tmp36_ = _tmp33_[1];
		_tmp37_ = _inv_mm;
		_tmp37__length1 = _inv_mm_length1;
		_tmp38_ = rotation;
		_tmp38__length1 = rotation_length1;
		_tmp39_ = _tmp38_[2];
		_tmp37_[2] = (GLfloat) _tmp39_;
		_tmp40_ = _tmp37_[2];
		_tmp41_ = _inv_mm;
		_tmp41__length1 = _inv_mm_length1;
		_tmp41_[3] = (GLfloat) 0.0;
		_tmp42_ = _tmp41_[3];
		_tmp43_ = _inv_mm;
		_tmp43__length1 = _inv_mm_length1;
		_tmp44_ = rotation;
		_tmp44__length1 = rotation_length1;
		_tmp45_ = _tmp44_[3];
		_tmp43_[4] = (GLfloat) _tmp45_;
		_tmp46_ = _tmp43_[4];
		_tmp47_ = _inv_mm;
		_tmp47__length1 = _inv_mm_length1;
		_tmp48_ = rotation;
		_tmp48__length1 = rotation_length1;
		_tmp49_ = _tmp48_[4];
		_tmp47_[5] = (GLfloat) _tmp49_;
		_tmp50_ = _tmp47_[5];
		_tmp51_ = _inv_mm;
		_tmp51__length1 = _inv_mm_length1;
		_tmp52_ = rotation;
		_tmp52__length1 = rotation_length1;
		_tmp53_ = _tmp52_[5];
		_tmp51_[6] = (GLfloat) _tmp53_;
		_tmp54_ = _tmp51_[6];
		_tmp55_ = _inv_mm;
		_tmp55__length1 = _inv_mm_length1;
		_tmp55_[7] = (GLfloat) 0.0;
		_tmp56_ = _tmp55_[7];
		_tmp57_ = _inv_mm;
		_tmp57__length1 = _inv_mm_length1;
		_tmp58_ = rotation;
		_tmp58__length1 = rotation_length1;
		_tmp59_ = _tmp58_[6];
		_tmp57_[8] = (GLfloat) _tmp59_;
		_tmp60_ = _tmp57_[8];
		_tmp61_ = _inv_mm;
		_tmp61__length1 = _inv_mm_length1;
		_tmp62_ = rotation;
		_tmp62__length1 = rotation_length1;
		_tmp63_ = _tmp62_[7];
		_tmp61_[9] = (GLfloat) _tmp63_;
		_tmp64_ = _tmp61_[9];
		_tmp65_ = _inv_mm;
		_tmp65__length1 = _inv_mm_length1;
		_tmp66_ = rotation;
		_tmp66__length1 = rotation_length1;
		_tmp67_ = _tmp66_[8];
		_tmp65_[10] = (GLfloat) _tmp67_;
		_tmp68_ = _tmp65_[10];
		_tmp69_ = _inv_mm;
		_tmp69__length1 = _inv_mm_length1;
		_tmp69_[11] = (GLfloat) 0.0;
		_tmp70_ = _tmp69_[11];
		_tmp71_ = _inv_mm;
		_tmp71__length1 = _inv_mm_length1;
		_tmp72_ = position;
		_tmp73_ = soy_atoms_position_get_x (_tmp72_);
		_tmp74_ = _tmp73_;
		_tmp71_[12] = (GLfloat) (-_tmp74_);
		_tmp75_ = _tmp71_[12];
		_tmp76_ = _inv_mm;
		_tmp76__length1 = _inv_mm_length1;
		_tmp77_ = position;
		_tmp78_ = soy_atoms_position_get_y (_tmp77_);
		_tmp79_ = _tmp78_;
		_tmp76_[13] = (GLfloat) (-_tmp79_);
		_tmp80_ = _tmp76_[13];
		_tmp81_ = _inv_mm;
		_tmp81__length1 = _inv_mm_length1;
		_tmp82_ = position;
		_tmp83_ = soy_atoms_position_get_z (_tmp82_);
		_tmp84_ = _tmp83_;
		_tmp81_[14] = (GLfloat) (-_tmp84_);
		_tmp85_ = _tmp81_[14];
		_tmp86_ = _inv_mm;
		_tmp86__length1 = _inv_mm_length1;
		_tmp86_[15] = (GLfloat) 1.0;
		_tmp87_ = _tmp86_[15];
		_tmp88_ = _model_light_pos;
		_tmp88__length1 = _model_light_pos_length1;
		_tmp89_ = _inv_mm;
		_tmp89__length1 = _inv_mm_length1;
		_tmp90_ = _tmp89_[0];
		_tmp91_ = light_position;
		_tmp92_ = _tmp91_->x;
		_tmp93_ = _inv_mm;
		_tmp93__length1 = _inv_mm_length1;
		_tmp94_ = _tmp93_[12];
		_tmp95_ = _inv_mm;
		_tmp95__length1 = _inv_mm_length1;
		_tmp96_ = _tmp95_[4];
		_tmp97_ = light_position;
		_tmp98_ = _tmp97_->y;
		_tmp99_ = _inv_mm;
		_tmp99__length1 = _inv_mm_length1;
		_tmp100_ = _tmp99_[13];
		_tmp101_ = _inv_mm;
		_tmp101__length1 = _inv_mm_length1;
		_tmp102_ = _tmp101_[8];
		_tmp103_ = light_position;
		_tmp104_ = _tmp103_->z;
		_tmp105_ = _inv_mm;
		_tmp105__length1 = _inv_mm_length1;
		_tmp106_ = _tmp105_[14];
		_tmp88_[0] = ((_tmp90_ * (_tmp92_ + _tmp94_)) + (_tmp96_ * (_tmp98_ + _tmp100_))) + (_tmp102_ * (_tmp104_ + _tmp106_));
		_tmp107_ = _tmp88_[0];
		_tmp108_ = _model_light_pos;
		_tmp108__length1 = _model_light_pos_length1;
		_tmp109_ = _inv_mm;
		_tmp109__length1 = _inv_mm_length1;
		_tmp110_ = _tmp109_[1];
		_tmp111_ = light_position;
		_tmp112_ = _tmp111_->x;
		_tmp113_ = _inv_mm;
		_tmp113__length1 = _inv_mm_length1;
		_tmp114_ = _tmp113_[12];
		_tmp115_ = _inv_mm;
		_tmp115__length1 = _inv_mm_length1;
		_tmp116_ = _tmp115_[5];
		_tmp117_ = light_position;
		_tmp118_ = _tmp117_->y;
		_tmp119_ = _inv_mm;
		_tmp119__length1 = _inv_mm_length1;
		_tmp120_ = _tmp119_[13];
		_tmp121_ = _inv_mm;
		_tmp121__length1 = _inv_mm_length1;
		_tmp122_ = _tmp121_[9];
		_tmp123_ = light_position;
		_tmp124_ = _tmp123_->z;
		_tmp125_ = _inv_mm;
		_tmp125__length1 = _inv_mm_length1;
		_tmp126_ = _tmp125_[14];
		_tmp108_[1] = ((_tmp110_ * (_tmp112_ + _tmp114_)) + (_tmp116_ * (_tmp118_ + _tmp120_))) + (_tmp122_ * (_tmp124_ + _tmp126_));
		_tmp127_ = _tmp108_[1];
		_tmp128_ = _model_light_pos;
		_tmp128__length1 = _model_light_pos_length1;
		_tmp129_ = _inv_mm;
		_tmp129__length1 = _inv_mm_length1;
		_tmp130_ = _tmp129_[2];
		_tmp131_ = light_position;
		_tmp132_ = _tmp131_->x;
		_tmp133_ = _inv_mm;
		_tmp133__length1 = _inv_mm_length1;
		_tmp134_ = _tmp133_[12];
		_tmp135_ = _inv_mm;
		_tmp135__length1 = _inv_mm_length1;
		_tmp136_ = _tmp135_[6];
		_tmp137_ = light_position;
		_tmp138_ = _tmp137_->y;
		_tmp139_ = _inv_mm;
		_tmp139__length1 = _inv_mm_length1;
		_tmp140_ = _tmp139_[13];
		_tmp141_ = _inv_mm;
		_tmp141__length1 = _inv_mm_length1;
		_tmp142_ = _tmp141_[10];
		_tmp143_ = light_position;
		_tmp144_ = _tmp143_->z;
		_tmp145_ = _inv_mm;
		_tmp145__length1 = _inv_mm_length1;
		_tmp146_ = _tmp145_[14];
		_tmp128_[2] = ((_tmp130_ * (_tmp132_ + _tmp134_)) + (_tmp136_ * (_tmp138_ + _tmp140_))) + (_tmp142_ * (_tmp144_ + _tmp146_));
		_tmp147_ = _tmp128_[2];
		{
			gint i;
			i = 0;
			{
				gboolean _tmp148_;
				_tmp148_ = TRUE;
				while (TRUE) {
					gboolean _tmp149_;
					GLfloat* _tmp151_;
					gint _tmp151__length1;
					dReal* _tmp152_;
					gint _tmp152__length1;
					dReal* _tmp153_;
					gint _tmp153__length1;
					dReal _tmp154_;
					GLfloat* _tmp155_;
					gint _tmp155__length1;
					gint _tmp156_;
					GLfloat _tmp157_;
					dReal _tmp158_;
					dReal* _tmp159_;
					gint _tmp159__length1;
					dReal* _tmp160_;
					gint _tmp160__length1;
					dReal _tmp161_;
					GLfloat* _tmp162_;
					gint _tmp162__length1;
					gint _tmp163_;
					GLfloat _tmp164_;
					dReal _tmp165_;
					dReal* _tmp166_;
					gint _tmp166__length1;
					dReal* _tmp167_;
					gint _tmp167__length1;
					dReal _tmp168_;
					GLfloat* _tmp169_;
					gint _tmp169__length1;
					gint _tmp170_;
					GLfloat _tmp171_;
					dReal _tmp172_;
					dReal* _tmp173_;
					gint _tmp173__length1;
					dReal _tmp174_;
					dReal* _tmp175_;
					gint _tmp175__length1;
					dReal _tmp176_;
					dReal* _tmp177_;
					gint _tmp177__length1;
					dReal _tmp178_;
					dReal* _tmp179_;
					gint _tmp179__length1;
					dReal _tmp180_;
					dReal* _tmp181_;
					gint _tmp181__length1;
					dReal _tmp182_;
					dReal* _tmp183_;
					gint _tmp183__length1;
					dReal _tmp184_;
					gfloat _tmp185_ = 0.0F;
					gfloat _lgt;
					dReal* _tmp186_;
					gint _tmp186__length1;
					dReal* _tmp187_;
					gint _tmp187__length1;
					dReal _tmp188_;
					gfloat _tmp189_;
					dReal _tmp190_;
					dReal* _tmp191_;
					gint _tmp191__length1;
					dReal* _tmp192_;
					gint _tmp192__length1;
					dReal _tmp193_;
					gfloat _tmp194_;
					dReal _tmp195_;
					dReal* _tmp196_;
					gint _tmp196__length1;
					dReal* _tmp197_;
					gint _tmp197__length1;
					dReal _tmp198_;
					gfloat _tmp199_;
					dReal _tmp200_;
					dReal* _tmp201_;
					gint _tmp201__length1;
					GLfloat* _tmp202_;
					gint _tmp202__length1;
					gint _tmp203_;
					GLfloat _tmp204_;
					GLfloat* _tmp205_;
					gint _tmp205__length1;
					gint _tmp206_;
					GLfloat _tmp207_;
					GLfloat* _tmp208_;
					gint _tmp208__length1;
					gint _tmp209_;
					GLfloat _tmp210_;
					GLfloat* _tmp211_;
					gint _tmp211__length1;
					gint _tmp212_;
					GLfloat _tmp213_;
					dReal _tmp214_;
					dReal* _tmp215_;
					gint _tmp215__length1;
					GLfloat* _tmp216_;
					gint _tmp216__length1;
					gint _tmp217_;
					GLfloat _tmp218_;
					GLfloat* _tmp219_;
					gint _tmp219__length1;
					gint _tmp220_;
					GLfloat _tmp221_;
					GLfloat* _tmp222_;
					gint _tmp222__length1;
					gint _tmp223_;
					GLfloat _tmp224_;
					GLfloat* _tmp225_;
					gint _tmp225__length1;
					gint _tmp226_;
					GLfloat _tmp227_;
					dReal _tmp228_;
					dReal* _tmp229_;
					gint _tmp229__length1;
					GLfloat* _tmp230_;
					gint _tmp230__length1;
					gint _tmp231_;
					GLfloat _tmp232_;
					GLfloat* _tmp233_;
					gint _tmp233__length1;
					gint _tmp234_;
					GLfloat _tmp235_;
					GLfloat* _tmp236_;
					gint _tmp236__length1;
					gint _tmp237_;
					GLfloat _tmp238_;
					GLfloat* _tmp239_;
					gint _tmp239__length1;
					gint _tmp240_;
					GLfloat _tmp241_;
					dReal _tmp242_;
					GLfloat* _tmp243_;
					gint _tmp243__length1;
					gint _tmp244_;
					dReal* _tmp245_;
					gint _tmp245__length1;
					dReal _tmp246_;
					GLfloat* _tmp247_;
					gint _tmp247__length1;
					gint _tmp248_;
					GLfloat _tmp249_;
					dReal* _tmp250_;
					gint _tmp250__length1;
					dReal _tmp251_;
					GLfloat* _tmp252_;
					gint _tmp252__length1;
					gint _tmp253_;
					GLfloat _tmp254_;
					dReal* _tmp255_;
					gint _tmp255__length1;
					dReal _tmp256_;
					GLfloat* _tmp257_;
					gint _tmp257__length1;
					gint _tmp258_;
					GLfloat _tmp259_;
					GLfloat _tmp260_;
					GLfloat* _tmp261_;
					gint _tmp261__length1;
					gint _tmp262_;
					dReal* _tmp263_;
					gint _tmp263__length1;
					dReal _tmp264_;
					dReal* _tmp265_;
					gint _tmp265__length1;
					dReal _tmp266_;
					dReal* _tmp267_;
					gint _tmp267__length1;
					dReal _tmp268_;
					dReal* _tmp269_;
					gint _tmp269__length1;
					dReal _tmp270_;
					dReal* _tmp271_;
					gint _tmp271__length1;
					dReal _tmp272_;
					dReal* _tmp273_;
					gint _tmp273__length1;
					dReal _tmp274_;
					GLfloat _tmp275_;
					GLfloat* _tmp276_;
					gint _tmp276__length1;
					gint _tmp277_;
					dReal* _tmp278_;
					gint _tmp278__length1;
					dReal _tmp279_;
					GLfloat* _tmp280_;
					gint _tmp280__length1;
					gint _tmp281_;
					GLfloat _tmp282_;
					dReal* _tmp283_;
					gint _tmp283__length1;
					dReal _tmp284_;
					GLfloat* _tmp285_;
					gint _tmp285__length1;
					gint _tmp286_;
					GLfloat _tmp287_;
					dReal* _tmp288_;
					gint _tmp288__length1;
					dReal _tmp289_;
					GLfloat* _tmp290_;
					gint _tmp290__length1;
					gint _tmp291_;
					GLfloat _tmp292_;
					GLfloat _tmp293_;
					_tmp149_ = _tmp148_;
					if (!_tmp149_) {
						gint _tmp150_;
						_tmp150_ = i;
						i = _tmp150_ + 1;
					}
					_tmp148_ = FALSE;
					_tmp151_ = vertices;
					_tmp151__length1 = vertices_length1;
					if (!(i <= ((_tmp151__length1 / 14) - 1))) {
						break;
					}
					_tmp152_ = _vert_light_pos;
					_tmp152__length1 = _vert_light_pos_length1;
					_tmp153_ = _model_light_pos;
					_tmp153__length1 = _model_light_pos_length1;
					_tmp154_ = _tmp153_[0];
					_tmp155_ = vertices;
					_tmp155__length1 = vertices_length1;
					_tmp156_ = i;
					_tmp157_ = _tmp155_[_tmp156_ * 11];
					_tmp152_[0] = _tmp154_ - _tmp157_;
					_tmp158_ = _tmp152_[0];
					_tmp159_ = _vert_light_pos;
					_tmp159__length1 = _vert_light_pos_length1;
					_tmp160_ = _model_light_pos;
					_tmp160__length1 = _model_light_pos_length1;
					_tmp161_ = _tmp160_[1];
					_tmp162_ = vertices;
					_tmp162__length1 = vertices_length1;
					_tmp163_ = i;
					_tmp164_ = _tmp162_[(_tmp163_ * 11) + 1];
					_tmp159_[1] = _tmp161_ - _tmp164_;
					_tmp165_ = _tmp159_[1];
					_tmp166_ = _vert_light_pos;
					_tmp166__length1 = _vert_light_pos_length1;
					_tmp167_ = _model_light_pos;
					_tmp167__length1 = _model_light_pos_length1;
					_tmp168_ = _tmp167_[2];
					_tmp169_ = vertices;
					_tmp169__length1 = vertices_length1;
					_tmp170_ = i;
					_tmp171_ = _tmp169_[(_tmp170_ * 11) + 2];
					_tmp166_[2] = _tmp168_ - _tmp171_;
					_tmp172_ = _tmp166_[2];
					_tmp173_ = _vert_light_pos;
					_tmp173__length1 = _vert_light_pos_length1;
					_tmp174_ = _tmp173_[0];
					_tmp175_ = _vert_light_pos;
					_tmp175__length1 = _vert_light_pos_length1;
					_tmp176_ = _tmp175_[0];
					_tmp177_ = _vert_light_pos;
					_tmp177__length1 = _vert_light_pos_length1;
					_tmp178_ = _tmp177_[1];
					_tmp179_ = _vert_light_pos;
					_tmp179__length1 = _vert_light_pos_length1;
					_tmp180_ = _tmp179_[1];
					_tmp181_ = _vert_light_pos;
					_tmp181__length1 = _vert_light_pos_length1;
					_tmp182_ = _tmp181_[2];
					_tmp183_ = _vert_light_pos;
					_tmp183__length1 = _vert_light_pos_length1;
					_tmp184_ = _tmp183_[2];
					_tmp185_ = sqrtf ((gfloat) (((_tmp174_ * _tmp176_) + (_tmp178_ * _tmp180_)) + (_tmp182_ * _tmp184_)));
					_lgt = _tmp185_;
					_tmp186_ = _vert_light_pos;
					_tmp186__length1 = _vert_light_pos_length1;
					_tmp187_ = _vert_light_pos;
					_tmp187__length1 = _vert_light_pos_length1;
					_tmp188_ = _tmp187_[0];
					_tmp189_ = _lgt;
					_tmp186_[0] = _tmp188_ / _tmp189_;
					_tmp190_ = _tmp186_[0];
					_tmp191_ = _vert_light_pos;
					_tmp191__length1 = _vert_light_pos_length1;
					_tmp192_ = _vert_light_pos;
					_tmp192__length1 = _vert_light_pos_length1;
					_tmp193_ = _tmp192_[1];
					_tmp194_ = _lgt;
					_tmp191_[1] = _tmp193_ / _tmp194_;
					_tmp195_ = _tmp191_[1];
					_tmp196_ = _vert_light_pos;
					_tmp196__length1 = _vert_light_pos_length1;
					_tmp197_ = _vert_light_pos;
					_tmp197__length1 = _vert_light_pos_length1;
					_tmp198_ = _tmp197_[2];
					_tmp199_ = _lgt;
					_tmp196_[2] = _tmp198_ / _tmp199_;
					_tmp200_ = _tmp196_[2];
					_tmp201_ = _binormal;
					_tmp201__length1 = _binormal_length1;
					_tmp202_ = vertices;
					_tmp202__length1 = vertices_length1;
					_tmp203_ = i;
					_tmp204_ = _tmp202_[(_tmp203_ * 11) + 9];
					_tmp205_ = vertices;
					_tmp205__length1 = vertices_length1;
					_tmp206_ = i;
					_tmp207_ = _tmp205_[(_tmp206_ * 11) + 5];
					_tmp208_ = vertices;
					_tmp208__length1 = vertices_length1;
					_tmp209_ = i;
					_tmp210_ = _tmp208_[(_tmp209_ * 11) + 10];
					_tmp211_ = vertices;
					_tmp211__length1 = vertices_length1;
					_tmp212_ = i;
					_tmp213_ = _tmp211_[(_tmp212_ * 11) + 4];
					_tmp201_[0] = (dReal) ((_tmp204_ * _tmp207_) - (_tmp210_ * _tmp213_));
					_tmp214_ = _tmp201_[0];
					_tmp215_ = _binormal;
					_tmp215__length1 = _binormal_length1;
					_tmp216_ = vertices;
					_tmp216__length1 = vertices_length1;
					_tmp217_ = i;
					_tmp218_ = _tmp216_[(_tmp217_ * 11) + 10];
					_tmp219_ = vertices;
					_tmp219__length1 = vertices_length1;
					_tmp220_ = i;
					_tmp221_ = _tmp219_[(_tmp220_ * 11) + 3];
					_tmp222_ = vertices;
					_tmp222__length1 = vertices_length1;
					_tmp223_ = i;
					_tmp224_ = _tmp222_[(_tmp223_ * 11) + 8];
					_tmp225_ = vertices;
					_tmp225__length1 = vertices_length1;
					_tmp226_ = i;
					_tmp227_ = _tmp225_[(_tmp226_ * 11) + 5];
					_tmp215_[1] = (dReal) ((_tmp218_ * _tmp221_) - (_tmp224_ * _tmp227_));
					_tmp228_ = _tmp215_[1];
					_tmp229_ = _binormal;
					_tmp229__length1 = _binormal_length1;
					_tmp230_ = vertices;
					_tmp230__length1 = vertices_length1;
					_tmp231_ = i;
					_tmp232_ = _tmp230_[(_tmp231_ * 11) + 8];
					_tmp233_ = vertices;
					_tmp233__length1 = vertices_length1;
					_tmp234_ = i;
					_tmp235_ = _tmp233_[(_tmp234_ * 11) + 4];
					_tmp236_ = vertices;
					_tmp236__length1 = vertices_length1;
					_tmp237_ = i;
					_tmp238_ = _tmp236_[(_tmp237_ * 11) + 9];
					_tmp239_ = vertices;
					_tmp239__length1 = vertices_length1;
					_tmp240_ = i;
					_tmp241_ = _tmp239_[(_tmp240_ * 11) + 3];
					_tmp229_[2] = (dReal) ((_tmp232_ * _tmp235_) - (_tmp238_ * _tmp241_));
					_tmp242_ = _tmp229_[2];
					_tmp243_ = self->tslvs;
					_tmp243__length1 = self->tslvs_length1;
					_tmp244_ = i;
					_tmp245_ = _vert_light_pos;
					_tmp245__length1 = _vert_light_pos_length1;
					_tmp246_ = _tmp245_[0];
					_tmp247_ = vertices;
					_tmp247__length1 = vertices_length1;
					_tmp248_ = i;
					_tmp249_ = _tmp247_[(_tmp248_ * 11) + 8];
					_tmp250_ = _vert_light_pos;
					_tmp250__length1 = _vert_light_pos_length1;
					_tmp251_ = _tmp250_[1];
					_tmp252_ = vertices;
					_tmp252__length1 = vertices_length1;
					_tmp253_ = i;
					_tmp254_ = _tmp252_[(_tmp253_ * 11) + 9];
					_tmp255_ = _vert_light_pos;
					_tmp255__length1 = _vert_light_pos_length1;
					_tmp256_ = _tmp255_[2];
					_tmp257_ = vertices;
					_tmp257__length1 = vertices_length1;
					_tmp258_ = i;
					_tmp259_ = _tmp257_[(_tmp258_ * 11) + 10];
					_tmp243_[_tmp244_ * 3] = (GLfloat) (((_tmp246_ * _tmp249_) + (_tmp251_ * _tmp254_)) + (_tmp256_ * _tmp259_));
					_tmp260_ = _tmp243_[_tmp244_ * 3];
					_tmp261_ = self->tslvs;
					_tmp261__length1 = self->tslvs_length1;
					_tmp262_ = i;
					_tmp263_ = _vert_light_pos;
					_tmp263__length1 = _vert_light_pos_length1;
					_tmp264_ = _tmp263_[0];
					_tmp265_ = _binormal;
					_tmp265__length1 = _binormal_length1;
					_tmp266_ = _tmp265_[0];
					_tmp267_ = _vert_light_pos;
					_tmp267__length1 = _vert_light_pos_length1;
					_tmp268_ = _tmp267_[1];
					_tmp269_ = _binormal;
					_tmp269__length1 = _binormal_length1;
					_tmp270_ = _tmp269_[1];
					_tmp271_ = _vert_light_pos;
					_tmp271__length1 = _vert_light_pos_length1;
					_tmp272_ = _tmp271_[2];
					_tmp273_ = _binormal;
					_tmp273__length1 = _binormal_length1;
					_tmp274_ = _tmp273_[2];
					_tmp261_[(_tmp262_ * 3) + 1] = (GLfloat) (((_tmp264_ * _tmp266_) + (_tmp268_ * _tmp270_)) + (_tmp272_ * _tmp274_));
					_tmp275_ = _tmp261_[(_tmp262_ * 3) + 1];
					_tmp276_ = self->tslvs;
					_tmp276__length1 = self->tslvs_length1;
					_tmp277_ = i;
					_tmp278_ = _vert_light_pos;
					_tmp278__length1 = _vert_light_pos_length1;
					_tmp279_ = _tmp278_[0];
					_tmp280_ = vertices;
					_tmp280__length1 = vertices_length1;
					_tmp281_ = i;
					_tmp282_ = _tmp280_[(_tmp281_ * 11) + 3];
					_tmp283_ = _vert_light_pos;
					_tmp283__length1 = _vert_light_pos_length1;
					_tmp284_ = _tmp283_[1];
					_tmp285_ = vertices;
					_tmp285__length1 = vertices_length1;
					_tmp286_ = i;
					_tmp287_ = _tmp285_[(_tmp286_ * 11) + 4];
					_tmp288_ = _vert_light_pos;
					_tmp288__length1 = _vert_light_pos_length1;
					_tmp289_ = _tmp288_[2];
					_tmp290_ = vertices;
					_tmp290__length1 = vertices_length1;
					_tmp291_ = i;
					_tmp292_ = _tmp290_[(_tmp291_ * 11) + 5];
					_tmp276_[(_tmp277_ * 3) + 2] = (GLfloat) (((_tmp279_ * _tmp282_) + (_tmp284_ * _tmp287_)) + (_tmp289_ * _tmp292_));
					_tmp293_ = _tmp276_[(_tmp277_ * 3) + 2];
				}
			}
		}
		_dvector3_free0 (dummy);
		_g_object_unref0 (position);
		rotation = (g_free (rotation), NULL);
		_binormal = (g_free (_binormal), NULL);
		_vert_light_pos = (g_free (_vert_light_pos), NULL);
		_model_light_pos = (g_free (_model_light_pos), NULL);
		_inv_mm = (g_free (_inv_mm), NULL);
	}
}


static void _soy_scenes_scene_ambient_set (soyscenesScene* self, soyatomsColor* color) {
	soyatomsColor* _tmp0_;
	gint _tmp1_ = 0;
	gfloat* _tmp2_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (color != NULL);
	_tmp0_ = color;
	_tmp2_ = soy_atoms_color_get4f (_tmp0_, &_tmp1_);
	self->priv->_ambient = (g_free (self->priv->_ambient), NULL);
	self->priv->_ambient = _tmp2_;
	self->priv->_ambient_length1 = _tmp1_;
	self->priv->__ambient_size_ = self->priv->_ambient_length1;
}


static void _soy_scenes_scene_ambient_weak (soyscenesScene* self, GObject* ambient) {
	g_return_if_fail (self != NULL);
	g_return_if_fail (ambient != NULL);
	self->priv->_ambient_obj = NULL;
}


static void _soy_scenes_scene_fog_set (soyscenesScene* self, soyatomsColor* color) {
	soyatomsColor* _tmp0_;
	gint _tmp1_ = 0;
	gfloat* _tmp2_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (color != NULL);
	_tmp0_ = color;
	_tmp2_ = soy_atoms_color_get4f (_tmp0_, &_tmp1_);
	self->priv->_fog = (g_free (self->priv->_fog), NULL);
	self->priv->_fog = _tmp2_;
	self->priv->_fog_length1 = _tmp1_;
	self->priv->__fog_size_ = self->priv->_fog_length1;
}


static void _soy_scenes_scene_fog_weak (soyscenesScene* self, GObject* ambient) {
	g_return_if_fail (self != NULL);
	g_return_if_fail (ambient != NULL);
	self->priv->_fog_obj = NULL;
}


guint64 soy_scenes_scene_get_time (soyscenesScene* self) {
	guint64 result;
	guint64 _tmp0_;
	g_return_val_if_fail (self != NULL, 0ULL);
	_tmp0_ = self->priv->_time;
	result = _tmp0_;
	return result;
}


static void __soy_scenes_scene_ambient_set_soy_atoms_color_on_set (soyatomsColor* _sender, soyatomsColor* color, gpointer self) {
	_soy_scenes_scene_ambient_set (self, color);
}


static void __soy_scenes_scene_ambient_weak_gweak_notify (gpointer self, GObject* object) {
	_soy_scenes_scene_ambient_weak (self, object);
}


soyatomsColor* soy_scenes_scene_get_ambient (soyscenesScene* self) {
	soyatomsColor* result;
	soyatomsColor* _tmp0_;
	soyatomsColor* _tmp1_;
	soyatomsColor* value;
	soyatomsColor* _tmp2_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_ambient_obj;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	value = _tmp1_;
	_tmp2_ = value;
	if (_tmp2_ == NULL) {
		GLfloat* _tmp3_;
		gint _tmp3__length1;
		soyatomsColor* _tmp4_;
		soyatomsColor* _tmp5_;
		soyatomsColor* _tmp6_;
		soyatomsColor* _tmp7_;
		_tmp3_ = self->priv->_ambient;
		_tmp3__length1 = self->priv->_ambient_length1;
		_tmp4_ = soy_atoms_color_new_new4f (_tmp3_, _tmp3__length1);
		_g_object_unref0 (value);
		value = _tmp4_;
		_tmp5_ = value;
		g_signal_connect_object (_tmp5_, "on-set", (GCallback) __soy_scenes_scene_ambient_set_soy_atoms_color_on_set, self, 0);
		_tmp6_ = value;
		g_object_weak_ref ((GObject*) _tmp6_, __soy_scenes_scene_ambient_weak_gweak_notify, self);
		_tmp7_ = value;
		self->priv->_ambient_obj = _tmp7_;
	}
	result = value;
	return result;
}


void soy_scenes_scene_set_ambient (soyscenesScene* self, soyatomsColor* value) {
	soyatomsColor* _tmp0_;
	soyatomsColor* _tmp1_;
	soyatomsColor* _tmp5_;
	soyatomsColor* _tmp6_;
	soyatomsColor* _tmp7_;
	g_return_if_fail (self != NULL);
	_tmp0_ = value;
	_soy_scenes_scene_ambient_set (self, _tmp0_);
	_tmp1_ = self->priv->_ambient_obj;
	if (_tmp1_ != NULL) {
		soyatomsColor* _tmp2_;
		guint _tmp3_ = 0U;
		soyatomsColor* _tmp4_;
		_tmp2_ = self->priv->_ambient_obj;
		g_signal_parse_name ("on-set", SOY_ATOMS_TYPE_COLOR, &_tmp3_, NULL, FALSE);
		g_signal_handlers_disconnect_matched (_tmp2_, G_SIGNAL_MATCH_ID | G_SIGNAL_MATCH_FUNC | G_SIGNAL_MATCH_DATA, _tmp3_, 0, NULL, (GCallback) __soy_scenes_scene_ambient_set_soy_atoms_color_on_set, self);
		_tmp4_ = self->priv->_ambient_obj;
		g_object_weak_unref ((GObject*) _tmp4_, __soy_scenes_scene_ambient_weak_gweak_notify, self);
	}
	_tmp5_ = value;
	self->priv->_ambient_obj = _tmp5_;
	_tmp6_ = value;
	g_signal_connect_object (_tmp6_, "on-set", (GCallback) __soy_scenes_scene_ambient_set_soy_atoms_color_on_set, self, 0);
	_tmp7_ = value;
	g_object_weak_ref ((GObject*) _tmp7_, __soy_scenes_scene_ambient_weak_gweak_notify, self);
	g_object_notify ((GObject *) self, "ambient");
}


static void __soy_scenes_scene_fog_set_soy_atoms_color_on_set (soyatomsColor* _sender, soyatomsColor* color, gpointer self) {
	_soy_scenes_scene_fog_set (self, color);
}


static void __soy_scenes_scene_fog_weak_gweak_notify (gpointer self, GObject* object) {
	_soy_scenes_scene_fog_weak (self, object);
}


soyatomsColor* soy_scenes_scene_get_fog (soyscenesScene* self) {
	soyatomsColor* result;
	soyatomsColor* _tmp0_;
	soyatomsColor* _tmp1_;
	soyatomsColor* value;
	soyatomsColor* _tmp2_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_fog_obj;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	value = _tmp1_;
	_tmp2_ = value;
	if (_tmp2_ == NULL) {
		GLfloat* _tmp3_;
		gint _tmp3__length1;
		soyatomsColor* _tmp4_;
		soyatomsColor* _tmp5_;
		soyatomsColor* _tmp6_;
		soyatomsColor* _tmp7_;
		_tmp3_ = self->priv->_fog;
		_tmp3__length1 = self->priv->_fog_length1;
		_tmp4_ = soy_atoms_color_new_new4f (_tmp3_, _tmp3__length1);
		_g_object_unref0 (value);
		value = _tmp4_;
		_tmp5_ = value;
		g_signal_connect_object (_tmp5_, "on-set", (GCallback) __soy_scenes_scene_fog_set_soy_atoms_color_on_set, self, 0);
		_tmp6_ = value;
		g_object_weak_ref ((GObject*) _tmp6_, __soy_scenes_scene_fog_weak_gweak_notify, self);
		_tmp7_ = value;
		self->priv->_fog_obj = _tmp7_;
	}
	result = value;
	return result;
}


void soy_scenes_scene_set_fog (soyscenesScene* self, soyatomsColor* value) {
	soyatomsColor* _tmp0_;
	soyatomsColor* _tmp1_;
	soyatomsColor* _tmp5_;
	soyatomsColor* _tmp6_;
	soyatomsColor* _tmp7_;
	g_return_if_fail (self != NULL);
	_tmp0_ = value;
	_soy_scenes_scene_fog_set (self, _tmp0_);
	_tmp1_ = self->priv->_fog_obj;
	if (_tmp1_ != NULL) {
		soyatomsColor* _tmp2_;
		guint _tmp3_ = 0U;
		soyatomsColor* _tmp4_;
		_tmp2_ = self->priv->_fog_obj;
		g_signal_parse_name ("on-set", SOY_ATOMS_TYPE_COLOR, &_tmp3_, NULL, FALSE);
		g_signal_handlers_disconnect_matched (_tmp2_, G_SIGNAL_MATCH_ID | G_SIGNAL_MATCH_FUNC | G_SIGNAL_MATCH_DATA, _tmp3_, 0, NULL, (GCallback) __soy_scenes_scene_fog_set_soy_atoms_color_on_set, self);
		_tmp4_ = self->priv->_fog_obj;
		g_object_weak_unref ((GObject*) _tmp4_, __soy_scenes_scene_fog_weak_gweak_notify, self);
	}
	_tmp5_ = value;
	self->priv->_fog_obj = _tmp5_;
	_tmp6_ = value;
	g_signal_connect_object (_tmp6_, "on-set", (GCallback) __soy_scenes_scene_fog_set_soy_atoms_color_on_set, self, 0);
	_tmp7_ = value;
	g_object_weak_ref ((GObject*) _tmp7_, __soy_scenes_scene_fog_weak_gweak_notify, self);
	g_object_notify ((GObject *) self, "fog");
}


soyatomsVector* soy_scenes_scene_get_gravity (soyscenesScene* self) {
	soyatomsVector* result;
	soyatomsVector* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_gravity;
	result = _tmp0_;
	return result;
}


void soy_scenes_scene_set_gravity (soyscenesScene* self, soyatomsVector* value) {
	soyatomsVector* _tmp0_;
	soyatomsVector* _tmp1_;
	g_return_if_fail (self != NULL);
	g_rw_lock_writer_lock (&soy_scenes__stepLock);
	_tmp0_ = value;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (self->priv->_gravity);
	self->priv->_gravity = _tmp1_;
	g_rw_lock_writer_unlock (&soy_scenes__stepLock);
	g_object_notify ((GObject *) self, "gravity");
}


gulong soy_scenes_scene_get_length (soyscenesScene* self) {
	gulong result;
	GeeHashMap* _tmp0_;
	gint _tmp1_;
	gint _tmp2_;
	g_return_val_if_fail (self != NULL, 0UL);
	_tmp0_ = self->bodies;
	_tmp1_ = gee_abstract_map_get_size ((GeeMap*) _tmp0_);
	_tmp2_ = _tmp1_;
	result = (gulong) _tmp2_;
	return result;
}


soytexturesCubemap* soy_scenes_scene_get_skybox (soyscenesScene* self) {
	soytexturesCubemap* result;
	soytexturesCubemap* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_skybox;
	result = _tmp0_;
	return result;
}


void soy_scenes_scene_set_skybox (soyscenesScene* self, soytexturesCubemap* value) {
	soytexturesCubemap* _tmp0_;
	soytexturesCubemap* _tmp1_;
	g_return_if_fail (self != NULL);
	_tmp0_ = value;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (self->priv->_skybox);
	self->priv->_skybox = _tmp1_;
	self->priv->_skybox_updated = TRUE;
	g_object_notify ((GObject *) self, "skybox");
}


gfloat soy_scenes_scene_get_stepsize (soyscenesScene* self) {
	gfloat result;
	gfloat _tmp0_;
	g_return_val_if_fail (self != NULL, 0.0F);
	_tmp0_ = self->priv->_stepsize;
	result = _tmp0_;
	return result;
}


void soy_scenes_scene_set_stepsize (soyscenesScene* self, gfloat value) {
	gfloat _tmp0_;
	g_return_if_fail (self != NULL);
	_tmp0_ = value;
	self->priv->_stepsize = _tmp0_;
	g_object_notify ((GObject *) self, "stepsize");
}


GLfloat* soy_scenes_scene_get_rotation (soyscenesScene* self, int* result_length1) {
	GLfloat* result;
	GLfloat* _tmp0_;
	gint _tmp0__length1;
	GLfloat* _tmp1_;
	gint _tmp1__length1;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_rotation;
	_tmp0__length1 = self->priv->_rotation_length1;
	_tmp1_ = _tmp0_;
	_tmp1__length1 = _tmp0__length1;
	if (result_length1) {
		*result_length1 = _tmp1__length1;
	}
	result = _tmp1_;
	return result;
}


static GLfloat* _vala_array_dup10 (GLfloat* self, int length) {
	return g_memdup (self, length * sizeof (GLfloat));
}


void soy_scenes_scene_set_rotation (soyscenesScene* self, GLfloat* value, int value_length1) {
	GLfloat* _tmp0_;
	gint _tmp0__length1;
	GLfloat* _tmp1_;
	gint _tmp1__length1;
	g_return_if_fail (self != NULL);
	g_rw_lock_writer_lock (&soy_scenes__stepLock);
	_tmp0_ = value;
	_tmp0__length1 = value_length1;
	_tmp1_ = (_tmp0_ != NULL) ? _vala_array_dup10 (_tmp0_, _tmp0__length1) : ((gpointer) _tmp0_);
	_tmp1__length1 = _tmp0__length1;
	self->priv->_rotation = (g_free (self->priv->_rotation), NULL);
	self->priv->_rotation = _tmp1_;
	self->priv->_rotation_length1 = _tmp1__length1;
	self->priv->__rotation_size_ = self->priv->_rotation_length1;
	g_rw_lock_writer_unlock (&soy_scenes__stepLock);
}


soyatomsPosition* soy_scenes_scene_get_position (soyscenesScene* self) {
	soyatomsPosition* result;
	soyatomsPosition* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_position;
	result = _tmp0_;
	return result;
}


void soy_scenes_scene_set_position (soyscenesScene* self, soyatomsPosition* value) {
	soyatomsPosition* _tmp0_;
	soyatomsPosition* _tmp1_;
	g_return_if_fail (self != NULL);
	g_rw_lock_writer_lock (&soy_scenes__stepLock);
	_tmp0_ = value;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (self->priv->_position);
	self->priv->_position = _tmp1_;
	g_rw_lock_writer_unlock (&soy_scenes__stepLock);
	g_object_notify ((GObject *) self, "position");
}


static void soy_scenes_scene_class_init (soyscenesSceneClass * klass) {
	soyscenes_PhysicsThread* _tmp0_;
	soy_scenes_scene_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (soyscenesScenePrivate));
	SOY_SCENES_SCENE_CLASS (klass)->do_in_step = soy_scenes_scene_real_do_in_step;
	SOY_SCENES_SCENE_CLASS (klass)->render = soy_scenes_scene_real_render;
	SOY_SCENES_SCENE_CLASS (klass)->render_extra = soy_scenes_scene_real_render_extra;
	G_OBJECT_CLASS (klass)->get_property = _vala_soy_scenes_scene_get_property;
	G_OBJECT_CLASS (klass)->set_property = _vala_soy_scenes_scene_set_property;
	G_OBJECT_CLASS (klass)->finalize = soy_scenes_scene_finalize;
	g_object_class_install_property (G_OBJECT_CLASS (klass), SOY_SCENES_SCENE_TIME, g_param_spec_uint64 ("time", "time", "time", 0, G_MAXUINT64, 0U, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), SOY_SCENES_SCENE_AMBIENT, g_param_spec_object ("ambient", "ambient", "ambient", SOY_ATOMS_TYPE_COLOR, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), SOY_SCENES_SCENE_FOG, g_param_spec_object ("fog", "fog", "fog", SOY_ATOMS_TYPE_COLOR, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), SOY_SCENES_SCENE_GRAVITY, g_param_spec_object ("gravity", "gravity", "gravity", SOY_ATOMS_TYPE_VECTOR, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), SOY_SCENES_SCENE_LENGTH, g_param_spec_ulong ("length", "length", "length", 0, G_MAXULONG, 0UL, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), SOY_SCENES_SCENE_SKYBOX, g_param_spec_object ("skybox", "skybox", "skybox", SOY_TEXTURES_TYPE_CUBEMAP, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), SOY_SCENES_SCENE_STEPSIZE, g_param_spec_float ("stepsize", "stepsize", "stepsize", -G_MAXFLOAT, G_MAXFLOAT, 0.0F, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), SOY_SCENES_SCENE_POSITION, g_param_spec_object ("position", "position", "position", SOY_ATOMS_TYPE_POSITION, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	_tmp0_ = soy_scenes__thread;
	if (_tmp0_ == NULL) {
		soyscenes_PhysicsThread* _tmp1_;
		_tmp1_ = soy_scenes__physicsthread_new ();
		_g_object_unref0 (soy_scenes__thread);
		soy_scenes__thread = _tmp1_;
	}
}


static void soy_scenes_scene_instance_init (soyscenesScene * self) {
	self->priv = SOY_SCENES_SCENE_GET_PRIVATE (self);
}


static void soy_scenes_scene_finalize (GObject* obj) {
	soyscenesScene * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, SOY_SCENES_TYPE_SCENE, soyscenesScene);
	_dSpaceDestroy0 (self->space);
	_dJointGroupDestroy0 (self->priv->_contactGroup);
	_g_object_unref0 (self->lights);
	_g_object_unref0 (self->bodies);
	_g_object_unref0 (self->joints);
	_g_object_unref0 (self->Controllers);
	_g_object_unref0 (self->fields);
	_g_object_unref0 (self->priv->_callFields);
	_g_object_unref0 (self->priv->_giveFields);
	_g_object_unref0 (self->priv->_skybox);
	self->tslvs = (g_free (self->tslvs), NULL);
	self->priv->_ambient = (g_free (self->priv->_ambient), NULL);
	self->priv->_fog = (g_free (self->priv->_fog), NULL);
	_g_object_unref0 (self->priv->_gravity);
	self->priv->_rotation = (g_free (self->priv->_rotation), NULL);
	_g_object_unref0 (self->priv->_position);
	G_OBJECT_CLASS (soy_scenes_scene_parent_class)->finalize (obj);
}


GType soy_scenes_scene_get_type (void) {
	static volatile gsize soy_scenes_scene_type_id__volatile = 0;
	if (g_once_init_enter (&soy_scenes_scene_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (soyscenesSceneClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) soy_scenes_scene_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (soyscenesScene), 0, (GInstanceInitFunc) soy_scenes_scene_instance_init, NULL };
		GType soy_scenes_scene_type_id;
		soy_scenes_scene_type_id = g_type_register_static (G_TYPE_OBJECT, "soyscenesScene", &g_define_type_info, 0);
		g_once_init_leave (&soy_scenes_scene_type_id__volatile, soy_scenes_scene_type_id);
	}
	return soy_scenes_scene_type_id__volatile;
}


static void _vala_soy_scenes_scene_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec) {
	soyscenesScene * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, SOY_SCENES_TYPE_SCENE, soyscenesScene);
	switch (property_id) {
		case SOY_SCENES_SCENE_TIME:
		g_value_set_uint64 (value, soy_scenes_scene_get_time (self));
		break;
		case SOY_SCENES_SCENE_AMBIENT:
		g_value_take_object (value, soy_scenes_scene_get_ambient (self));
		break;
		case SOY_SCENES_SCENE_FOG:
		g_value_take_object (value, soy_scenes_scene_get_fog (self));
		break;
		case SOY_SCENES_SCENE_GRAVITY:
		g_value_set_object (value, soy_scenes_scene_get_gravity (self));
		break;
		case SOY_SCENES_SCENE_LENGTH:
		g_value_set_ulong (value, soy_scenes_scene_get_length (self));
		break;
		case SOY_SCENES_SCENE_SKYBOX:
		g_value_set_object (value, soy_scenes_scene_get_skybox (self));
		break;
		case SOY_SCENES_SCENE_STEPSIZE:
		g_value_set_float (value, soy_scenes_scene_get_stepsize (self));
		break;
		case SOY_SCENES_SCENE_POSITION:
		g_value_set_object (value, soy_scenes_scene_get_position (self));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}


static void _vala_soy_scenes_scene_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec) {
	soyscenesScene * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, SOY_SCENES_TYPE_SCENE, soyscenesScene);
	switch (property_id) {
		case SOY_SCENES_SCENE_AMBIENT:
		soy_scenes_scene_set_ambient (self, g_value_get_object (value));
		break;
		case SOY_SCENES_SCENE_FOG:
		soy_scenes_scene_set_fog (self, g_value_get_object (value));
		break;
		case SOY_SCENES_SCENE_GRAVITY:
		soy_scenes_scene_set_gravity (self, g_value_get_object (value));
		break;
		case SOY_SCENES_SCENE_SKYBOX:
		soy_scenes_scene_set_skybox (self, g_value_get_object (value));
		break;
		case SOY_SCENES_SCENE_STEPSIZE:
		soy_scenes_scene_set_stepsize (self, g_value_get_float (value));
		break;
		case SOY_SCENES_SCENE_POSITION:
		soy_scenes_scene_set_position (self, g_value_get_object (value));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}


static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	if ((array != NULL) && (destroy_func != NULL)) {
		int i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}


static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}



