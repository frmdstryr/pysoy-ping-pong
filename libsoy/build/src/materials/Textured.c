/* Textured.c generated by valac 0.20.1, the Vala compiler
 * generated from Textured.gs, do not modify */

/*
 *  libsoy - soy.materials.Textured
 *  Copyright (C) 2006,2007,2008,2009,2010,2011,2012,2013 Copyleft Games Group
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU Affero General Public License as published
 *  by the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU Affero General Public License for more details.
 *
 *  You should have received a copy of the GNU Affero General Public License
 *  along with this program; if not, see http://www.gnu.org/licenses
 *
 */

#include <glib.h>
#include <glib-object.h>
#include <GLES/gl.h>
#include <GLES/glext.h>
#include <soy-1/ode.h>
#include <stdlib.h>
#include <string.h>
#include <float.h>
#include <math.h>


#define SOY_MATERIALS_TYPE_MATERIAL (soy_materials_material_get_type ())
#define SOY_MATERIALS_MATERIAL(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_MATERIALS_TYPE_MATERIAL, soymaterialsMaterial))
#define SOY_MATERIALS_MATERIAL_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_MATERIALS_TYPE_MATERIAL, soymaterialsMaterialClass))
#define SOY_MATERIALS_IS_MATERIAL(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_MATERIALS_TYPE_MATERIAL))
#define SOY_MATERIALS_IS_MATERIAL_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_MATERIALS_TYPE_MATERIAL))
#define SOY_MATERIALS_MATERIAL_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_MATERIALS_TYPE_MATERIAL, soymaterialsMaterialClass))

typedef struct _soymaterialsMaterial soymaterialsMaterial;
typedef struct _soymaterialsMaterialClass soymaterialsMaterialClass;
typedef struct _soymaterialsMaterialPrivate soymaterialsMaterialPrivate;

#define SOY_MATERIALS_TYPE_COLORED (soy_materials_colored_get_type ())
#define SOY_MATERIALS_COLORED(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_MATERIALS_TYPE_COLORED, soymaterialsColored))
#define SOY_MATERIALS_COLORED_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_MATERIALS_TYPE_COLORED, soymaterialsColoredClass))
#define SOY_MATERIALS_IS_COLORED(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_MATERIALS_TYPE_COLORED))
#define SOY_MATERIALS_IS_COLORED_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_MATERIALS_TYPE_COLORED))
#define SOY_MATERIALS_COLORED_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_MATERIALS_TYPE_COLORED, soymaterialsColoredClass))

typedef struct _soymaterialsColored soymaterialsColored;
typedef struct _soymaterialsColoredClass soymaterialsColoredClass;
typedef struct _soymaterialsColoredPrivate soymaterialsColoredPrivate;

#define SOY_MATERIALS_TYPE_TEXTURED (soy_materials_textured_get_type ())
#define SOY_MATERIALS_TEXTURED(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_MATERIALS_TYPE_TEXTURED, soymaterialsTextured))
#define SOY_MATERIALS_TEXTURED_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_MATERIALS_TYPE_TEXTURED, soymaterialsTexturedClass))
#define SOY_MATERIALS_IS_TEXTURED(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_MATERIALS_TYPE_TEXTURED))
#define SOY_MATERIALS_IS_TEXTURED_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_MATERIALS_TYPE_TEXTURED))
#define SOY_MATERIALS_TEXTURED_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_MATERIALS_TYPE_TEXTURED, soymaterialsTexturedClass))

typedef struct _soymaterialsTextured soymaterialsTextured;
typedef struct _soymaterialsTexturedClass soymaterialsTexturedClass;
typedef struct _soymaterialsTexturedPrivate soymaterialsTexturedPrivate;

#define SOY_TEXTURES_TYPE_TEXTURE (soy_textures_texture_get_type ())
#define SOY_TEXTURES_TEXTURE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_TEXTURES_TYPE_TEXTURE, soytexturesTexture))
#define SOY_TEXTURES_TEXTURE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_TEXTURES_TYPE_TEXTURE, soytexturesTextureClass))
#define SOY_TEXTURES_IS_TEXTURE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_TEXTURES_TYPE_TEXTURE))
#define SOY_TEXTURES_IS_TEXTURE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_TEXTURES_TYPE_TEXTURE))
#define SOY_TEXTURES_TEXTURE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_TEXTURES_TYPE_TEXTURE, soytexturesTextureClass))

typedef struct _soytexturesTexture soytexturesTexture;
typedef struct _soytexturesTextureClass soytexturesTextureClass;

#define SOY_TEXTURES_TYPE_CUBEMAP (soy_textures_cubemap_get_type ())
#define SOY_TEXTURES_CUBEMAP(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SOY_TEXTURES_TYPE_CUBEMAP, soytexturesCubemap))
#define SOY_TEXTURES_CUBEMAP_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SOY_TEXTURES_TYPE_CUBEMAP, soytexturesCubemapClass))
#define SOY_TEXTURES_IS_CUBEMAP(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SOY_TEXTURES_TYPE_CUBEMAP))
#define SOY_TEXTURES_IS_CUBEMAP_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SOY_TEXTURES_TYPE_CUBEMAP))
#define SOY_TEXTURES_CUBEMAP_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SOY_TEXTURES_TYPE_CUBEMAP, soytexturesCubemapClass))

typedef struct _soytexturesCubemap soytexturesCubemap;
typedef struct _soytexturesCubemapClass soytexturesCubemapClass;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
typedef struct _soytexturesTexturePrivate soytexturesTexturePrivate;

struct _soymaterialsMaterial {
	GObject parent_instance;
	soymaterialsMaterialPrivate * priv;
	gboolean needsTSLVs;
	gboolean translucent;
};

struct _soymaterialsMaterialClass {
	GObjectClass parent_class;
	gboolean (*render) (soymaterialsMaterial* self, gint step, GLvoid* tslvs, dxMatrix3* texmatrix);
	GLenum* (*get_draw_mode) (soymaterialsMaterial* self);
};

struct _soymaterialsColored {
	soymaterialsMaterial parent_instance;
	soymaterialsColoredPrivate * priv;
};

struct _soymaterialsColoredClass {
	soymaterialsMaterialClass parent_class;
};

struct _soymaterialsTextured {
	soymaterialsColored parent_instance;
	soymaterialsTexturedPrivate * priv;
};

struct _soymaterialsTexturedClass {
	soymaterialsColoredClass parent_class;
};

struct _soymaterialsTexturedPrivate {
	GMutex _mutex;
	soytexturesTexture* _bumpmap;
	soytexturesTexture* _colormap;
	soytexturesTexture* _glowmap;
};

struct _soytexturesTexture {
	GObject parent_instance;
	soytexturesTexturePrivate * priv;
	gboolean translucent;
	guchar* texels;
	guchar* mipmaps;
	gboolean updated;
};

struct _soytexturesTextureClass {
	GObjectClass parent_class;
	void (*enable) (soytexturesTexture* self);
	void (*disable) (soytexturesTexture* self);
};


static gpointer soy_materials_textured_parent_class = NULL;
static GLenum* soy_materials_textured__ids;
static gint soy_materials_textured__ids_length1;
static GLenum* soy_materials_textured__ids = NULL;
static gint soy_materials_textured__ids_length1 = 0;
static gint _soy_materials_textured__ids_size_ = 0;
static gint soy_materials_textured__max_textures;
static gint soy_materials_textured__max_textures = 0;
static soytexturesCubemap* soy_materials_textured__normalisation_cubemap;
static soytexturesCubemap* soy_materials_textured__normalisation_cubemap = NULL;
static soytexturesTexture* soy_materials_textured__dummy;
static soytexturesTexture* soy_materials_textured__dummy = NULL;

GType soy_materials_material_get_type (void) G_GNUC_CONST;
GType soy_materials_colored_get_type (void) G_GNUC_CONST;
GType soy_materials_textured_get_type (void) G_GNUC_CONST;
GType soy_textures_texture_get_type (void) G_GNUC_CONST;
#define SOY_MATERIALS_TEXTURED_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), SOY_MATERIALS_TYPE_TEXTURED, soymaterialsTexturedPrivate))
enum  {
	SOY_MATERIALS_TEXTURED_DUMMY_PROPERTY,
	SOY_MATERIALS_TEXTURED_BUMPMAP,
	SOY_MATERIALS_TEXTURED_COLORMAP,
	SOY_MATERIALS_TEXTURED_GLOWMAP
};
GType soy_textures_cubemap_get_type (void) G_GNUC_CONST;
soymaterialsTextured* soy_materials_textured_new (const gchar* name, soytexturesTexture* bumpmap, soytexturesTexture* colormap, soytexturesTexture* glowmap);
soymaterialsTextured* soy_materials_textured_construct (GType object_type, const gchar* name, soytexturesTexture* bumpmap, soytexturesTexture* colormap, soytexturesTexture* glowmap);
soymaterialsColored* soy_materials_colored_new (const gchar* name);
soymaterialsColored* soy_materials_colored_construct (GType object_type, const gchar* name);
static gboolean soy_materials_textured_real_render (soymaterialsMaterial* base, gint step, GLvoid* tslvs, dxMatrix3* texmatrix);
void soy_materials_colored_enable_colors (soymaterialsColored* self);
void soy_materials_colored_enable_shades (soymaterialsColored* self);
void soy_materials_textured_enable_bumpmap (soymaterialsTextured* self, gint id, dxMatrix3* texmatrix);
void soy_materials_textured_enable_normalisation_cubemap (soymaterialsTextured* self, gint id, dxMatrix3* texmatrix, GLvoid* tslvs);
void soy_materials_textured_enable_primary_combiner (soymaterialsTextured* self, gint id);
void soy_materials_textured_enable_colormap (soymaterialsTextured* self, gint id, dxMatrix3* texmatrix);
void soy_materials_textured_enable_glowmap (soymaterialsTextured* self, gint id, dxMatrix3* texmatrix);
void soy_materials_textured_disable_texture (gint id, dxMatrix3* texmatrix, soytexturesTexture* texture);
void soy_textures_texture_disable (soytexturesTexture* self);
void soy_textures_texture_enable (soytexturesTexture* self);
soytexturesTexture* soy_materials_textured_get_bumpmap (soymaterialsTextured* self);
void soy_materials_textured_set_bumpmap (soymaterialsTextured* self, soytexturesTexture* value);
soytexturesTexture* soy_materials_textured_get_colormap (soymaterialsTextured* self);
void soy_materials_textured_set_colormap (soymaterialsTextured* self, soytexturesTexture* value);
soytexturesTexture* soy_materials_textured_get_glowmap (soymaterialsTextured* self);
void soy_materials_textured_set_glowmap (soymaterialsTextured* self, soytexturesTexture* value);
static GObject * soy_materials_textured_constructor (GType type, guint n_construct_properties, GObjectConstructParam * construct_properties);
soytexturesCubemap* soy_textures_cubemap_new (void);
soytexturesCubemap* soy_textures_cubemap_construct (GType object_type);
soytexturesTexture* soy_textures_texture_new (void);
soytexturesTexture* soy_textures_texture_construct (GType object_type);
void soy_textures_cubemap_set_up (soytexturesCubemap* self, soytexturesTexture* value);
void soy_textures_cubemap_set_down (soytexturesCubemap* self, soytexturesTexture* value);
void soy_textures_cubemap_set_left (soytexturesCubemap* self, soytexturesTexture* value);
void soy_textures_cubemap_set_right (soytexturesCubemap* self, soytexturesTexture* value);
void soy_textures_cubemap_set_front (soytexturesCubemap* self, soytexturesTexture* value);
void soy_textures_cubemap_set_back (soytexturesCubemap* self, soytexturesTexture* value);
soytexturesTexture* soy_textures_cubemap_get_up (soytexturesCubemap* self);
void soy_textures_texture_resize (soytexturesTexture* self, gint c, gint x, gint y);
soytexturesTexture* soy_textures_cubemap_get_down (soytexturesCubemap* self);
soytexturesTexture* soy_textures_cubemap_get_left (soytexturesCubemap* self);
soytexturesTexture* soy_textures_cubemap_get_right (soytexturesCubemap* self);
soytexturesTexture* soy_textures_cubemap_get_front (soytexturesCubemap* self);
soytexturesTexture* soy_textures_cubemap_get_back (soytexturesCubemap* self);
static void soy_materials_textured_finalize (GObject* obj);
static void _vala_soy_materials_textured_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec);
static void _vala_soy_materials_textured_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec);
static void _vala_clear_GMutex (GMutex * mutex);
static void _vala_clear_GRecMutex (GRecMutex * mutex);
static void _vala_clear_GRWLock (GRWLock * mutex);
static void _vala_clear_GCond (GCond * mutex);


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


soymaterialsTextured* soy_materials_textured_construct (GType object_type, const gchar* name, soytexturesTexture* bumpmap, soytexturesTexture* colormap, soytexturesTexture* glowmap) {
	soymaterialsTextured * self = NULL;
	const gchar* _tmp0_;
	soytexturesTexture* _tmp1_;
	soytexturesTexture* _tmp2_;
	soytexturesTexture* _tmp3_;
	soytexturesTexture* _tmp4_;
	soytexturesTexture* _tmp5_;
	soytexturesTexture* _tmp6_;
	soytexturesTexture* _tmp7_;
	soytexturesTexture* _tmp8_;
	_tmp0_ = name;
	self = (soymaterialsTextured*) soy_materials_colored_construct (object_type, _tmp0_);
	_tmp1_ = bumpmap;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (self->priv->_bumpmap);
	self->priv->_bumpmap = _tmp2_;
	_tmp3_ = bumpmap;
	if (_tmp3_ == NULL) {
		((soymaterialsMaterial*) self)->needsTSLVs = FALSE;
	} else {
		((soymaterialsMaterial*) self)->needsTSLVs = TRUE;
	}
	_tmp4_ = colormap;
	_tmp5_ = _g_object_ref0 (_tmp4_);
	_g_object_unref0 (self->priv->_colormap);
	self->priv->_colormap = _tmp5_;
	_tmp6_ = glowmap;
	_tmp7_ = _g_object_ref0 (_tmp6_);
	_g_object_unref0 (self->priv->_glowmap);
	self->priv->_glowmap = _tmp7_;
	_tmp8_ = self->priv->_colormap;
	if (_tmp8_ != NULL) {
		soytexturesTexture* _tmp9_;
		gboolean _tmp10_;
		_tmp9_ = self->priv->_colormap;
		_tmp10_ = _tmp9_->translucent;
		((soymaterialsMaterial*) self)->translucent = _tmp10_;
	}
	return self;
}


soymaterialsTextured* soy_materials_textured_new (const gchar* name, soytexturesTexture* bumpmap, soytexturesTexture* colormap, soytexturesTexture* glowmap) {
	return soy_materials_textured_construct (SOY_MATERIALS_TYPE_TEXTURED, name, bumpmap, colormap, glowmap);
}


static gboolean soy_materials_textured_real_render (soymaterialsMaterial* base, gint step, GLvoid* tslvs, dxMatrix3* texmatrix) {
	soymaterialsTextured * self;
	gboolean result = FALSE;
	gint id;
	gint units = 0;
	gint _tmp0_;
	soytexturesTexture* _tmp3_;
	soytexturesTexture* _tmp4_;
	soytexturesTexture* _tmp5_;
	dxMatrix3* _tmp6_;
	gboolean _tmp7_ = FALSE;
	gint _tmp8_;
	gboolean _tmp10_;
	gint _tmp19_;
	gboolean _tmp26_ = FALSE;
	gint _tmp27_;
	gboolean _tmp30_;
	soytexturesTexture* _tmp43_;
	soytexturesTexture* _tmp54_;
	soytexturesTexture* _tmp58_;
	self = (soymaterialsTextured*) base;
	id = 0;
	_tmp0_ = step;
	if (_tmp0_ == 0) {
		gint _tmp1_;
		g_mutex_lock (&self->priv->_mutex);
		_tmp1_ = soy_materials_textured__max_textures;
		if (_tmp1_ == 0) {
			GLint _tmp2_ = 0;
			glGetIntegerv (GL_MAX_TEXTURE_UNITS, &_tmp2_);
			soy_materials_textured__max_textures = (gint) _tmp2_;
		}
		soy_materials_colored_enable_colors ((soymaterialsColored*) self);
		soy_materials_colored_enable_shades ((soymaterialsColored*) self);
	}
	_tmp3_ = self->priv->_bumpmap;
	_tmp4_ = self->priv->_colormap;
	_tmp5_ = self->priv->_glowmap;
	units = ((((gint) (_tmp3_ != NULL)) * 3) + ((gint) (_tmp4_ != NULL))) + ((gint) (_tmp5_ != NULL));
	_tmp6_ = texmatrix;
	if (_tmp6_ != NULL) {
		glMatrixMode (GL_TEXTURE);
	}
	_tmp8_ = step;
	if (_tmp8_ == 0) {
		soytexturesTexture* _tmp9_;
		_tmp9_ = self->priv->_bumpmap;
		_tmp7_ = _tmp9_ != NULL;
	} else {
		_tmp7_ = FALSE;
	}
	_tmp10_ = _tmp7_;
	if (_tmp10_) {
		gint _tmp11_;
		dxMatrix3* _tmp12_;
		gint _tmp13_;
		dxMatrix3* _tmp14_;
		GLvoid* _tmp15_;
		gint _tmp16_;
		gint _tmp17_;
		gint _tmp18_;
		_tmp11_ = id;
		id = _tmp11_ + 1;
		_tmp12_ = texmatrix;
		soy_materials_textured_enable_bumpmap (self, _tmp11_, _tmp12_);
		_tmp13_ = id;
		id = _tmp13_ + 1;
		_tmp14_ = texmatrix;
		_tmp15_ = tslvs;
		soy_materials_textured_enable_normalisation_cubemap (self, _tmp13_, _tmp14_, _tmp15_);
		_tmp16_ = units;
		_tmp17_ = soy_materials_textured__max_textures;
		if (_tmp16_ > _tmp17_) {
			result = TRUE;
			return result;
		}
		_tmp18_ = id;
		id = _tmp18_ + 1;
		soy_materials_textured_enable_primary_combiner (self, _tmp18_);
	}
	_tmp19_ = step;
	if (_tmp19_ == 0) {
		soytexturesTexture* _tmp20_;
		soytexturesTexture* _tmp23_;
		_tmp20_ = self->priv->_colormap;
		if (_tmp20_ != NULL) {
			gint _tmp21_;
			dxMatrix3* _tmp22_;
			_tmp21_ = id;
			id = _tmp21_ + 1;
			_tmp22_ = texmatrix;
			soy_materials_textured_enable_colormap (self, _tmp21_, _tmp22_);
		}
		_tmp23_ = self->priv->_glowmap;
		if (_tmp23_ != NULL) {
			gint _tmp24_;
			dxMatrix3* _tmp25_;
			_tmp24_ = id;
			id = _tmp24_ + 1;
			_tmp25_ = texmatrix;
			soy_materials_textured_enable_glowmap (self, _tmp24_, _tmp25_);
		}
		result = TRUE;
		return result;
	}
	_tmp27_ = step;
	if (_tmp27_ == 1) {
		gint _tmp28_;
		gint _tmp29_;
		_tmp28_ = units;
		_tmp29_ = soy_materials_textured__max_textures;
		_tmp26_ = _tmp28_ > _tmp29_;
	} else {
		_tmp26_ = FALSE;
	}
	_tmp30_ = _tmp26_;
	if (_tmp30_) {
		gint _tmp31_;
		dxMatrix3* _tmp32_;
		soytexturesTexture* _tmp33_;
		gint _tmp34_;
		dxMatrix3* _tmp35_;
		soytexturesCubemap* _tmp36_;
		soytexturesTexture* _tmp37_;
		soytexturesTexture* _tmp40_;
		_tmp31_ = id;
		id = _tmp31_ + 1;
		_tmp32_ = texmatrix;
		_tmp33_ = self->priv->_bumpmap;
		soy_materials_textured_disable_texture (_tmp31_, _tmp32_, _tmp33_);
		_tmp34_ = id;
		id = _tmp34_ + 1;
		_tmp35_ = texmatrix;
		_tmp36_ = soy_materials_textured__normalisation_cubemap;
		soy_materials_textured_disable_texture (_tmp34_, _tmp35_, (soytexturesTexture*) _tmp36_);
		glEnable (GL_BLEND);
		glBlendFunc (GL_DST_COLOR, GL_ZERO);
		glEnable (GL_POLYGON_OFFSET_FILL);
		glPolygonOffset ((GLfloat) 0, (GLfloat) (-2));
		_tmp37_ = self->priv->_colormap;
		if (_tmp37_ != NULL) {
			gint _tmp38_;
			dxMatrix3* _tmp39_;
			_tmp38_ = id;
			id = _tmp38_ + 1;
			_tmp39_ = texmatrix;
			soy_materials_textured_enable_colormap (self, _tmp38_, _tmp39_);
		}
		_tmp40_ = self->priv->_glowmap;
		if (_tmp40_ != NULL) {
			gint _tmp41_;
			dxMatrix3* _tmp42_;
			_tmp41_ = id;
			id = _tmp41_ + 1;
			_tmp42_ = texmatrix;
			soy_materials_textured_enable_glowmap (self, _tmp41_, _tmp42_);
		}
		result = TRUE;
		return result;
	}
	_tmp43_ = self->priv->_bumpmap;
	if (_tmp43_ != NULL) {
		gint _tmp44_;
		gint _tmp45_;
		_tmp44_ = units;
		_tmp45_ = soy_materials_textured__max_textures;
		if (_tmp44_ <= _tmp45_) {
			gint _tmp46_;
			dxMatrix3* _tmp47_;
			soytexturesTexture* _tmp48_;
			gint _tmp49_;
			dxMatrix3* _tmp50_;
			soytexturesCubemap* _tmp51_;
			gint _tmp52_;
			soytexturesTexture* _tmp53_;
			_tmp46_ = id;
			id = _tmp46_ + 1;
			_tmp47_ = texmatrix;
			_tmp48_ = self->priv->_bumpmap;
			soy_materials_textured_disable_texture (_tmp46_, _tmp47_, _tmp48_);
			_tmp49_ = id;
			id = _tmp49_ + 1;
			_tmp50_ = texmatrix;
			_tmp51_ = soy_materials_textured__normalisation_cubemap;
			soy_materials_textured_disable_texture (_tmp49_, _tmp50_, (soytexturesTexture*) _tmp51_);
			_tmp52_ = id;
			id = _tmp52_ + 1;
			glActiveTexture ((GLenum) _tmp52_);
			_tmp53_ = soy_materials_textured__dummy;
			soy_textures_texture_disable (_tmp53_);
		} else {
			glDisable (GL_BLEND);
			glDisable (GL_POLYGON_OFFSET_FILL);
			glPolygonOffset ((GLfloat) 0, (GLfloat) 0);
		}
	}
	_tmp54_ = self->priv->_colormap;
	if (_tmp54_ != NULL) {
		gint _tmp55_;
		dxMatrix3* _tmp56_;
		soytexturesTexture* _tmp57_;
		_tmp55_ = id;
		id = _tmp55_ + 1;
		_tmp56_ = texmatrix;
		_tmp57_ = self->priv->_colormap;
		soy_materials_textured_disable_texture (_tmp55_, _tmp56_, _tmp57_);
	}
	_tmp58_ = self->priv->_glowmap;
	if (_tmp58_ != NULL) {
		gint _tmp59_;
		dxMatrix3* _tmp60_;
		soytexturesTexture* _tmp61_;
		_tmp59_ = id;
		id = _tmp59_ + 1;
		_tmp60_ = texmatrix;
		_tmp61_ = self->priv->_glowmap;
		soy_materials_textured_disable_texture (_tmp59_, _tmp60_, _tmp61_);
	}
	g_mutex_unlock (&self->priv->_mutex);
	result = FALSE;
	return result;
}


void soy_materials_textured_enable_bumpmap (soymaterialsTextured* self, gint id, dxMatrix3* texmatrix) {
	GLenum* _tmp0_;
	gint _tmp0__length1;
	gint _tmp1_;
	GLenum _tmp2_;
	GLenum* _tmp3_;
	gint _tmp3__length1;
	gint _tmp4_;
	GLenum _tmp5_;
	dxMatrix3* _tmp6_;
	soytexturesTexture* _tmp65_;
	soytexturesTexture* _tmp66_;
	g_return_if_fail (self != NULL);
	_tmp0_ = soy_materials_textured__ids;
	_tmp0__length1 = soy_materials_textured__ids_length1;
	_tmp1_ = id;
	_tmp2_ = _tmp0_[_tmp1_];
	glActiveTexture (_tmp2_);
	_tmp3_ = soy_materials_textured__ids;
	_tmp3__length1 = soy_materials_textured__ids_length1;
	_tmp4_ = id;
	_tmp5_ = _tmp3_[_tmp4_];
	glClientActiveTexture (_tmp5_);
	glEnableClientState (GL_TEXTURE_COORD_ARRAY);
	_tmp6_ = texmatrix;
	if (_tmp6_ != NULL) {
		GLfloat* _tmp7_ = NULL;
		GLfloat* _mtx;
		gint _mtx_length1;
		gint __mtx_size_;
		GLfloat* _tmp8_;
		gint _tmp8__length1;
		dxMatrix3* _tmp9_;
		dReal _tmp10_;
		GLfloat _tmp11_;
		GLfloat* _tmp12_;
		gint _tmp12__length1;
		dxMatrix3* _tmp13_;
		dReal _tmp14_;
		GLfloat _tmp15_;
		GLfloat* _tmp16_;
		gint _tmp16__length1;
		dxMatrix3* _tmp17_;
		dReal _tmp18_;
		GLfloat _tmp19_;
		GLfloat* _tmp20_;
		gint _tmp20__length1;
		GLfloat _tmp21_;
		GLfloat* _tmp22_;
		gint _tmp22__length1;
		dxMatrix3* _tmp23_;
		dReal _tmp24_;
		GLfloat _tmp25_;
		GLfloat* _tmp26_;
		gint _tmp26__length1;
		dxMatrix3* _tmp27_;
		dReal _tmp28_;
		GLfloat _tmp29_;
		GLfloat* _tmp30_;
		gint _tmp30__length1;
		dxMatrix3* _tmp31_;
		dReal _tmp32_;
		GLfloat _tmp33_;
		GLfloat* _tmp34_;
		gint _tmp34__length1;
		GLfloat _tmp35_;
		GLfloat* _tmp36_;
		gint _tmp36__length1;
		dxMatrix3* _tmp37_;
		dReal _tmp38_;
		GLfloat _tmp39_;
		GLfloat* _tmp40_;
		gint _tmp40__length1;
		dxMatrix3* _tmp41_;
		dReal _tmp42_;
		GLfloat _tmp43_;
		GLfloat* _tmp44_;
		gint _tmp44__length1;
		dxMatrix3* _tmp45_;
		dReal _tmp46_;
		GLfloat _tmp47_;
		GLfloat* _tmp48_;
		gint _tmp48__length1;
		GLfloat _tmp49_;
		GLfloat* _tmp50_;
		gint _tmp50__length1;
		dxMatrix3* _tmp51_;
		dReal _tmp52_;
		GLfloat _tmp53_;
		GLfloat* _tmp54_;
		gint _tmp54__length1;
		dxMatrix3* _tmp55_;
		dReal _tmp56_;
		GLfloat _tmp57_;
		GLfloat* _tmp58_;
		gint _tmp58__length1;
		dxMatrix3* _tmp59_;
		dReal _tmp60_;
		GLfloat _tmp61_;
		GLfloat* _tmp62_;
		gint _tmp62__length1;
		GLfloat _tmp63_;
		GLfloat* _tmp64_;
		gint _tmp64__length1;
		glPushMatrix ();
		_tmp7_ = g_new0 (GLfloat, 16);
		_mtx = _tmp7_;
		_mtx_length1 = 16;
		__mtx_size_ = _mtx_length1;
		_tmp8_ = _mtx;
		_tmp8__length1 = _mtx_length1;
		_tmp9_ = texmatrix;
		_tmp10_ = _tmp9_->m0;
		_tmp8_[0] = (GLfloat) _tmp10_;
		_tmp11_ = _tmp8_[0];
		_tmp12_ = _mtx;
		_tmp12__length1 = _mtx_length1;
		_tmp13_ = texmatrix;
		_tmp14_ = _tmp13_->m4;
		_tmp12_[1] = (GLfloat) _tmp14_;
		_tmp15_ = _tmp12_[1];
		_tmp16_ = _mtx;
		_tmp16__length1 = _mtx_length1;
		_tmp17_ = texmatrix;
		_tmp18_ = _tmp17_->m8;
		_tmp16_[2] = (GLfloat) _tmp18_;
		_tmp19_ = _tmp16_[2];
		_tmp20_ = _mtx;
		_tmp20__length1 = _mtx_length1;
		_tmp20_[3] = (GLfloat) 0.0;
		_tmp21_ = _tmp20_[3];
		_tmp22_ = _mtx;
		_tmp22__length1 = _mtx_length1;
		_tmp23_ = texmatrix;
		_tmp24_ = _tmp23_->m1;
		_tmp22_[4] = (GLfloat) _tmp24_;
		_tmp25_ = _tmp22_[4];
		_tmp26_ = _mtx;
		_tmp26__length1 = _mtx_length1;
		_tmp27_ = texmatrix;
		_tmp28_ = _tmp27_->m5;
		_tmp26_[5] = (GLfloat) _tmp28_;
		_tmp29_ = _tmp26_[5];
		_tmp30_ = _mtx;
		_tmp30__length1 = _mtx_length1;
		_tmp31_ = texmatrix;
		_tmp32_ = _tmp31_->m9;
		_tmp30_[6] = (GLfloat) _tmp32_;
		_tmp33_ = _tmp30_[6];
		_tmp34_ = _mtx;
		_tmp34__length1 = _mtx_length1;
		_tmp34_[7] = (GLfloat) 0.0;
		_tmp35_ = _tmp34_[7];
		_tmp36_ = _mtx;
		_tmp36__length1 = _mtx_length1;
		_tmp37_ = texmatrix;
		_tmp38_ = _tmp37_->m2;
		_tmp36_[8] = (GLfloat) _tmp38_;
		_tmp39_ = _tmp36_[8];
		_tmp40_ = _mtx;
		_tmp40__length1 = _mtx_length1;
		_tmp41_ = texmatrix;
		_tmp42_ = _tmp41_->m6;
		_tmp40_[9] = (GLfloat) _tmp42_;
		_tmp43_ = _tmp40_[9];
		_tmp44_ = _mtx;
		_tmp44__length1 = _mtx_length1;
		_tmp45_ = texmatrix;
		_tmp46_ = _tmp45_->ma;
		_tmp44_[10] = (GLfloat) _tmp46_;
		_tmp47_ = _tmp44_[10];
		_tmp48_ = _mtx;
		_tmp48__length1 = _mtx_length1;
		_tmp48_[11] = (GLfloat) 0.0;
		_tmp49_ = _tmp48_[11];
		_tmp50_ = _mtx;
		_tmp50__length1 = _mtx_length1;
		_tmp51_ = texmatrix;
		_tmp52_ = _tmp51_->m3;
		_tmp50_[12] = (GLfloat) _tmp52_;
		_tmp53_ = _tmp50_[12];
		_tmp54_ = _mtx;
		_tmp54__length1 = _mtx_length1;
		_tmp55_ = texmatrix;
		_tmp56_ = _tmp55_->m7;
		_tmp54_[13] = (GLfloat) _tmp56_;
		_tmp57_ = _tmp54_[13];
		_tmp58_ = _mtx;
		_tmp58__length1 = _mtx_length1;
		_tmp59_ = texmatrix;
		_tmp60_ = _tmp59_->mb;
		_tmp58_[14] = (GLfloat) _tmp60_;
		_tmp61_ = _tmp58_[14];
		_tmp62_ = _mtx;
		_tmp62__length1 = _mtx_length1;
		_tmp62_[15] = (GLfloat) 1.0;
		_tmp63_ = _tmp62_[15];
		_tmp64_ = _mtx;
		_tmp64__length1 = _mtx_length1;
		glLoadMatrixf (_tmp64_);
		_mtx = (g_free (_mtx), NULL);
	}
	_tmp65_ = self->priv->_bumpmap;
	if (G_TYPE_CHECK_INSTANCE_TYPE (_tmp65_, SOY_TEXTURES_TYPE_CUBEMAP)) {
		glTexCoordPointer ((GLint) 3, GL_FLOAT, (GLsizei) (sizeof (GLfloat) * 11), NULL);
	} else {
		glTexCoordPointer ((GLint) 2, GL_FLOAT, (GLsizei) (sizeof (GLfloat) * 11), (GLvoid*) (sizeof (GLfloat) * 6));
	}
	glTexEnvi (GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, (GLint) GL_COMBINE);
	glTexEnvi (GL_TEXTURE_ENV, GL_SRC0_RGB, (GLint) GL_TEXTURE);
	glTexEnvi (GL_TEXTURE_ENV, GL_COMBINE_RGB, (GLint) GL_REPLACE);
	_tmp66_ = self->priv->_bumpmap;
	soy_textures_texture_enable (_tmp66_);
}


void soy_materials_textured_enable_normalisation_cubemap (soymaterialsTextured* self, gint id, dxMatrix3* texmatrix, GLvoid* tslvs) {
	GLenum* _tmp0_;
	gint _tmp0__length1;
	gint _tmp1_;
	GLenum _tmp2_;
	GLenum* _tmp3_;
	gint _tmp3__length1;
	gint _tmp4_;
	GLenum _tmp5_;
	dxMatrix3* _tmp6_;
	GLvoid* _tmp7_;
	soytexturesCubemap* _tmp8_;
	g_return_if_fail (self != NULL);
	_tmp0_ = soy_materials_textured__ids;
	_tmp0__length1 = soy_materials_textured__ids_length1;
	_tmp1_ = id;
	_tmp2_ = _tmp0_[_tmp1_];
	glActiveTexture (_tmp2_);
	_tmp3_ = soy_materials_textured__ids;
	_tmp3__length1 = soy_materials_textured__ids_length1;
	_tmp4_ = id;
	_tmp5_ = _tmp3_[_tmp4_];
	glClientActiveTexture (_tmp5_);
	glEnableClientState (GL_TEXTURE_COORD_ARRAY);
	_tmp6_ = texmatrix;
	if (_tmp6_ != NULL) {
		glPushMatrix ();
	}
	_tmp7_ = tslvs;
	glTexCoordPointer ((GLint) 3, GL_FLOAT, (GLsizei) 0, _tmp7_);
	_tmp8_ = soy_materials_textured__normalisation_cubemap;
	soy_textures_texture_enable ((soytexturesTexture*) _tmp8_);
	glTexEnvi (GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, (GLint) GL_COMBINE);
	glTexEnvi (GL_TEXTURE_ENV, GL_SRC0_RGB, (GLint) GL_TEXTURE);
	glTexEnvi (GL_TEXTURE_ENV, GL_SRC1_RGB, (GLint) GL_PREVIOUS);
	glTexEnvi (GL_TEXTURE_ENV, GL_COMBINE_RGB, (GLint) GL_DOT3_RGB);
	glTexParameteri (GL_TEXTURE_CUBE_MAP_OES, GL_TEXTURE_MAG_FILTER, (GLint) GL_LINEAR);
	glTexParameteri (GL_TEXTURE_CUBE_MAP_OES, GL_TEXTURE_MIN_FILTER, (GLint) GL_LINEAR);
	glTexParameteri (GL_TEXTURE_CUBE_MAP_OES, GL_TEXTURE_WRAP_S, (GLint) GL_CLAMP_TO_EDGE);
	glTexParameteri (GL_TEXTURE_CUBE_MAP_OES, GL_TEXTURE_WRAP_T, (GLint) GL_CLAMP_TO_EDGE);
}


void soy_materials_textured_enable_primary_combiner (soymaterialsTextured* self, gint id) {
	GLenum* _tmp0_;
	gint _tmp0__length1;
	gint _tmp1_;
	GLenum _tmp2_;
	soytexturesTexture* _tmp3_;
	g_return_if_fail (self != NULL);
	_tmp0_ = soy_materials_textured__ids;
	_tmp0__length1 = soy_materials_textured__ids_length1;
	_tmp1_ = id;
	_tmp2_ = _tmp0_[_tmp1_];
	glActiveTexture (_tmp2_);
	glTexEnvi (GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, (GLint) GL_COMBINE);
	glTexEnvi (GL_TEXTURE_ENV, GL_SRC0_RGB, (GLint) GL_PRIMARY_COLOR);
	glTexEnvi (GL_TEXTURE_ENV, GL_SRC1_RGB, (GLint) GL_PREVIOUS);
	glTexEnvi (GL_TEXTURE_ENV, GL_COMBINE_RGB, (GLint) GL_MODULATE);
	_tmp3_ = soy_materials_textured__dummy;
	soy_textures_texture_enable (_tmp3_);
}


void soy_materials_textured_enable_colormap (soymaterialsTextured* self, gint id, dxMatrix3* texmatrix) {
	GLenum* _tmp0_;
	gint _tmp0__length1;
	gint _tmp1_;
	GLenum _tmp2_;
	GLenum* _tmp3_;
	gint _tmp3__length1;
	gint _tmp4_;
	GLenum _tmp5_;
	dxMatrix3* _tmp6_;
	soytexturesTexture* _tmp65_;
	gboolean _tmp66_;
	soytexturesTexture* _tmp67_;
	soytexturesTexture* _tmp68_;
	gboolean _tmp69_;
	soytexturesTexture* _tmp70_;
	g_return_if_fail (self != NULL);
	_tmp0_ = soy_materials_textured__ids;
	_tmp0__length1 = soy_materials_textured__ids_length1;
	_tmp1_ = id;
	_tmp2_ = _tmp0_[_tmp1_];
	glActiveTexture (_tmp2_);
	_tmp3_ = soy_materials_textured__ids;
	_tmp3__length1 = soy_materials_textured__ids_length1;
	_tmp4_ = id;
	_tmp5_ = _tmp3_[_tmp4_];
	glClientActiveTexture (_tmp5_);
	glEnableClientState (GL_TEXTURE_COORD_ARRAY);
	_tmp6_ = texmatrix;
	if (_tmp6_ != NULL) {
		GLfloat* _tmp7_ = NULL;
		GLfloat* _mtx;
		gint _mtx_length1;
		gint __mtx_size_;
		GLfloat* _tmp8_;
		gint _tmp8__length1;
		dxMatrix3* _tmp9_;
		dReal _tmp10_;
		GLfloat _tmp11_;
		GLfloat* _tmp12_;
		gint _tmp12__length1;
		dxMatrix3* _tmp13_;
		dReal _tmp14_;
		GLfloat _tmp15_;
		GLfloat* _tmp16_;
		gint _tmp16__length1;
		dxMatrix3* _tmp17_;
		dReal _tmp18_;
		GLfloat _tmp19_;
		GLfloat* _tmp20_;
		gint _tmp20__length1;
		GLfloat _tmp21_;
		GLfloat* _tmp22_;
		gint _tmp22__length1;
		dxMatrix3* _tmp23_;
		dReal _tmp24_;
		GLfloat _tmp25_;
		GLfloat* _tmp26_;
		gint _tmp26__length1;
		dxMatrix3* _tmp27_;
		dReal _tmp28_;
		GLfloat _tmp29_;
		GLfloat* _tmp30_;
		gint _tmp30__length1;
		dxMatrix3* _tmp31_;
		dReal _tmp32_;
		GLfloat _tmp33_;
		GLfloat* _tmp34_;
		gint _tmp34__length1;
		GLfloat _tmp35_;
		GLfloat* _tmp36_;
		gint _tmp36__length1;
		dxMatrix3* _tmp37_;
		dReal _tmp38_;
		GLfloat _tmp39_;
		GLfloat* _tmp40_;
		gint _tmp40__length1;
		dxMatrix3* _tmp41_;
		dReal _tmp42_;
		GLfloat _tmp43_;
		GLfloat* _tmp44_;
		gint _tmp44__length1;
		dxMatrix3* _tmp45_;
		dReal _tmp46_;
		GLfloat _tmp47_;
		GLfloat* _tmp48_;
		gint _tmp48__length1;
		GLfloat _tmp49_;
		GLfloat* _tmp50_;
		gint _tmp50__length1;
		dxMatrix3* _tmp51_;
		dReal _tmp52_;
		GLfloat _tmp53_;
		GLfloat* _tmp54_;
		gint _tmp54__length1;
		dxMatrix3* _tmp55_;
		dReal _tmp56_;
		GLfloat _tmp57_;
		GLfloat* _tmp58_;
		gint _tmp58__length1;
		dxMatrix3* _tmp59_;
		dReal _tmp60_;
		GLfloat _tmp61_;
		GLfloat* _tmp62_;
		gint _tmp62__length1;
		GLfloat _tmp63_;
		GLfloat* _tmp64_;
		gint _tmp64__length1;
		glPushMatrix ();
		_tmp7_ = g_new0 (GLfloat, 16);
		_mtx = _tmp7_;
		_mtx_length1 = 16;
		__mtx_size_ = _mtx_length1;
		_tmp8_ = _mtx;
		_tmp8__length1 = _mtx_length1;
		_tmp9_ = texmatrix;
		_tmp10_ = _tmp9_->m0;
		_tmp8_[0] = (GLfloat) _tmp10_;
		_tmp11_ = _tmp8_[0];
		_tmp12_ = _mtx;
		_tmp12__length1 = _mtx_length1;
		_tmp13_ = texmatrix;
		_tmp14_ = _tmp13_->m4;
		_tmp12_[1] = (GLfloat) _tmp14_;
		_tmp15_ = _tmp12_[1];
		_tmp16_ = _mtx;
		_tmp16__length1 = _mtx_length1;
		_tmp17_ = texmatrix;
		_tmp18_ = _tmp17_->m8;
		_tmp16_[2] = (GLfloat) _tmp18_;
		_tmp19_ = _tmp16_[2];
		_tmp20_ = _mtx;
		_tmp20__length1 = _mtx_length1;
		_tmp20_[3] = (GLfloat) 0.0;
		_tmp21_ = _tmp20_[3];
		_tmp22_ = _mtx;
		_tmp22__length1 = _mtx_length1;
		_tmp23_ = texmatrix;
		_tmp24_ = _tmp23_->m1;
		_tmp22_[4] = (GLfloat) _tmp24_;
		_tmp25_ = _tmp22_[4];
		_tmp26_ = _mtx;
		_tmp26__length1 = _mtx_length1;
		_tmp27_ = texmatrix;
		_tmp28_ = _tmp27_->m5;
		_tmp26_[5] = (GLfloat) _tmp28_;
		_tmp29_ = _tmp26_[5];
		_tmp30_ = _mtx;
		_tmp30__length1 = _mtx_length1;
		_tmp31_ = texmatrix;
		_tmp32_ = _tmp31_->m9;
		_tmp30_[6] = (GLfloat) _tmp32_;
		_tmp33_ = _tmp30_[6];
		_tmp34_ = _mtx;
		_tmp34__length1 = _mtx_length1;
		_tmp34_[7] = (GLfloat) 0.0;
		_tmp35_ = _tmp34_[7];
		_tmp36_ = _mtx;
		_tmp36__length1 = _mtx_length1;
		_tmp37_ = texmatrix;
		_tmp38_ = _tmp37_->m2;
		_tmp36_[8] = (GLfloat) _tmp38_;
		_tmp39_ = _tmp36_[8];
		_tmp40_ = _mtx;
		_tmp40__length1 = _mtx_length1;
		_tmp41_ = texmatrix;
		_tmp42_ = _tmp41_->m6;
		_tmp40_[9] = (GLfloat) _tmp42_;
		_tmp43_ = _tmp40_[9];
		_tmp44_ = _mtx;
		_tmp44__length1 = _mtx_length1;
		_tmp45_ = texmatrix;
		_tmp46_ = _tmp45_->ma;
		_tmp44_[10] = (GLfloat) _tmp46_;
		_tmp47_ = _tmp44_[10];
		_tmp48_ = _mtx;
		_tmp48__length1 = _mtx_length1;
		_tmp48_[11] = (GLfloat) 0.0;
		_tmp49_ = _tmp48_[11];
		_tmp50_ = _mtx;
		_tmp50__length1 = _mtx_length1;
		_tmp51_ = texmatrix;
		_tmp52_ = _tmp51_->m3;
		_tmp50_[12] = (GLfloat) _tmp52_;
		_tmp53_ = _tmp50_[12];
		_tmp54_ = _mtx;
		_tmp54__length1 = _mtx_length1;
		_tmp55_ = texmatrix;
		_tmp56_ = _tmp55_->m7;
		_tmp54_[13] = (GLfloat) _tmp56_;
		_tmp57_ = _tmp54_[13];
		_tmp58_ = _mtx;
		_tmp58__length1 = _mtx_length1;
		_tmp59_ = texmatrix;
		_tmp60_ = _tmp59_->mb;
		_tmp58_[14] = (GLfloat) _tmp60_;
		_tmp61_ = _tmp58_[14];
		_tmp62_ = _mtx;
		_tmp62__length1 = _mtx_length1;
		_tmp62_[15] = (GLfloat) 1.0;
		_tmp63_ = _tmp62_[15];
		_tmp64_ = _mtx;
		_tmp64__length1 = _mtx_length1;
		glLoadMatrixf (_tmp64_);
		_mtx = (g_free (_mtx), NULL);
	}
	_tmp65_ = self->priv->_colormap;
	_tmp66_ = _tmp65_->translucent;
	((soymaterialsMaterial*) self)->translucent = _tmp66_;
	_tmp67_ = self->priv->_colormap;
	if (G_TYPE_CHECK_INSTANCE_TYPE (_tmp67_, SOY_TEXTURES_TYPE_CUBEMAP)) {
		glTexCoordPointer ((GLint) 3, GL_FLOAT, (GLsizei) (sizeof (GLfloat) * 11), NULL);
	} else {
		glTexCoordPointer ((GLint) 2, GL_FLOAT, (GLsizei) (sizeof (GLfloat) * 11), (GLvoid*) (sizeof (GLfloat) * 6));
	}
	_tmp68_ = self->priv->_colormap;
	_tmp69_ = _tmp68_->translucent;
	if (_tmp69_) {
		glBlendFunc (GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
		glEnable (GL_BLEND);
	}
	glTexEnvi (GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, (GLint) GL_MODULATE);
	_tmp70_ = self->priv->_colormap;
	soy_textures_texture_enable (_tmp70_);
}


void soy_materials_textured_enable_glowmap (soymaterialsTextured* self, gint id, dxMatrix3* texmatrix) {
	GLenum* _tmp0_;
	gint _tmp0__length1;
	gint _tmp1_;
	GLenum _tmp2_;
	GLenum* _tmp3_;
	gint _tmp3__length1;
	gint _tmp4_;
	GLenum _tmp5_;
	dxMatrix3* _tmp6_;
	soytexturesTexture* _tmp65_;
	soytexturesTexture* _tmp66_;
	g_return_if_fail (self != NULL);
	_tmp0_ = soy_materials_textured__ids;
	_tmp0__length1 = soy_materials_textured__ids_length1;
	_tmp1_ = id;
	_tmp2_ = _tmp0_[_tmp1_];
	glActiveTexture (_tmp2_);
	_tmp3_ = soy_materials_textured__ids;
	_tmp3__length1 = soy_materials_textured__ids_length1;
	_tmp4_ = id;
	_tmp5_ = _tmp3_[_tmp4_];
	glClientActiveTexture (_tmp5_);
	glEnableClientState (GL_TEXTURE_COORD_ARRAY);
	_tmp6_ = texmatrix;
	if (_tmp6_ != NULL) {
		GLfloat* _tmp7_ = NULL;
		GLfloat* _mtx;
		gint _mtx_length1;
		gint __mtx_size_;
		GLfloat* _tmp8_;
		gint _tmp8__length1;
		dxMatrix3* _tmp9_;
		dReal _tmp10_;
		GLfloat _tmp11_;
		GLfloat* _tmp12_;
		gint _tmp12__length1;
		dxMatrix3* _tmp13_;
		dReal _tmp14_;
		GLfloat _tmp15_;
		GLfloat* _tmp16_;
		gint _tmp16__length1;
		dxMatrix3* _tmp17_;
		dReal _tmp18_;
		GLfloat _tmp19_;
		GLfloat* _tmp20_;
		gint _tmp20__length1;
		GLfloat _tmp21_;
		GLfloat* _tmp22_;
		gint _tmp22__length1;
		dxMatrix3* _tmp23_;
		dReal _tmp24_;
		GLfloat _tmp25_;
		GLfloat* _tmp26_;
		gint _tmp26__length1;
		dxMatrix3* _tmp27_;
		dReal _tmp28_;
		GLfloat _tmp29_;
		GLfloat* _tmp30_;
		gint _tmp30__length1;
		dxMatrix3* _tmp31_;
		dReal _tmp32_;
		GLfloat _tmp33_;
		GLfloat* _tmp34_;
		gint _tmp34__length1;
		GLfloat _tmp35_;
		GLfloat* _tmp36_;
		gint _tmp36__length1;
		dxMatrix3* _tmp37_;
		dReal _tmp38_;
		GLfloat _tmp39_;
		GLfloat* _tmp40_;
		gint _tmp40__length1;
		dxMatrix3* _tmp41_;
		dReal _tmp42_;
		GLfloat _tmp43_;
		GLfloat* _tmp44_;
		gint _tmp44__length1;
		dxMatrix3* _tmp45_;
		dReal _tmp46_;
		GLfloat _tmp47_;
		GLfloat* _tmp48_;
		gint _tmp48__length1;
		GLfloat _tmp49_;
		GLfloat* _tmp50_;
		gint _tmp50__length1;
		dxMatrix3* _tmp51_;
		dReal _tmp52_;
		GLfloat _tmp53_;
		GLfloat* _tmp54_;
		gint _tmp54__length1;
		dxMatrix3* _tmp55_;
		dReal _tmp56_;
		GLfloat _tmp57_;
		GLfloat* _tmp58_;
		gint _tmp58__length1;
		dxMatrix3* _tmp59_;
		dReal _tmp60_;
		GLfloat _tmp61_;
		GLfloat* _tmp62_;
		gint _tmp62__length1;
		GLfloat _tmp63_;
		GLfloat* _tmp64_;
		gint _tmp64__length1;
		glPushMatrix ();
		_tmp7_ = g_new0 (GLfloat, 16);
		_mtx = _tmp7_;
		_mtx_length1 = 16;
		__mtx_size_ = _mtx_length1;
		_tmp8_ = _mtx;
		_tmp8__length1 = _mtx_length1;
		_tmp9_ = texmatrix;
		_tmp10_ = _tmp9_->m0;
		_tmp8_[0] = (GLfloat) _tmp10_;
		_tmp11_ = _tmp8_[0];
		_tmp12_ = _mtx;
		_tmp12__length1 = _mtx_length1;
		_tmp13_ = texmatrix;
		_tmp14_ = _tmp13_->m4;
		_tmp12_[1] = (GLfloat) _tmp14_;
		_tmp15_ = _tmp12_[1];
		_tmp16_ = _mtx;
		_tmp16__length1 = _mtx_length1;
		_tmp17_ = texmatrix;
		_tmp18_ = _tmp17_->m8;
		_tmp16_[2] = (GLfloat) _tmp18_;
		_tmp19_ = _tmp16_[2];
		_tmp20_ = _mtx;
		_tmp20__length1 = _mtx_length1;
		_tmp20_[3] = (GLfloat) 0.0;
		_tmp21_ = _tmp20_[3];
		_tmp22_ = _mtx;
		_tmp22__length1 = _mtx_length1;
		_tmp23_ = texmatrix;
		_tmp24_ = _tmp23_->m1;
		_tmp22_[4] = (GLfloat) _tmp24_;
		_tmp25_ = _tmp22_[4];
		_tmp26_ = _mtx;
		_tmp26__length1 = _mtx_length1;
		_tmp27_ = texmatrix;
		_tmp28_ = _tmp27_->m5;
		_tmp26_[5] = (GLfloat) _tmp28_;
		_tmp29_ = _tmp26_[5];
		_tmp30_ = _mtx;
		_tmp30__length1 = _mtx_length1;
		_tmp31_ = texmatrix;
		_tmp32_ = _tmp31_->m9;
		_tmp30_[6] = (GLfloat) _tmp32_;
		_tmp33_ = _tmp30_[6];
		_tmp34_ = _mtx;
		_tmp34__length1 = _mtx_length1;
		_tmp34_[7] = (GLfloat) 0.0;
		_tmp35_ = _tmp34_[7];
		_tmp36_ = _mtx;
		_tmp36__length1 = _mtx_length1;
		_tmp37_ = texmatrix;
		_tmp38_ = _tmp37_->m2;
		_tmp36_[8] = (GLfloat) _tmp38_;
		_tmp39_ = _tmp36_[8];
		_tmp40_ = _mtx;
		_tmp40__length1 = _mtx_length1;
		_tmp41_ = texmatrix;
		_tmp42_ = _tmp41_->m6;
		_tmp40_[9] = (GLfloat) _tmp42_;
		_tmp43_ = _tmp40_[9];
		_tmp44_ = _mtx;
		_tmp44__length1 = _mtx_length1;
		_tmp45_ = texmatrix;
		_tmp46_ = _tmp45_->ma;
		_tmp44_[10] = (GLfloat) _tmp46_;
		_tmp47_ = _tmp44_[10];
		_tmp48_ = _mtx;
		_tmp48__length1 = _mtx_length1;
		_tmp48_[11] = (GLfloat) 0.0;
		_tmp49_ = _tmp48_[11];
		_tmp50_ = _mtx;
		_tmp50__length1 = _mtx_length1;
		_tmp51_ = texmatrix;
		_tmp52_ = _tmp51_->m3;
		_tmp50_[12] = (GLfloat) _tmp52_;
		_tmp53_ = _tmp50_[12];
		_tmp54_ = _mtx;
		_tmp54__length1 = _mtx_length1;
		_tmp55_ = texmatrix;
		_tmp56_ = _tmp55_->m7;
		_tmp54_[13] = (GLfloat) _tmp56_;
		_tmp57_ = _tmp54_[13];
		_tmp58_ = _mtx;
		_tmp58__length1 = _mtx_length1;
		_tmp59_ = texmatrix;
		_tmp60_ = _tmp59_->mb;
		_tmp58_[14] = (GLfloat) _tmp60_;
		_tmp61_ = _tmp58_[14];
		_tmp62_ = _mtx;
		_tmp62__length1 = _mtx_length1;
		_tmp62_[15] = (GLfloat) 1.0;
		_tmp63_ = _tmp62_[15];
		_tmp64_ = _mtx;
		_tmp64__length1 = _mtx_length1;
		glLoadMatrixf (_tmp64_);
		_mtx = (g_free (_mtx), NULL);
	}
	glEnable (GL_BLEND);
	glBlendFunc (GL_ONE, GL_ONE);
	_tmp65_ = self->priv->_glowmap;
	if (G_TYPE_CHECK_INSTANCE_TYPE (_tmp65_, SOY_TEXTURES_TYPE_CUBEMAP)) {
		glTexCoordPointer ((GLint) 3, GL_FLOAT, (GLsizei) (sizeof (GLfloat) * 11), NULL);
	} else {
		glTexCoordPointer ((GLint) 2, GL_FLOAT, (GLsizei) (sizeof (GLfloat) * 11), (GLvoid*) (sizeof (GLfloat) * 6));
	}
	glTexEnvi (GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, (GLint) GL_ADD);
	_tmp66_ = self->priv->_glowmap;
	soy_textures_texture_enable (_tmp66_);
}


void soy_materials_textured_disable_texture (gint id, dxMatrix3* texmatrix, soytexturesTexture* texture) {
	GLenum* _tmp0_;
	gint _tmp0__length1;
	gint _tmp1_;
	GLenum _tmp2_;
	GLenum* _tmp3_;
	gint _tmp3__length1;
	gint _tmp4_;
	GLenum _tmp5_;
	dxMatrix3* _tmp6_;
	soytexturesTexture* _tmp7_;
	g_return_if_fail (texture != NULL);
	_tmp0_ = soy_materials_textured__ids;
	_tmp0__length1 = soy_materials_textured__ids_length1;
	_tmp1_ = id;
	_tmp2_ = _tmp0_[_tmp1_];
	glActiveTexture (_tmp2_);
	_tmp3_ = soy_materials_textured__ids;
	_tmp3__length1 = soy_materials_textured__ids_length1;
	_tmp4_ = id;
	_tmp5_ = _tmp3_[_tmp4_];
	glClientActiveTexture (_tmp5_);
	glDisableClientState (GL_TEXTURE_COORD_ARRAY);
	_tmp6_ = texmatrix;
	if (_tmp6_ != NULL) {
		glPopMatrix ();
	}
	_tmp7_ = texture;
	soy_textures_texture_disable (_tmp7_);
}


soytexturesTexture* soy_materials_textured_get_bumpmap (soymaterialsTextured* self) {
	soytexturesTexture* result;
	soytexturesTexture* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_bumpmap;
	result = _tmp0_;
	return result;
}


void soy_materials_textured_set_bumpmap (soymaterialsTextured* self, soytexturesTexture* value) {
	soytexturesTexture* _tmp0_;
	soytexturesTexture* _tmp1_;
	soytexturesTexture* _tmp2_;
	g_return_if_fail (self != NULL);
	g_mutex_lock (&self->priv->_mutex);
	_tmp0_ = value;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (self->priv->_bumpmap);
	self->priv->_bumpmap = _tmp1_;
	_tmp2_ = value;
	if (_tmp2_ == NULL) {
		((soymaterialsMaterial*) self)->needsTSLVs = FALSE;
	} else {
		((soymaterialsMaterial*) self)->needsTSLVs = TRUE;
	}
	g_mutex_unlock (&self->priv->_mutex);
	g_object_notify ((GObject *) self, "bumpmap");
}


soytexturesTexture* soy_materials_textured_get_colormap (soymaterialsTextured* self) {
	soytexturesTexture* result;
	soytexturesTexture* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_colormap;
	result = _tmp0_;
	return result;
}


void soy_materials_textured_set_colormap (soymaterialsTextured* self, soytexturesTexture* value) {
	soytexturesTexture* _tmp0_;
	soytexturesTexture* _tmp1_;
	g_return_if_fail (self != NULL);
	g_mutex_lock (&self->priv->_mutex);
	_tmp0_ = value;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (self->priv->_colormap);
	self->priv->_colormap = _tmp1_;
	g_mutex_unlock (&self->priv->_mutex);
	g_object_notify ((GObject *) self, "colormap");
}


soytexturesTexture* soy_materials_textured_get_glowmap (soymaterialsTextured* self) {
	soytexturesTexture* result;
	soytexturesTexture* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_glowmap;
	result = _tmp0_;
	return result;
}


void soy_materials_textured_set_glowmap (soymaterialsTextured* self, soytexturesTexture* value) {
	soytexturesTexture* _tmp0_;
	soytexturesTexture* _tmp1_;
	g_return_if_fail (self != NULL);
	g_mutex_lock (&self->priv->_mutex);
	_tmp0_ = value;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (self->priv->_glowmap);
	self->priv->_glowmap = _tmp1_;
	g_mutex_unlock (&self->priv->_mutex);
	g_object_notify ((GObject *) self, "glowmap");
}


static GObject * soy_materials_textured_constructor (GType type, guint n_construct_properties, GObjectConstructParam * construct_properties) {
	GObject * obj;
	GObjectClass * parent_class;
	soymaterialsTextured * self;
	parent_class = G_OBJECT_CLASS (soy_materials_textured_parent_class);
	obj = parent_class->constructor (type, n_construct_properties, construct_properties);
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, SOY_MATERIALS_TYPE_TEXTURED, soymaterialsTextured);
	_vala_clear_GMutex (&self->priv->_mutex);
	g_mutex_init (&self->priv->_mutex);
	return obj;
}


static void soy_materials_textured_class_init (soymaterialsTexturedClass * klass) {
	GLenum* _tmp0_ = NULL;
	soytexturesCubemap* _tmp1_;
	soytexturesCubemap* _tmp2_;
	soytexturesTexture* _tmp3_;
	soytexturesTexture* _tmp4_;
	soytexturesCubemap* _tmp5_;
	soytexturesTexture* _tmp6_;
	soytexturesTexture* _tmp7_;
	soytexturesCubemap* _tmp8_;
	soytexturesTexture* _tmp9_;
	soytexturesTexture* _tmp10_;
	soytexturesCubemap* _tmp11_;
	soytexturesTexture* _tmp12_;
	soytexturesTexture* _tmp13_;
	soytexturesCubemap* _tmp14_;
	soytexturesTexture* _tmp15_;
	soytexturesTexture* _tmp16_;
	soytexturesCubemap* _tmp17_;
	soytexturesTexture* _tmp18_;
	soytexturesTexture* _tmp19_;
	soytexturesCubemap* _tmp20_;
	soytexturesTexture* _tmp21_;
	soytexturesTexture* _tmp22_;
	soytexturesCubemap* _tmp23_;
	soytexturesTexture* _tmp24_;
	soytexturesTexture* _tmp25_;
	soytexturesCubemap* _tmp26_;
	soytexturesTexture* _tmp27_;
	soytexturesTexture* _tmp28_;
	soytexturesCubemap* _tmp29_;
	soytexturesTexture* _tmp30_;
	soytexturesTexture* _tmp31_;
	soytexturesCubemap* _tmp32_;
	soytexturesTexture* _tmp33_;
	soytexturesTexture* _tmp34_;
	soytexturesCubemap* _tmp35_;
	soytexturesTexture* _tmp36_;
	soytexturesTexture* _tmp37_;
	soytexturesCubemap* _tmp38_;
	soytexturesTexture* _tmp39_;
	soytexturesTexture* _tmp40_;
	guchar* _tmp41_;
	guchar* ptru;
	soytexturesCubemap* _tmp42_;
	soytexturesTexture* _tmp43_;
	soytexturesTexture* _tmp44_;
	guchar* _tmp45_;
	guchar* ptrd;
	soytexturesCubemap* _tmp46_;
	soytexturesTexture* _tmp47_;
	soytexturesTexture* _tmp48_;
	guchar* _tmp49_;
	guchar* ptrl;
	soytexturesCubemap* _tmp50_;
	soytexturesTexture* _tmp51_;
	soytexturesTexture* _tmp52_;
	guchar* _tmp53_;
	guchar* ptrr;
	soytexturesCubemap* _tmp54_;
	soytexturesTexture* _tmp55_;
	soytexturesTexture* _tmp56_;
	guchar* _tmp57_;
	guchar* ptrf;
	soytexturesCubemap* _tmp58_;
	soytexturesTexture* _tmp59_;
	soytexturesTexture* _tmp60_;
	guchar* _tmp61_;
	guchar* ptrb;
	soytexturesTexture* _tmp143_;
	soytexturesTexture* _tmp144_;
	soy_materials_textured_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (soymaterialsTexturedPrivate));
	SOY_MATERIALS_MATERIAL_CLASS (klass)->render = soy_materials_textured_real_render;
	G_OBJECT_CLASS (klass)->get_property = _vala_soy_materials_textured_get_property;
	G_OBJECT_CLASS (klass)->set_property = _vala_soy_materials_textured_set_property;
	G_OBJECT_CLASS (klass)->constructor = soy_materials_textured_constructor;
	G_OBJECT_CLASS (klass)->finalize = soy_materials_textured_finalize;
	g_object_class_install_property (G_OBJECT_CLASS (klass), SOY_MATERIALS_TEXTURED_BUMPMAP, g_param_spec_object ("bumpmap", "bumpmap", "bumpmap", SOY_TEXTURES_TYPE_TEXTURE, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), SOY_MATERIALS_TEXTURED_COLORMAP, g_param_spec_object ("colormap", "colormap", "colormap", SOY_TEXTURES_TYPE_TEXTURE, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), SOY_MATERIALS_TEXTURED_GLOWMAP, g_param_spec_object ("glowmap", "glowmap", "glowmap", SOY_TEXTURES_TYPE_TEXTURE, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	_tmp0_ = g_new0 (GLenum, 5);
	_tmp0_[0] = GL_TEXTURE0;
	_tmp0_[1] = GL_TEXTURE1;
	_tmp0_[2] = GL_TEXTURE2;
	_tmp0_[3] = GL_TEXTURE3;
	_tmp0_[4] = GL_TEXTURE4;
	soy_materials_textured__ids = _tmp0_;
	soy_materials_textured__ids_length1 = 5;
	_tmp1_ = soy_textures_cubemap_new ();
	_g_object_unref0 (soy_materials_textured__normalisation_cubemap);
	soy_materials_textured__normalisation_cubemap = _tmp1_;
	_tmp2_ = soy_materials_textured__normalisation_cubemap;
	_tmp3_ = soy_textures_texture_new ();
	_tmp4_ = _tmp3_;
	soy_textures_cubemap_set_up (_tmp2_, _tmp4_);
	_g_object_unref0 (_tmp4_);
	_tmp5_ = soy_materials_textured__normalisation_cubemap;
	_tmp6_ = soy_textures_texture_new ();
	_tmp7_ = _tmp6_;
	soy_textures_cubemap_set_down (_tmp5_, _tmp7_);
	_g_object_unref0 (_tmp7_);
	_tmp8_ = soy_materials_textured__normalisation_cubemap;
	_tmp9_ = soy_textures_texture_new ();
	_tmp10_ = _tmp9_;
	soy_textures_cubemap_set_left (_tmp8_, _tmp10_);
	_g_object_unref0 (_tmp10_);
	_tmp11_ = soy_materials_textured__normalisation_cubemap;
	_tmp12_ = soy_textures_texture_new ();
	_tmp13_ = _tmp12_;
	soy_textures_cubemap_set_right (_tmp11_, _tmp13_);
	_g_object_unref0 (_tmp13_);
	_tmp14_ = soy_materials_textured__normalisation_cubemap;
	_tmp15_ = soy_textures_texture_new ();
	_tmp16_ = _tmp15_;
	soy_textures_cubemap_set_front (_tmp14_, _tmp16_);
	_g_object_unref0 (_tmp16_);
	_tmp17_ = soy_materials_textured__normalisation_cubemap;
	_tmp18_ = soy_textures_texture_new ();
	_tmp19_ = _tmp18_;
	soy_textures_cubemap_set_back (_tmp17_, _tmp19_);
	_g_object_unref0 (_tmp19_);
	_tmp20_ = soy_materials_textured__normalisation_cubemap;
	_tmp21_ = soy_textures_cubemap_get_up (_tmp20_);
	_tmp22_ = _tmp21_;
	soy_textures_texture_resize (_tmp22_, 3, 32, 32);
	_tmp23_ = soy_materials_textured__normalisation_cubemap;
	_tmp24_ = soy_textures_cubemap_get_down (_tmp23_);
	_tmp25_ = _tmp24_;
	soy_textures_texture_resize (_tmp25_, 3, 32, 32);
	_tmp26_ = soy_materials_textured__normalisation_cubemap;
	_tmp27_ = soy_textures_cubemap_get_left (_tmp26_);
	_tmp28_ = _tmp27_;
	soy_textures_texture_resize (_tmp28_, 3, 32, 32);
	_tmp29_ = soy_materials_textured__normalisation_cubemap;
	_tmp30_ = soy_textures_cubemap_get_right (_tmp29_);
	_tmp31_ = _tmp30_;
	soy_textures_texture_resize (_tmp31_, 3, 32, 32);
	_tmp32_ = soy_materials_textured__normalisation_cubemap;
	_tmp33_ = soy_textures_cubemap_get_front (_tmp32_);
	_tmp34_ = _tmp33_;
	soy_textures_texture_resize (_tmp34_, 3, 32, 32);
	_tmp35_ = soy_materials_textured__normalisation_cubemap;
	_tmp36_ = soy_textures_cubemap_get_back (_tmp35_);
	_tmp37_ = _tmp36_;
	soy_textures_texture_resize (_tmp37_, 3, 32, 32);
	_tmp38_ = soy_materials_textured__normalisation_cubemap;
	_tmp39_ = soy_textures_cubemap_get_up (_tmp38_);
	_tmp40_ = _tmp39_;
	_tmp41_ = _tmp40_->texels;
	ptru = _tmp41_;
	_tmp42_ = soy_materials_textured__normalisation_cubemap;
	_tmp43_ = soy_textures_cubemap_get_down (_tmp42_);
	_tmp44_ = _tmp43_;
	_tmp45_ = _tmp44_->texels;
	ptrd = _tmp45_;
	_tmp46_ = soy_materials_textured__normalisation_cubemap;
	_tmp47_ = soy_textures_cubemap_get_left (_tmp46_);
	_tmp48_ = _tmp47_;
	_tmp49_ = _tmp48_->texels;
	ptrl = _tmp49_;
	_tmp50_ = soy_materials_textured__normalisation_cubemap;
	_tmp51_ = soy_textures_cubemap_get_right (_tmp50_);
	_tmp52_ = _tmp51_;
	_tmp53_ = _tmp52_->texels;
	ptrr = _tmp53_;
	_tmp54_ = soy_materials_textured__normalisation_cubemap;
	_tmp55_ = soy_textures_cubemap_get_front (_tmp54_);
	_tmp56_ = _tmp55_;
	_tmp57_ = _tmp56_->texels;
	ptrf = _tmp57_;
	_tmp58_ = soy_materials_textured__normalisation_cubemap;
	_tmp59_ = soy_textures_cubemap_get_back (_tmp58_);
	_tmp60_ = _tmp59_;
	_tmp61_ = _tmp60_->texels;
	ptrb = _tmp61_;
	{
		gint i;
		i = 0;
		{
			gboolean _tmp62_;
			_tmp62_ = TRUE;
			while (TRUE) {
				gboolean _tmp63_;
				_tmp63_ = _tmp62_;
				if (!_tmp63_) {
					gint _tmp64_;
					_tmp64_ = i;
					i = _tmp64_ + 1;
				}
				_tmp62_ = FALSE;
				if (!(i <= 31)) {
					break;
				}
				{
					gint j;
					j = 0;
					{
						gboolean _tmp65_;
						_tmp65_ = TRUE;
						while (TRUE) {
							gboolean _tmp66_;
							gint _tmp68_;
							gfloat a;
							gint _tmp69_;
							gfloat b;
							gfloat c;
							gfloat _tmp70_;
							gfloat _tmp71_;
							gfloat _tmp72_;
							gfloat _tmp73_;
							gfloat _tmp74_;
							gfloat _tmp75_;
							gfloat _tmp76_ = 0.0F;
							gfloat magnitude;
							gfloat _tmp77_;
							gfloat _tmp78_;
							gfloat _tmp79_;
							gfloat _tmp80_;
							gfloat _tmp81_;
							gfloat _tmp82_;
							guchar* _tmp83_;
							gfloat _tmp84_;
							guchar _tmp85_;
							guchar* _tmp86_;
							gfloat _tmp87_;
							guchar _tmp88_;
							guchar* _tmp89_;
							gfloat _tmp90_;
							guchar _tmp91_;
							guchar* _tmp92_;
							gfloat _tmp93_;
							guchar _tmp94_;
							guchar* _tmp95_;
							gfloat _tmp96_;
							guchar _tmp97_;
							guchar* _tmp98_;
							gfloat _tmp99_;
							guchar _tmp100_;
							guchar* _tmp101_;
							gfloat _tmp102_;
							guchar _tmp103_;
							guchar* _tmp104_;
							gfloat _tmp105_;
							guchar _tmp106_;
							guchar* _tmp107_;
							gfloat _tmp108_;
							guchar _tmp109_;
							guchar* _tmp110_;
							gfloat _tmp111_;
							guchar _tmp112_;
							guchar* _tmp113_;
							gfloat _tmp114_;
							guchar _tmp115_;
							guchar* _tmp116_;
							gfloat _tmp117_;
							guchar _tmp118_;
							guchar* _tmp119_;
							gfloat _tmp120_;
							guchar _tmp121_;
							guchar* _tmp122_;
							gfloat _tmp123_;
							guchar _tmp124_;
							guchar* _tmp125_;
							gfloat _tmp126_;
							guchar _tmp127_;
							guchar* _tmp128_;
							gfloat _tmp129_;
							guchar _tmp130_;
							guchar* _tmp131_;
							gfloat _tmp132_;
							guchar _tmp133_;
							guchar* _tmp134_;
							gfloat _tmp135_;
							guchar _tmp136_;
							guchar* _tmp137_;
							guchar* _tmp138_;
							guchar* _tmp139_;
							guchar* _tmp140_;
							guchar* _tmp141_;
							guchar* _tmp142_;
							_tmp66_ = _tmp65_;
							if (!_tmp66_) {
								gint _tmp67_;
								_tmp67_ = j;
								j = _tmp67_ + 1;
							}
							_tmp65_ = FALSE;
							if (!(j <= 31)) {
								break;
							}
							_tmp68_ = i;
							a = _tmp68_ - 15.5f;
							_tmp69_ = j;
							b = _tmp69_ - 15.5f;
							c = 16.0f;
							_tmp70_ = a;
							_tmp71_ = a;
							_tmp72_ = b;
							_tmp73_ = b;
							_tmp74_ = c;
							_tmp75_ = c;
							_tmp76_ = sqrtf (((_tmp70_ * _tmp71_) + (_tmp72_ * _tmp73_)) + (_tmp74_ * _tmp75_));
							magnitude = _tmp76_;
							_tmp77_ = a;
							_tmp78_ = magnitude;
							a = _tmp77_ / _tmp78_;
							_tmp79_ = b;
							_tmp80_ = magnitude;
							b = _tmp79_ / _tmp80_;
							_tmp81_ = c;
							_tmp82_ = magnitude;
							c = _tmp81_ / _tmp82_;
							_tmp83_ = ptru;
							_tmp84_ = b;
							_tmp83_[0] = (guchar) ((255 * (_tmp84_ + 1)) / 2);
							_tmp85_ = _tmp83_[0];
							_tmp86_ = ptru;
							_tmp87_ = c;
							_tmp86_[1] = (guchar) ((255 * (_tmp87_ + 1)) / 2);
							_tmp88_ = _tmp86_[1];
							_tmp89_ = ptru;
							_tmp90_ = a;
							_tmp89_[2] = (guchar) ((255 * (_tmp90_ + 1)) / 2);
							_tmp91_ = _tmp89_[2];
							_tmp92_ = ptrd;
							_tmp93_ = b;
							_tmp92_[0] = (guchar) ((255 * (_tmp93_ + 1)) / 2);
							_tmp94_ = _tmp92_[0];
							_tmp95_ = ptrd;
							_tmp96_ = c;
							_tmp95_[1] = (guchar) ((255 * ((-_tmp96_) + 1)) / 2);
							_tmp97_ = _tmp95_[1];
							_tmp98_ = ptrd;
							_tmp99_ = a;
							_tmp98_[2] = (guchar) ((255 * ((-_tmp99_) + 1)) / 2);
							_tmp100_ = _tmp98_[2];
							_tmp101_ = ptrl;
							_tmp102_ = c;
							_tmp101_[0] = (guchar) ((255 * ((-_tmp102_) + 1)) / 2);
							_tmp103_ = _tmp101_[0];
							_tmp104_ = ptrl;
							_tmp105_ = a;
							_tmp104_[1] = (guchar) ((255 * ((-_tmp105_) + 1)) / 2);
							_tmp106_ = _tmp104_[1];
							_tmp107_ = ptrl;
							_tmp108_ = b;
							_tmp107_[2] = (guchar) ((255 * (_tmp108_ + 1)) / 2);
							_tmp109_ = _tmp107_[2];
							_tmp110_ = ptrr;
							_tmp111_ = c;
							_tmp110_[0] = (guchar) ((255 * (_tmp111_ + 1)) / 2);
							_tmp112_ = _tmp110_[0];
							_tmp113_ = ptrr;
							_tmp114_ = a;
							_tmp113_[1] = (guchar) ((255 * ((-_tmp114_) + 1)) / 2);
							_tmp115_ = _tmp113_[1];
							_tmp116_ = ptrr;
							_tmp117_ = b;
							_tmp116_[2] = (guchar) ((255 * ((-_tmp117_) + 1)) / 2);
							_tmp118_ = _tmp116_[2];
							_tmp119_ = ptrf;
							_tmp120_ = b;
							_tmp119_[0] = (guchar) ((255 * (_tmp120_ + 1)) / 2);
							_tmp121_ = _tmp119_[0];
							_tmp122_ = ptrf;
							_tmp123_ = a;
							_tmp122_[1] = (guchar) ((255 * ((-_tmp123_) + 1)) / 2);
							_tmp124_ = _tmp122_[1];
							_tmp125_ = ptrf;
							_tmp126_ = c;
							_tmp125_[2] = (guchar) ((255 * (_tmp126_ + 1)) / 2);
							_tmp127_ = _tmp125_[2];
							_tmp128_ = ptrb;
							_tmp129_ = b;
							_tmp128_[0] = (guchar) ((255 * ((-_tmp129_) + 1)) / 2);
							_tmp130_ = _tmp128_[0];
							_tmp131_ = ptrb;
							_tmp132_ = a;
							_tmp131_[1] = (guchar) ((255 * ((-_tmp132_) + 1)) / 2);
							_tmp133_ = _tmp131_[1];
							_tmp134_ = ptrb;
							_tmp135_ = c;
							_tmp134_[2] = (guchar) ((255 * ((-_tmp135_) + 1)) / 2);
							_tmp136_ = _tmp134_[2];
							_tmp137_ = ptru;
							ptru = _tmp137_ + 3;
							_tmp138_ = ptrd;
							ptrd = _tmp138_ + 3;
							_tmp139_ = ptrl;
							ptrl = _tmp139_ + 3;
							_tmp140_ = ptrr;
							ptrr = _tmp140_ + 3;
							_tmp141_ = ptrf;
							ptrf = _tmp141_ + 3;
							_tmp142_ = ptrb;
							ptrb = _tmp142_ + 3;
						}
					}
				}
			}
		}
	}
	_tmp143_ = soy_textures_texture_new ();
	_g_object_unref0 (soy_materials_textured__dummy);
	soy_materials_textured__dummy = _tmp143_;
	_tmp144_ = soy_materials_textured__dummy;
	soy_textures_texture_resize (_tmp144_, 3, 1, 1);
}


static void soy_materials_textured_instance_init (soymaterialsTextured * self) {
	self->priv = SOY_MATERIALS_TEXTURED_GET_PRIVATE (self);
}


static void soy_materials_textured_finalize (GObject* obj) {
	soymaterialsTextured * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, SOY_MATERIALS_TYPE_TEXTURED, soymaterialsTextured);
	_vala_clear_GMutex (&self->priv->_mutex);
	_g_object_unref0 (self->priv->_bumpmap);
	_g_object_unref0 (self->priv->_colormap);
	_g_object_unref0 (self->priv->_glowmap);
	G_OBJECT_CLASS (soy_materials_textured_parent_class)->finalize (obj);
}


GType soy_materials_textured_get_type (void) {
	static volatile gsize soy_materials_textured_type_id__volatile = 0;
	if (g_once_init_enter (&soy_materials_textured_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (soymaterialsTexturedClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) soy_materials_textured_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (soymaterialsTextured), 0, (GInstanceInitFunc) soy_materials_textured_instance_init, NULL };
		GType soy_materials_textured_type_id;
		soy_materials_textured_type_id = g_type_register_static (SOY_MATERIALS_TYPE_COLORED, "soymaterialsTextured", &g_define_type_info, 0);
		g_once_init_leave (&soy_materials_textured_type_id__volatile, soy_materials_textured_type_id);
	}
	return soy_materials_textured_type_id__volatile;
}


static void _vala_soy_materials_textured_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec) {
	soymaterialsTextured * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, SOY_MATERIALS_TYPE_TEXTURED, soymaterialsTextured);
	switch (property_id) {
		case SOY_MATERIALS_TEXTURED_BUMPMAP:
		g_value_set_object (value, soy_materials_textured_get_bumpmap (self));
		break;
		case SOY_MATERIALS_TEXTURED_COLORMAP:
		g_value_set_object (value, soy_materials_textured_get_colormap (self));
		break;
		case SOY_MATERIALS_TEXTURED_GLOWMAP:
		g_value_set_object (value, soy_materials_textured_get_glowmap (self));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}


static void _vala_soy_materials_textured_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec) {
	soymaterialsTextured * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, SOY_MATERIALS_TYPE_TEXTURED, soymaterialsTextured);
	switch (property_id) {
		case SOY_MATERIALS_TEXTURED_BUMPMAP:
		soy_materials_textured_set_bumpmap (self, g_value_get_object (value));
		break;
		case SOY_MATERIALS_TEXTURED_COLORMAP:
		soy_materials_textured_set_colormap (self, g_value_get_object (value));
		break;
		case SOY_MATERIALS_TEXTURED_GLOWMAP:
		soy_materials_textured_set_glowmap (self, g_value_get_object (value));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}


static void _vala_clear_GMutex (GMutex * mutex) {
	GMutex zero_mutex = { 0 };
	if (memcmp (mutex, &zero_mutex, sizeof (GMutex))) {
		g_mutex_clear (mutex);
		memset (mutex, 0, sizeof (GMutex));
	}
}


static void _vala_clear_GRecMutex (GRecMutex * mutex) {
	GRecMutex zero_mutex = { 0 };
	if (memcmp (mutex, &zero_mutex, sizeof (GRecMutex))) {
		g_rec_mutex_clear (mutex);
		memset (mutex, 0, sizeof (GRecMutex));
	}
}


static void _vala_clear_GRWLock (GRWLock * mutex) {
	GRWLock zero_mutex = { 0 };
	if (memcmp (mutex, &zero_mutex, sizeof (GRWLock))) {
		g_rw_lock_clear (mutex);
		memset (mutex, 0, sizeof (GRWLock));
	}
}


static void _vala_clear_GCond (GCond * mutex) {
	GCond zero_mutex = { 0 };
	if (memcmp (mutex, &zero_mutex, sizeof (GCond))) {
		g_cond_clear (mutex);
		memset (mutex, 0, sizeof (GCond));
	}
}



